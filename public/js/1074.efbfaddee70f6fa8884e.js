"use strict";(self.webpackChunkeco=self.webpackChunkeco||[]).push([[1074],{91074:(e,t,n)=>{n.r(t),n.d(t,{default:()=>W});var a=n(93433),l=n(4942),r=n(29439),c=n(67294),o=n(69265);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var i="".concat(URL_API,"/api/email-splitview");const m={fetchSelectList:function(e){var t=e.filter,n=e.sorts,a=e.limit,l=e.offset;return o.Z.get("".concat(i,"/select-list"),{params:{jory:{fld:[],flt:t,srt:n,lmt:a,ofs:l}}})},fetchEmail:function(e){return o.Z.get("".concat(i,"/").concat(e)).then((function(e){return e.data}))},update:function(e,t){return o.Z.post("".concat(i,"/").concat(e),t)},updateMultiple:function(e,t){return o.Z.post("".concat(i,"/update-multiple"),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({ids:e},t))},storeReply:function(e){return o.Z.post("".concat(i,"/").concat(e,"/store-reply"))},storeReplyAll:function(e){return o.Z.post("".concat(i,"/").concat(e,"/store-reply-all"))},storeForward:function(e){return o.Z.post("".concat(i,"/").concat(e,"/store-forward"))},deleteMultiple:function(e){return o.Z.post("".concat(i,"/delete-multiple"),{ids:e})}};var u=n(97894),d=n(58475),p=n(76979),f=n(40158),b=n(77320),E=n(1297),h=n(61409),v=n(86706),y=n(71840),g=n(16589),O=n(41415),w=n(65677),j=n(39669);function N(e){var t=e.email,n=e.updateEmailAttributes,a=e.updatedEmailHandler,l=(0,v.v9)((function(e){return e.systemData.emailStatuses})),o=(0,c.useState)(!1),s=(0,r.Z)(o,2),i=s[0],m=s[1];return c.createElement("div",{className:"panel panel-default"},c.createElement("div",{className:"panel-body panel-small"},c.createElement("div",{className:"row",style:{marginLeft:"-5px"}},c.createElement("div",{className:"col-md-12"},c.createElement("div",{className:"btn-group margin-small",role:"group"},c.createElement("button",{type:"button",title:"Beantwoorden",className:"btn btn-success btn-sm",onClick:function(){g.Z.storeReply(t.id).then((function(e){}))}},c.createElement(u.ZP,{icon:d.q,size:13})),c.createElement("button",{type:"button",title:"Allen beantwoorden",className:"btn btn-success btn-sm",onClick:function(){g.Z.storeReplyAll(t.id).then((function(e){}))}},c.createElement(u.ZP,{icon:p.p,size:13})),c.createElement("button",{type:"button",title:"Doorsturen",className:"btn btn-success btn-sm",onClick:function(){g.Z.storeForward(t.id).then((function(e){}))}},c.createElement(u.ZP,{icon:f.c,size:13}))),c.createElement("div",{className:"btn-group margin-small margin-10-left",role:"group"},c.createElement("button",{type:"button",title:"Verwijderen",className:"btn btn-success btn-sm"},c.createElement(u.ZP,{icon:b._,size:13})),c.createElement("button",{type:"button",title:"Doorsturen",className:"btn btn-success btn-sm",onClick:function(){m(!0)}},c.createElement(u.ZP,{icon:E.G,size:13}))))),c.createElement("div",{className:"row",style:{marginTop:"12px"}},c.createElement("div",{className:"col-sm-6"},c.createElement("label",{className:"col-sm-6"},"Gekoppeld contact"),c.createElement("div",{className:"col-sm-6"},t&&t.contacts&&t.contacts.map((function(e){return c.createElement("span",{key:e.id},c.createElement(h.rU,{to:"/contact/".concat(e.id),className:"link-underline"},e.fullName)," ",c.createElement("br",null))})))),c.createElement(y.Z,{label:"Status",size:"col-sm-6",name:"status",options:l,value:t.status,onChangeAction:function(e){return n({status:e.target.value})},emptyOption:!1})),c.createElement("div",{className:"row"},c.createElement("div",{className:"col-sm-6"},c.createElement("label",{className:"col-sm-6"},"CC"),c.createElement("div",{className:"col-sm-6"},c.createElement(w.Z,{emailAddresses:t.ccAddresses}))),c.createElement(j.Z,{values:{responsibleUserId:t.responsibleUserId,responsibleTeamId:t.responsibleTeamId},onChangeAction:n}))),c.createElement(O.Z,{showModal:i,emailId:t.id,setShowModal:m,onSave:a}))}var Z=n(23639);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e){var t=e.emailId,n=e.updatedEmailHandler,a=(0,c.useState)([]),l=(0,r.Z)(a,2),o=l[0],s=l[1],i=(0,c.useState)(!0),u=(0,r.Z)(i,2),d=u[0],p=u[1];(0,c.useEffect)((function(){t&&f()}),[t]);var f=function(){p(!0),m.fetchEmail(t).then((function(e){s(e),p(!1)}))};return d||!o?c.createElement(c.Fragment,null):c.createElement("div",null,c.createElement(N,{email:o,updateEmailAttributes:function(e){s(x(x({},o),e)),g.Z.update(t,e).then((function(){n()}))},updatedEmailHandler:function(){f(),n()}}),c.createElement("div",{className:"panel panel-default"},c.createElement("div",{className:"panel-body panel-small",style:{padding:"20px"}},c.createElement("div",{dangerouslySetInnerHTML:{__html:o.htmlBodyWithEmbeddedImages}}))),c.createElement(Z.Z,{email:o}))}var P=n(30381),C=n.n(P),D=n(91050),I=n(41355);function q(e){var t=e.emailIds,n=e.onDeleted,a=(0,c.useState)(!1),l=(0,r.Z)(a,2),o=l[0],s=l[1];return c.createElement(c.Fragment,null,c.createElement("button",{type:"button",title:"Verwijderen",className:"btn btn-success btn-sm",onClick:function(){s(!0)}},c.createElement(u.ZP,{icon:b._,size:13})),o&&c.createElement(I.Z,{buttonConfirmText:"Verwijderen",closeModal:function(){return s(!1)},confirmAction:function(){g.Z.deleteMultiple(t).then((function(){s(!1),n()}))},title:"Bevestigen",buttonClassName:"btn-danger"},c.createElement("p",null,"Weet u zeker dat u deze ",t.length," emails wilt verwijderen?")))}var z=n(75502),A=n(56170);function M(e){var t=e.emailIds,n=e.onSaved,l=(0,v.v9)((function(e){return e.systemData.emailStatuses})),o=(0,v.v9)((function(e){return e.systemData.teams})),s=(0,v.v9)((function(e){return e.systemData.users})),i=(0,c.useState)(!1),m=(0,r.Z)(i,2),d=m[0],p=m[1],f=(0,c.useState)(-1),b=(0,r.Z)(f,2),E=b[0],h=b[1],O=(0,c.useState)(-1),w=(0,r.Z)(O,2),j=w[0],N=w[1],Z=(0,c.useState)(-1),k=(0,r.Z)(Z,2),x=k[0],S=k[1];return c.createElement(c.Fragment,null,c.createElement("button",{type:"button",title:"Bewerken",className:"btn btn-success btn-sm",onClick:function(){p(!0)}},c.createElement(u.ZP,{icon:z.r,size:13})),d&&c.createElement(I.Z,{buttonConfirmText:"Opslaan",closeModal:function(){return p(!1)},confirmAction:function(){var e={};-1!==parseInt(E)&&(e.status=E),-1!==j&&(e.responsibleUserId=j),-1!==x&&(e.responsibleTeamId=x),g.Z.updateMultiple(t,e).then((function(){p(!1),n()}))},title:"Bulk bewerken",modalClassName:"modal-lg"},c.createElement("div",{className:"row",style:{marginTop:"12px"}},c.createElement(y.Z,{label:"Status",size:"col-sm-6",name:"status",options:[{id:-1,name:"--- niet wijzigen ---"}].concat((0,a.Z)(l)),value:E,onChangeAction:function(e){return h(e.target.value)},emptyOption:!1}),c.createElement(A.Z,{label:"Verantwoordelijke",size:"col-sm-6",name:"responsible",optionsInGroups:[{name:"general",label:"Algemeen",options:[{id:"-1",name:"--- niet wijzigen ---"},{id:"0",name:"--- geen ---"}]},{name:"user",label:"Gebruikers",options:s,optionName:"fullName"},{name:"team",label:"Teams",options:o}],value:-1===j&&-1===x?"general-1":j?"user"+j:x?"team"+x:"general0",onChangeAction:function(e){return function(e){if("general-1"===e)return N(-1),void S(-1);N(null),S(null),0===e.indexOf("user")&&N(e.replace("user","")),0===e.indexOf("team")&&S(e.replace("team",""))}(e.target.value)},emptyOption:!1}))))}function T(e){var t=e.emails,n=e.folder,l=e.emailCount,o=e.fetchMoreEmails,s=e.selectedEmailId,i=e.setSelectedEmailId,m=e.onUpdated,d=(0,c.useState)(!1),p=(0,r.Z)(d,2),f=p[0],b=p[1],E=(0,c.useState)([]),h=(0,r.Z)(E,2),v=h[0],y=h[1],g=function(e){localStorage.setItem("lastOpenedEmailId",e.id),i(e.id)};return(0,c.useEffect)((function(){if(!s&&0!==t.length){var e=t.findIndex((function(e){return e.id===parseInt(localStorage.getItem("lastOpenedEmailId"))}));g(t[-1===e?0:e])}}),[t]),c.createElement("div",{className:"panel panel-default"},c.createElement("div",{className:"panel-body panel-small",style:{height:"calc(100vh - 190px)",overflow:"auto"}},f&&c.createElement("div",{className:"row"},c.createElement("div",{className:"col-xs-12",style:{display:"flex",justifyContent:"space-between"}},c.createElement("div",{style:{flex:"none",display:"flex",marginLeft:"6px",alignItems:"center"},onClick:function(){v.length===t.length?y([]):y(t.map((function(e){return e.id})))}},c.createElement("input",{type:"checkbox",checked:v.length===t.length,style:{marginRight:"5px"}}),"Selecteer alles"),c.createElement("div",{className:"btn-group margin-small",role:"group"},c.createElement(M,{emailIds:v,onSaved:m}),c.createElement(q,{emailIds:v,onDeleted:function(){y([]),m()}})))),c.createElement("table",{className:"table table-condensed table-hover table-striped col-xs-12"},c.createElement("thead",null,c.createElement("tr",{className:"thead-title"},c.createElement("th",null,c.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},c.createElement("div",null,function(){switch(n){case"inbox":return"Inbox";case"sent":return"Verzonden";case"drafts":return"Concepten";case"trash":return"Prullenbak";default:return"Onbekend"}}()," (",l,")"),c.createElement("div",null,c.createElement("a",{href:"#",style:{color:"#fff"},onClick:function(e){e.preventDefault(),b(!f)}},"selecteren")))))),c.createElement("tbody",null,0===t.length?c.createElement("tr",null,c.createElement("td",null,"Geen e-mails gevonden!")):t.map((function(e){return c.createElement("tr",{key:e.id,style:{cursor:"pointer"}},c.createElement("td",{style:{borderRadius:"5px",backgroundColor:e.id===s?"#d6e1f3":"#fff",fontWeight:"unread"===e.status?"bold":"normal"}},c.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},f&&c.createElement("div",{style:{flex:"none",display:"flex",marginRight:"10px"},onClick:function(){return function(e){v.includes(e.id)?y(v.filter((function(t){return t!==e.id}))):y([].concat((0,a.Z)(v),[e.id]))}(e)}},c.createElement("input",{type:"checkbox",checked:v.includes(e.id)})),c.createElement("div",{style:{flex:1},onClick:function(){return g(e)}},c.createElement("span",{style:{fontSize:"15px"}},e.from),c.createElement("br",null),c.createElement("span",null,e.subject)),c.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"end"},onClick:function(){return g(e)}},c.createElement("span",{style:{fontSize:"12px"}},e.date&&C()(e.date).format("DD-MM-YYYY HH:mm")),c.createElement("div",null,c.createElement("span",{style:{color:"#999"}},e.responsibleName),e.hasAttachmentsWithoutCids&&c.createElement(u.ZP,{icon:D.s,size:18}))))))})),t.length<l&&c.createElement("tr",null,c.createElement("td",null,c.createElement("button",{className:"btn btn-link pull-right",onClick:function(){return o()}},"meer laden...")))))))}function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function F(e){var t=e.filters,n=e.setFilters,a=(0,v.v9)((function(e){return e.systemData.emailStatuses}));return c.createElement("div",{className:"panel panel-default"},c.createElement("div",{className:"panel-body panel-small"},c.createElement("div",{className:"row"},c.createElement("div",{className:"col-md-12"},c.createElement("table",{className:"table table-condensed table-hover table-striped col-xs-12",style:{marginBottom:"0px"}},c.createElement("thead",null,c.createElement("tr",{className:"thead-title"},c.createElement("th",{className:"",width:"10%"},"Van e-mail"),c.createElement("th",{className:"",width:"10%"},"Gekoppeld contact"),c.createElement("th",{className:"",width:"15%"},"Onderwerp"),c.createElement("th",{className:"",width:"10%"},"Datum"),c.createElement("th",{className:"",width:"15%"},"Mailbox"),c.createElement("th",{className:"",width:"10%"},"Status"),c.createElement("th",{className:"",width:"10%"},"Verantwoordelijke"),c.createElement("th",{className:"",width:"10%"},"Aan"),c.createElement("th",{className:"",width:"5%"},"Bijlage")),c.createElement("tr",{className:"thead-filter"},c.createElement("th",null,c.createElement("input",{type:"text",className:"form-control input-sm",value:t.from,onChange:function(e){n(B(B({},t),{},{from:e.target.value}))}})),c.createElement("th",null,c.createElement("input",{type:"text",className:"form-control input-sm",value:t.contact,onChange:function(e){n(B(B({},t),{},{contact:e.target.value}))}})),c.createElement("th",null,c.createElement("input",{type:"text",className:"form-control input-sm",value:t.subject,onChange:function(e){n(B(B({},t),{},{subject:e.target.value}))}})),c.createElement("th",null,"Todo"),c.createElement("th",null,c.createElement("input",{type:"text",className:"form-control input-sm",value:t.mailbox,onChange:function(e){n(B(B({},t),{},{mailbox:e.target.value}))}})),c.createElement("th",null,c.createElement("select",{className:"form-control input-sm",value:t.status,onChange:function(e){n(B(B({},t),{},{status:e.target.value,fetch:!0}))}},c.createElement("option",null),a.map((function(e){return c.createElement("option",{key:e.id,value:e.id},e.name)})))),c.createElement("th",null,c.createElement("input",{type:"text",className:"form-control input-sm",value:t.responsible,onChange:function(e){n(B(B({},t),{},{responsible:e.target.value}))}})),c.createElement("th",null,c.createElement("input",{type:"text",className:"form-control input-sm",value:t.to,onChange:function(e){n(B(B({},t),{},{to:e.target.value}))}})),c.createElement("th",null,c.createElement("select",{className:"form-control input-sm",value:t.attachment,onChange:function(e){n(B(B({},t),{},{attachment:e.target.value,fetch:!0}))}},c.createElement("option",null),c.createElement("option",{value:1},"Ja"))))))))))}function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L={from:"",contact:"",subject:"",mailbox:"",status:"",responsible:"",to:"",attachment:""};function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function W(e){var t=e.router,n=(0,c.useState)([]),l=(0,r.Z)(n,2),o=l[0],s=l[1],i=(0,c.useState)(0),u=(0,r.Z)(i,2),d=u[0],p=u[1],f=(0,c.useState)(null),b=(0,r.Z)(f,2),E=b[0],h=b[1],v=(0,c.useState)(V({},L)),y=(0,r.Z)(v,2),g=y[0],O=y[1];(0,c.useEffect)((function(){O(V(V({},function(){var e=localStorage.getItem("emailFilters");return e?G(G({},L),JSON.parse(e)):G({},L)}()),{},{fetch:!0}))}),[t.params.folder]),(0,c.useEffect)((function(){var e;g.fetch&&(O(V(V({},g),{},{fetch:!1})),e=g,localStorage.setItem("emailFilters",JSON.stringify(e)),m.fetchSelectList({filter:j(),limit:50,offset:0,sorts:N()}).then((function(e){s(e.data.items),p(e.data.total)})))}),[g.fetch]);var w=function(){return m.fetchSelectList({filter:j(),limit:o.length,offset:0,sorts:N()}).then((function(e){s(e.data.items),p(e.data.total)}))},j=function(){return e=g,n=t.params.folder,a=t.location.query.contact,l={and:[{f:"folder",d:n}]},e.subject&&l.and.push({f:"subject",o:"like",d:"%".concat(e.subject,"%")}),e.from&&l.and.push({f:"from",o:"like",d:"%".concat(e.from,"%")}),e.contact&&l.and.push({f:"contacts.fullName",o:"like",d:"%".concat(e.contact,"%")}),e.mailbox&&l.and.push({f:"mailbox.name",o:"like",d:"%".concat(e.mailbox,"%")}),e.status&&l.and.push({f:"status",d:e.status}),e.responsible&&l.and.push({or:[{f:"responsibleUser.firstName",o:"like",d:"%".concat(e.responsible,"%")},{f:"responsibleUser.lastName",o:"like",d:"%".concat(e.responsible,"%")},{f:"responsibleTeam.name",o:"like",d:"%".concat(e.responsible,"%")}]}),e.to&&l.and.push({f:"to",o:"like",d:"%".concat(e.to,"%")}),e.attachment&&l.and.push({f:"attachmentsWithoutCids.id",o:">",d:0}),e.attachment&&l.and.push({f:"attachmentsWithoutCids.id",o:">",d:0}),a&&l.and.push({f:"contacts.contactId",d:a}),l;var e,n,a,l},N=function(){return["-dateSent"]};return c.createElement("div",null,c.createElement("div",{className:"row"},c.createElement("div",{className:"col-md-12",style:{marginTop:"-10px"}},c.createElement("form",{onKeyUp:function(e){13===e.keyCode&&O(V(V({},g),{},{fetch:!0}))}},c.createElement(F,{filters:g,setFilters:O})))),c.createElement("div",{className:"row"},c.createElement("div",{className:"col-md-4 margin-10-top",style:{paddingRight:"0px"}},c.createElement(T,{emails:o,folder:t.params.folder,emailCount:d,fetchMoreEmails:function(){return m.fetchSelectList({filter:j(),limit:50,offset:o.length,sorts:N()}).then((function(e){s([].concat((0,a.Z)(o),(0,a.Z)(e.data.items))),p(e.data.total)}))},selectedEmailId:E,setSelectedEmailId:h,updateEmailAttributes:function(e,t){var n=o.map((function(n){return n.id===e?V(V({},n),t):n}));s(n)},onUpdated:w})),c.createElement("div",{className:"col-md-8 margin-10-top"},c.createElement(S,{emailId:E,updatedEmailHandler:w}))))}},91050:(e,t)=>{t.s=void 0,t.s={viewBox:"0 0 1408 1792",children:[{name:"path",attribs:{d:"M1404 1385q0 117-79 196t-196 79q-135 0-235-100l-777-776q-113-115-113-271 0-159 110-270t269-111q158 0 273 113l605 606q10 10 10 22 0 16-30.5 46.5t-46.5 30.5q-13 0-23-10l-606-607q-79-77-181-77-106 0-179 75t-73 181q0 105 76 181l776 777q63 63 145 63 64 0 106-42t42-106q0-82-63-145l-581-581q-26-24-60-24-29 0-48 19t-19 48q0 32 25 59l410 410q10 10 10 22 0 16-31 47t-47 31q-12 0-22-10l-410-410q-63-61-63-149 0-82 57-139t139-57q88 0 149 63l581 581q100 98 100 235z"}}]}},1297:(e,t)=>{t.G=void 0,t.G={viewBox:"0 0 2048 1792",children:[{name:"path",attribs:{d:"M256 1536h768v-512h-768v512zM1280 1024h512v-768h-768v256h96q66 0 113 47t47 113v352zM2048 160v960q0 66-47 113t-113 47h-608v352q0 66-47 113t-113 47h-960q-66 0-113-47t-47-113v-960q0-66 47-113t113-47h608v-352q0-66 47-113t113-47h960q66 0 113 47t47 113z"}}]}}}]);