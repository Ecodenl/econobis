"use strict";(self.webpackChunkeco=self.webpackChunkeco||[]).push([[1970],{81970:(e,t,a)=>{a.r(t),a.d(t,{default:()=>M});var n=a(96540),o=(a(2008),a(51629),a(67945),a(84185),a(83851),a(81278),a(79432),a(60825),a(23500),a(23029)),r=a(92901),c=a(56822),l=a(53954),s=a(85501),i=a(64467),m=a(58168),d=(a(52675),a(89463),a(50113),a(48598),a(62062),a(94170),a(62010),a(26099),a(69733)),p=a(47767),u=a(57761),h=a.n(u),v=a(95093),g=a.n(v),E=a(45554),f=a(60738),C=a(54814),N=a(73421),b=a(55956),A=a(77465),w=a(18692),k=a(26062),y=a(31714),G=a(6438);function I(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?I(Object(a),!0).forEach((function(t){(0,i.A)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function T(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(T=function(){return!!e})()}a(30483);var P=function(e){function t(e){var a,n,r,s;return(0,o.A)(this,t),n=this,r=t,s=[e],r=(0,l.A)(r),a=(0,c.A)(n,T()?Reflect.construct(r,s||[],(0,l.A)(n).constructor):r.apply(n,s)),(0,i.A)(a,"handleInputChange",(function(e){var t=e.target,n="checkbox"===t.type?t.checked:t.value,o=t.name;a.setState(S(S({},a.state),{},{contactGroup:S(S({},a.state.contactGroup),{},(0,i.A)({},o,n))}))})),(0,i.A)(a,"handleSubmit",(function(e){e.preventDefault();var t=a.state.contactGroup,n={},o=!1,r=!1;h().isEmpty(t.name)&&(n.name=!0,o=!0);var c=!1;a.state.contactGroups.map((function(e){return e.name==t.name&&(c=!0)})),c&&(r="Naam moet uniek zijn.",n.name=!0,o=!0),1==t.sendEmailNewContactLink&&(t.emailTemplateIdNewContactLink||(n.emailTemplateIdNewContactLink=!0,o=!0)),a.setState(S(S({},a.state),{},{errors:n,errorMessage:r})),!o&&f.A.newContactGroup(t).then((function(e){a.props.fetchSystemData(),a.props.navigate("/contact-groep/"+e.id)}))})),(0,i.A)(a,"handleChangeStartedDate",(function(e){var t=e?g()(e).format("Y-MM-DD"):"";a.setState(S(S({},a.state),{},{contactGroup:S(S({},a.state.contactGroup),{},{dateStarted:t})}))})),(0,i.A)(a,"handleChangeFinishedDate",(function(e){var t=e?g()(e).format("Y-MM-DD"):"";a.setState(S(S({},a.state),{},{contactGroup:S(S({},a.state.contactGroup),{},{dateFinished:t})}))})),(0,i.A)(a,"handleContactGroupIds",(function(e){var t=e?e.map((function(e){return e.id})).join(","):"";a.setState(S(S({},a.state),{},{contactGroup:S(S({},a.state.contactGroup),{},{contactGroupIds:t,contactGroupIdsSelected:e,sendEmailNewContactLink:!(e&&e.length>0)&&a.state.contactGroup.sendEmailNewContactLink,emailTemplateIdNewContactLink:e&&e.length>0?"":a.state.contactGroup.emailTemplateIdNewContactLink})}))})),(0,i.A)(a,"handleChangeComposedGroupType",(function(e){a.setState(S(S({},a.state),{},{contactGroup:S(S({},a.state.contactGroup),{},{contactGroupComposedType:e})}))})),a.state={contactsWithPermission:[],contactGroups:[],inspectionPersonTypes:[],emailTemplates:[],contactGroup:{id:"",name:"",description:"",closed:!1,responsibleUserId:"",dateStarted:"",dateFinished:"",showContactForm:!1,showPortal:!1,editPortal:!1,contactGroupIds:"",contactGroupIdsSelected:[],contactGroupComposedType:"",sendEmailNewContactLink:!1,emailTemplateIdNewContactLink:"",inspectionPersonTypeId:""},errors:{name:!1,nameUnique:!1,emailTemplateIdNewContactLink:!1},peekLoading:{emailTemplates:!0}},a.handleReactSelectChange=a.handleReactSelectChange.bind(a),a}return(0,s.A)(t,e),(0,r.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.permissions;E.A.fetchUsersWithPermission(t.find((function(e){return"manage_group"===e.name})).id).then((function(t){e.setState({contactsWithPermission:t})})),f.A.peekActiveContactGroups().then((function(t){e.setState({contactGroups:t})})),G.A.fetchEmailTemplatesPeek().then((function(t){return e.setState({emailTemplates:t,peekLoading:S(S({},e.state.peekLoading),{},{emailTemplates:!1})})}))}},{key:"handleReactSelectChange",value:function(e,t){this.setState(S(S({},this.state),{},{contactGroup:S(S({},this.state.contactGroup),{},(0,i.A)({},t,e))}))}},{key:"render",value:function(){var e=this,t=this.state.contactGroup,a=t.name,o=t.description,r=t.responsibleUserId,c=t.closed,l=t.dateStarted,s=t.dateFinished,i=t.showPortal,m=t.editPortal,d=t.showContactForm,p=(t.contactGroupIds,t.contactGroupIdsSelected),u=t.sendEmailNewContactLink,h=t.emailTemplateIdNewContactLink,v=t.inspectionPersonTypeId;return n.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},n.createElement("div",{className:"row"},n.createElement(C.A,{label:"Naam",name:"name",value:a,onChangeAction:this.handleInputChange,required:"required",error:this.state.errors.name})),n.createElement("div",{className:"row"},n.createElement("div",{className:"form-group col-sm-12"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col-sm-3"},n.createElement("label",{htmlFor:"description",className:"col-sm-12"},"Omschrijving")),n.createElement("div",{className:"col-sm-9"},n.createElement("textarea",{name:"description",value:o,onChange:this.handleInputChange,className:"form-control input-sm"}))))),n.createElement("div",{className:"row"},n.createElement("div",{className:"form-group col-sm-6"},n.createElement("label",{htmlFor:"responsibleUserId",className:"col-sm-6"},"Verantwoordelijke"),n.createElement("div",{className:"col-sm-6"},n.createElement("select",{className:"form-control input-sm",id:"responsibleUserId",name:"responsibleUserId",value:r,onChange:this.handleInputChange},n.createElement("option",{value:""}),this.state.contactsWithPermission.map((function(e){return n.createElement("option",{key:e.id,value:e.id},e.fullName)}))))),n.createElement(A.A,{label:"Gesloten",name:"closed",value:c,onChangeAction:this.handleInputChange})),n.createElement("div",{className:"row"},n.createElement(N.A,{label:"Startdatum",size:"col-sm-6",name:"dateStarted",value:l,onChangeAction:this.handleChangeStartedDate}),n.createElement(N.A,{label:"Datum gereed",size:"col-sm-6",name:"dateFinished",value:s,onChangeAction:this.handleChangeFinishedDate})),n.createElement("div",{className:"row"},n.createElement(A.A,{label:"Zichtbaar op portaal",name:"showPortal",value:i,onChangeAction:this.handleInputChange}),n.createElement(A.A,{label:"Veranderen op portaal",name:"editPortal",value:m,onChangeAction:this.handleInputChange})),n.createElement("div",{className:"row"},n.createElement(A.A,{label:"Zichtbaar bij contact",name:"showContactForm",value:d,onChangeAction:this.handleInputChange})),n.createElement("div",{className:"row"},n.createElement(A.A,{label:"Verstuur e-mail bij nieuwe contactkoppeling",name:"sendEmailNewContactLink",value:!(p&&p.length>0)&&u,onChangeAction:this.handleInputChange,disabled:p&&p.length>0}),1==u&&n.createElement(y.A,{label:"Template email nieuwe contactkoppeling",divSize:"col-sm-6",name:"emailTemplateIdNewContactLink",options:this.state.emailTemplates,value:h,onChangeAction:this.handleReactSelectChange,isLoading:this.state.peekLoading.emailTemplates,required:u?"required":"",error:this.state.errors.emailTemplateIdNewContactLink})),n.createElement("div",{className:"row"},n.createElement(y.A,{label:"Rol in buurtaanpak",divSize:"col-sm-6",name:"inspectionPersonTypeId",options:this.props.inspectionPersonTypes,value:v,onChangeAction:this.handleReactSelectChange,clearable:!0,size:"col-sm-5",textToolTip:"Contact die worden toegevoegd aan deze groep krijgen dezelfde waarde als Rol in buurtaanpak"})),n.createElement("div",{className:"row"},n.createElement(C.A,{label:"Gemaakt op",name:"createdAt",value:g()().format("DD-MM-Y"),readOnly:!0}),n.createElement(C.A,{label:"Gemaakt door",name:"createdBy",value:this.props.meDetails.fullName,readOnly:!0})),n.createElement("div",{className:"row"},n.createElement(w.A,{label:"Samengesteld uit",name:"contactGroupsIds",options:this.state.contactGroups,value:p,onChangeAction:this.handleContactGroupIds})),p&&p.length>1&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-sm-3"}),n.createElement("div",{className:"col-sm-9"},n.createElement("input",{onChange:function(){return e.handleChangeComposedGroupType("one")},type:"radio",name:"composedGroupType",value:"one",defaultChecked:!0})," ","In één van de groepen",n.createElement("br",null),n.createElement("input",{onChange:function(){return e.handleChangeComposedGroupType("all")},type:"radio",name:"composedGroupType",value:"all"})," ","In alle groepen")),this.state.errorMessage&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-sm-10 col-md-offset-1 alert alert-danger"},this.state.errorMessage)),n.createElement("div",{className:"panel-footer"},n.createElement("div",{className:"pull-right btn-group",role:"group"},n.createElement(b.A,{buttonText:"Opslaan",onClickAction:this.handleSubmit}))))}}])}(n.Component);const D=(0,d.Ng)((function(e){return{meDetails:e.meDetails,permissions:e.systemData.permissions,inspectionPersonTypes:e.systemData.inspectionPersonTypes}}),(function(e){return{fetchSystemData:function(){e((0,k.u)())}}}))((function(e){var t=(0,p.Zp)();return n.createElement(P,(0,m.A)({},e,{navigate:t}))}));var O=a(91858),L=a(62493),j=a(55849);const F=function(){var e=(0,p.Zp)();return n.createElement("div",{className:"row"},n.createElement("div",{className:"col-sm-12"},n.createElement(L.A,null,n.createElement(j.A,{className:"panel-small"},n.createElement("div",{className:"col-md-4"},n.createElement("div",{className:"btn-group",role:"group"},n.createElement(O.A,{iconName:"arrowLeft",onClickAction:function(){return e(-1)}}))),n.createElement("div",{className:"col-md-4"},n.createElement("h4",{className:"text-center"},"Nieuwe groep")),n.createElement("div",{className:"col-md-4"})))))},M=function(){return n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-9"},n.createElement("div",{className:"col-md-12"},n.createElement(F,null)),n.createElement("div",{className:"col-md-12"},n.createElement(L.A,null,n.createElement(j.A,null,n.createElement("div",{className:"col-md-12"},n.createElement(D,null)))))),n.createElement("div",{className:"col-md-3"}))}}}]);