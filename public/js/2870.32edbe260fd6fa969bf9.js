"use strict";(self.webpackChunkeco=self.webpackChunkeco||[]).push([[2870],{42870:(e,t,n)=>{n.r(t),n.d(t,{default:()=>B});var a=n(64467),r=n(10467),i=n(5544),o=n(54756),c=n.n(o),d=(n(28706),n(52675),n(2008),n(50113),n(62010),n(2892),n(51629),n(67945),n(84185),n(83851),n(81278),n(79432),n(26099),n(23500),n(96540)),l=n(47767),u=n(69733),s=n(95093),m=n.n(s),p=n(62493),f=n(55849),y=n(91858);const v=function(e){e.projectTypeName;var t=(0,l.Zp)();return d.createElement("div",{className:"row"},d.createElement("div",{className:"col-sm-12"},d.createElement(p.A,null,d.createElement(f.A,{className:"panel-small"},d.createElement("div",{className:"col-md-4"},d.createElement("div",{className:"btn-group btn-group-flex margin-small",role:"group"},d.createElement(y.A,{iconName:"arrowLeft",onClickAction:function(){return t(-1)}}))),d.createElement("div",{className:"col-md-4"},d.createElement("h3",{className:"text-center table-title"},"Nieuwe deelnemer")),d.createElement("div",{className:"col-md-4"})))))};var b=n(19390),I=n(44758),E=(n(62062),n(5556)),g=n.n(E),h=function(e){var t=e.buttonClassName,n=e.buttonCancelText,a=e.buttonConfirmText,r=e.children,i=e.closeModal,o=e.confirmAction,c=e.title,l=e.closingText;return d.createElement("div",{className:"modal"},d.createElement("div",{className:"modal-dialog"},d.createElement("div",{className:"modal-content"},d.createElement("div",{className:"modal-header"},d.createElement("h4",{className:"modal-title"},c)),d.createElement("div",{className:"modal-body"},d.createElement("ul",null,r.map((function(e,t){return d.createElement("li",{key:t},e)}))),d.createElement("p",null,l)),d.createElement("div",{className:"modal-footer"},d.createElement("button",{type:"button",className:"btn btn-default",onClick:i},n),e.showConfirmAction&&d.createElement("button",{type:"button",className:"btn ".concat(t),onClick:o},a)))))};h.defaultProps={buttonClassName:"btn-success",buttonConfirmText:"Opslaan",buttonCancelText:"Annuleren",showConfirmAction:!0,confirmAction:function(){}},h.propTypes={buttonCancelText:g().string,buttonConfirmText:g().string,children:g().oneOfType([g().element.isRequired,g().array.isRequired]),closeModal:g().func.isRequired,confirmAction:g().func,showConfirmAction:g().bool,title:g().string};const A=h;var C=n(14809),q=n(55956),j=n(22102),O=n(54814),k=n(73421),w=n(98564),N=n(14585),S=n(93822);const Y=function(e){var t=(0,d.useState)(""),n=(0,i.A)(t,2),a=n[0],o=n[1],l=(0,d.useState)(!1),u=(0,i.A)(l,2),s=u[0],m=u[1],p=e.participation,f=e.errors,y=e.handleInputChange,v=e.handleInputChangeDate,b=e.handleInputChangeContactId,I=e.handleInputChangeAddressId,E=e.handleInputChangeProjectId,g=e.handleSubmit,h=e.selectedContact,A=e.addresses,Y=e.projects,D=e.participantMutationStatuses,G=e.projectTypeCodeRef,x=e.isSceProject,F=e.disableProjectSelection,P=e.disableClientSelection,M=e.isLoading,R=p.addressId,B=p.statusId,T=p.projectId,z=p.quantityInterest,L=p.amountInterest,V=p.dateInterest,W=p.quantityOption,_=p.amountOption,K=p.dateOption,Z=p.quantityGranted,J=p.amountGranted,H=p.dateGranted,Q=p.quantityFinal,U=p.amountFinal,X=p.dateContractRetour,$=p.datePayment,ee=p.paymentReference,te=p.dateEntry,ne=p.disableBeforeEntryDate,ae=null==D?void 0:D.find((function(e){return e.id==B})),re=ae?ae.codeRef:null,ie=function(){var e=(0,r.A)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a.length<=1)){e.next=2;break}return e.abrupt("return",[]);case 2:return m(!0),e.prev=3,e.next=6,S.A.fetchContactSearch(a);case 6:return t=e.sent,m(!1),e.abrupt("return",t.data.data||[]);case 11:return e.prev=11,e.t0=e.catch(3),e.abrupt("return",[]);case 14:return e.prev=14,m(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[3,11,14,17]])})));return function(){return e.apply(this,arguments)}}();return d.createElement("form",{className:"form-horizontal col-md-12",onSubmit:g},d.createElement("div",{className:"row"},d.createElement(w.A,{label:"Project",name:"projectId",id:"projectId",options:Y,value:T?Number(T):null,onChangeAction:E,required:"required",error:f.projectId,errorMessage:f.projectId?"Verplicht":"",disabled:F})),d.createElement("div",{className:"row"},d.createElement(N.A,{label:"Contact",name:"contactId",id:"contactId",loadOptions:ie,optionName:"fullName",value:h,onChangeAction:b,required:"required",error:f.contactId,errorMessage:f.contactId?"Verplicht":"",disabled:P,isLoading:s,handleInputChange:function(e){o(e)},multi:!1})),d.createElement("div",{className:"row"},d.createElement(w.A,{label:"Adres",name:"addressId",id:"addressId",options:A,optionName:"streetPostalCodeCity",value:R?Number(R):null,onChangeAction:I,required:"required",disabled:"postalcode_link_capital"!==G&&!x,error:f.addressId,errorMessage:f.addressId?"Verplicht (indien geen adres beschikbaar, controleer adresgegevens bij contact)":""})),d.createElement("div",{className:"row"},d.createElement(C.A,{label:"Status",name:"statusId",id:"statusId",options:D,value:B,onChangeAction:y,required:"required",error:f.statusId,errorMessage:f.statusId?"Verplicht":""})),"interest"===re?d.createElement("div",{className:"row"},"loan"===G?d.createElement(O.A,{type:"number",label:"Bedrag interesse",name:"amountInterest",id:"amountInterest",value:L,onChangeAction:y,error:f.amountInterest}):d.createElement(O.A,{type:"number",label:"Aantal interesse",name:"quantityInterest",id:"quantityInterest",value:z,onChangeAction:y,error:f.quantityInterest}),d.createElement(k.A,{label:"Interesse datum",name:"dateInterest",id:"dateInterest",value:V,onChangeAction:v})):null,"option"===re?d.createElement("div",{className:"row"},"loan"===G?d.createElement(O.A,{type:"number",label:"Bedrag inschrijving",name:"amountOption",id:"amountOption",value:_,onChangeAction:y,required:"required",error:f.amountOption}):d.createElement(O.A,{type:"number",label:"Aantal inschrijving",name:"quantityOption",id:"quantityOption",value:W,onChangeAction:y,required:"required",error:f.quantityOption}),d.createElement(k.A,{label:"Inschrijvingsdatum",name:"dateOption",id:"dateOption",value:K,onChangeAction:v,required:"required",error:f.dateOption})):null,"granted"===re?d.createElement("div",{className:"row"},"loan"===G?d.createElement(O.A,{type:"number",label:"Bedrag toegekend",name:"amountGranted",id:"amountGranted",value:J,onChangeAction:y,required:"required",error:f.amountGranted}):d.createElement(O.A,{type:"number",label:"Aantal toegekend",name:"quantityGranted",id:"quantityGranted",value:Z,onChangeAction:y,required:"required",error:f.quantityGranted}),d.createElement(k.A,{label:"Toewijzingsdatum",name:"dateGranted",id:"dateGranted",value:H,onChangeAction:v,required:"required",error:f.dateGranted})):null,"final"===re?d.createElement(d.Fragment,null,d.createElement("div",{className:"row"},"loan"===G?d.createElement(O.A,{type:"number",label:"Bedrag definitief",name:"amountFinal",id:"amountFinal",value:U,onChangeAction:y,required:"required",error:f.amountFinal}):d.createElement(O.A,{type:"number",label:"Aantal definitief",name:"quantityFinal",id:"quantityFinal",value:Q,onChangeAction:y,required:"required",error:f.quantityFinal}),d.createElement(k.A,{label:"Toewijzingsdatum",name:"dateGranted",id:"dateGranted",value:H,onChangeAction:v})),d.createElement("div",{className:"row"},d.createElement(k.A,{label:"Contract retour",name:"dateContractRetour",id:"dateContractRetour",value:X,onChangeAction:v}),d.createElement(k.A,{label:"Betaaldatum",name:"datePayment",id:"datePayment",value:$,onChangeAction:v})),d.createElement("div",{className:"row"},d.createElement(k.A,{label:"Ingangsdatum",name:"dateEntry",id:"dateEntry",value:te,onChangeAction:v,disabledBefore:ne,required:"required",error:f.dateEntry}),d.createElement(O.A,{label:"Betalingskenmerk",id:"paymentReference",name:"paymentReference",value:ee,onChangeAction:y}))):null,d.createElement(j.A,null,d.createElement("div",{className:"pull-right btn-group",role:"group"},d.createElement(q.A,{buttonText:"Opslaan",type:"submit",value:"Submit",loading:M}))))};function D(e,t,n){var a={contactId:e.contactId,addressId:e.addressId,statusId:e.statusId,projectId:e.projectId};switch(t){case"interest":a.dateInterest=e.dateInterest,"loan"===n?a.amountInterest=e.amountInterest:a.quantityInterest=e.quantityInterest;break;case"option":a.dateOption=e.dateOption,"loan"===n?a.amountOption=e.amountOption:a.quantityOption=e.quantityOption;break;case"granted":a.dateGranted=e.dateGranted,"loan"===n?a.amountGranted=e.amountGranted:a.quantityGranted=e.quantityGranted;break;case"final":a.dateGranted=e.dateGranted,a.dateContractRetour=e.dateContractRetour,a.datePayment=e.datePayment,a.paymentReference=e.paymentReference,a.dateEntry=e.dateEntry,"loan"===n?a.amountFinal=e.amountFinal:a.quantityFinal=e.quantityFinal}return a}var G=n(57761),x=n.n(G);function F(e,t,n,a,r){if(e.contactId||(t.contactId=!0,n=!0),e.addressId||(t.addressId=!0,n=!0),e.projectId||(t.projectId=!0,n=!0),e.statusId)switch(a){case"interest":"loan"===r?e.amountInterest&&e.amountInterest<0&&(t.amountInterest=!0,n=!0):e.quantityInterest&&e.quantityInterest<0&&(t.quantityInterest=!0,n=!0);break;case"option":e.dateOption||(t.dateOption=!0,n=!0),"loan"===r?(!e.amountOption||e.amountOption<0)&&(t.amountOption=!0,n=!0):(!e.quantityOption||e.quantityOption<0)&&(t.quantityOption=!0,n=!0);break;case"granted":e.dateGranted||(t.dateGranted=!0,n=!0),"loan"===r?(!e.amountGranted||e.amountGranted<0)&&(t.amountGranted=!0,n=!0):(!e.quantityGranted||e.quantityGranted<0)&&(t.quantityGranted=!0,n=!0);break;case"final":e.dateEntry||(t.dateEntry=!0,n=!0),!x().isEmpty(e.dateEntry+"")&&!x().isEmpty(e.disableBeforeEntryDate)&&e.dateEntry<e.disableBeforeEntryDate&&(t.dateEntry=!0,n=!0),"loan"===r?(!e.amountFinal||e.amountFinal<0)&&(t.amountFinal=!0,n=!0):(!e.quantityFinal||e.quantityFinal<0)&&(t.quantityFinal=!0,n=!0)}else t.statusId=!0,n=!0;return{hasErrors:n,errors:t}}var P=n(63923);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){(0,a.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function B(){var e=(0,l.Zp)(),t=(0,l.g)(),n=(0,u.d4)((function(e){return e.systemData.participantMutationStatuses})),o=(0,u.d4)((function(e){return e.meDetails.administrations})),s=(0,d.useState)(!1),y=(0,i.A)(s,2),E=y[0],g=y[1],h=(0,d.useState)(!1),C=(0,i.A)(h,2),q=C[0],j=C[1],O=(0,d.useState)([]),k=(0,i.A)(O,2),w=k[0],N=k[1],S=(0,d.useState)(""),G=(0,i.A)(S,2),x=G[0],M=G[1],B=(0,d.useState)(""),T=(0,i.A)(B,2),z=T[0],L=T[1],V=(0,d.useState)(!1),W=(0,i.A)(V,2),_=W[0],K=W[1],Z=(0,d.useState)({}),J=(0,i.A)(Z,2),H=J[0],Q=J[1],U=(0,d.useState)([]),X=(0,i.A)(U,2),$=X[0],ee=X[1],te=(0,d.useState)([]),ne=(0,i.A)(te,2),ae=ne[0],re=ne[1],ie=(0,d.useState)(""),oe=(0,i.A)(ie,2),ce=oe[0],de=oe[1],le=(0,d.useState)(!1),ue=(0,i.A)(le,2),se=ue[0],me=ue[1],pe=(0,d.useState)(!!t.contactId),fe=(0,i.A)(pe,1)[0],ye=(0,d.useState)(!!t.projectId),ve=(0,i.A)(ye,1)[0],be=(0,d.useState)({contactId:t.contactId||"",addressId:"",statusId:"",projectId:t.projectId||"",quantityInterest:0,amountInterest:0,dateInterest:m()().format("YYYY-MM-DD"),quantityOption:0,amountOption:0,dateOption:m()().format("YYYY-MM-DD"),quantityGranted:0,amountGranted:0,dateGranted:m()().format("YYYY-MM-DD"),quantityFinal:0,amountFinal:0,dateContractRetour:null,datePayment:null,paymentReference:null,dateEntry:"",disableBeforeEntryDate:""}),Ie=(0,i.A)(be,2),Ee=Ie[0],ge=Ie[1],he=(0,d.useState)({contactId:!1,addressId:!1,statusId:!1,projectId:!1,amountOption:!1,dateOption:!1,amountGranted:!1,dateGranted:!1,amountFinal:!1,dateEntry:!1}),Ae=(0,i.A)(he,2),Ce=Ae[0],qe=Ae[1];function je(e,t){var n=m()(),a=t?m()(t):null,r=e?m()(e):null;return(r&&a?r.isAfter(a,"day")?r:a:r||a||n).format("YYYY-MM-DD")}var Oe=(0,d.useCallback)((function(e,t){var n=0;if(e&&e.lastYearFinancialOverviewDefinitive)n=e.lastYearFinancialOverviewDefinitive;else if(e){var a=null==o?void 0:o.find((function(t){return t.id==e.administrationId}));a&&a.lastYearFinancialOverviewDefinitive&&(n=a.lastYearFinancialOverviewDefinitive)}var r=n>0?m()(m()().year(n+1)).format("YYYY-01-01"):"";if((null==t?void 0:t.lastYearFinancialOverviewSent)>0){var i=t.lastYearFinancialOverviewSent;if(!(n>0)||i<n){var c=m()(m()().year(i+1)).format("YYYY-01-01");(!r||c>r)&&(r=c)}}return e&&"postalcode_link_capital"===e.typeCodeRef&&e.dateInterestBearingKwh&&(!r||m()(e.dateInterestBearingKwh).format("YYYY-MM-DD")>r)&&(r=m()(e.dateInterestBearingKwh).format("YYYY-MM-DD")),r}),[o]);(0,d.useEffect)((function(){var e=!1,n=function(){var n=(0,r.A)(c().mark((function n(){var a;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.contactId){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,P.A.getContactDetailsWithAddresses(t.contactId);case 4:if(a=n.sent,!e){n.next=7;break}return n.abrupt("return");case 7:Q(a),ge((function(e){return R(R({},e),{},{contactId:a.id,addressId:a?a.primaryAddressId:0})})),ee(a?a.addresses:[]);case 10:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),a=function(){var n=(0,r.A)(c().mark((function n(){var a,r,i;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,I.A.peekProjects();case 2:if(a=n.sent,!e){n.next=5;break}return n.abrupt("return");case 5:re(a),t.projectId&&(r=a.find((function(e){return e.id==t.projectId})))&&(i=Oe(r,H),de(r.typeCodeRef),me(r.isSceProject),ge((function(e){return R(R({},e),{},{dateEntry:je(r.dateEntry,i),disableBeforeEntryDate:i})})));case 7:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return n(),a(),function(){e=!0}}),[t.contactId,t.projectId,Oe]),(0,d.useEffect)((function(){var e=ae.find((function(e){return e.id==Ee.projectId}));if(e){var t=Oe(e,H),n=je(e.dateEntry,t);ge((function(e){var a=e.dateEntry&&(!t||m()(e.dateEntry).isSameOrAfter(t,"day")),r=R(R({},e),{},{disableBeforeEntryDate:t,dateEntry:a?e.dateEntry:n});return r.disableBeforeEntryDate===e.disableBeforeEntryDate&&r.dateEntry===e.dateEntry?e:r}))}}),[ae,Ee.projectId,H,Oe]);var ke=(0,d.useCallback)((function(e){var t=e.target,n=t.name,r=t.type,i=t.checked,o=t.value;ge((function(e){return R(R({},e),{},(0,a.A)({},n,"checkbox"===r?i:o))}))}),[]),we=(0,d.useCallback)((function(e,t){ge((function(n){return R(R({},n),{},(0,a.A)({},t,e))}))}),[]),Ne=(0,d.useCallback)(function(){var e=(0,r.A)(c().mark((function e(t){var n,a,r,i,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t?t.id:null){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,P.A.getContactDetailsWithAddresses(n);case 5:a=e.sent,Q(a),ge((function(e){return R(R({},e),{},{contactId:a.id,addressId:a?a.primaryAddressId:0})})),ee(a?a.addresses:[]),(r=ae.find((function(e){return e.id==Ee.projectId})))&&(i=Oe(r,a),o=je(r.dateEntry,i),ge((function(e){var t=e.dateEntry&&(!i||m()(e.dateEntry).isSameOrAfter(i,"day"));return R(R({},e),{},{disableBeforeEntryDate:i,dateEntry:t?e.dateEntry:o})})));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[ae,Ee.projectId,Oe]),Se=(0,d.useCallback)((function(e){ge((function(t){return R(R({},t),{},{addressId:e})}))}),[]),Ye=(0,d.useCallback)((function(e){var t=e,n=ae.find((function(e){return e.id==t}));if(n){var a=Oe(n,H);de(n.typeCodeRef),me(n.isSceProject),ge((function(e){return R(R({},e),{},{projectId:t,dateEntry:je(n.dateEntry,a),disableBeforeEntryDate:a})}))}}),[ae,H,Oe]),De=(0,d.useCallback)((function(e){var t,a=e.target.value,r=null===(t=n.find((function(e){return"final"===e.codeRef})))||void 0===t?void 0:t.id,i=Number(a)===r?null:m()().format("YYYY-MM-DD");ge((function(e){return R(R({},e),{},{statusId:a,dateGranted:i})}))}),[n]),Ge=(0,d.useCallback)(function(){var t=(0,r.A)(c().mark((function t(a){var r,i,o,d,l,u,s,m;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),r=n.find((function(e){return e.id==Ee.statusId})),i=r?r.codeRef:null,o=F(Ee,{},!1,i,ce),qe(o.errors),!o.hasErrors){t.next=7;break}return t.abrupt("return");case 7:return d=D(Ee,i,ce),K(!0),t.prev=9,t.next=12,b.A.storeParticipantProject(d);case 12:s=t.sent,(null==(m=s.data)||null===(l=m.message)||void 0===l?void 0:l.length)>0&&0==m.id?(N(m.message),j(!0)):(null==m||null===(u=m.message)||void 0===u?void 0:u.length)>0?(N(m.message),g(!0),M("/taak/nieuw/contact/".concat(Ee.contactId,"/project/").concat(Ee.projectId,"/deelnemer/").concat(m.id)),L("/project/deelnemer/".concat(m.id))):e("/project/deelnemer/".concat(m.id));case 15:return t.prev=15,K(!1),t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[9,,15,18]])})));return function(e){return t.apply(this,arguments)}}(),[n,Ee,ce,e]),xe=(0,d.useCallback)((function(){e(x)}),[e,x]),Fe=(0,d.useCallback)((function(){e(z)}),[e,z]);return d.createElement("div",{className:"row"},d.createElement("div",{className:"col-md-9"},d.createElement("div",{className:"col-md-12"},d.createElement(v,null)),d.createElement("div",{className:"col-md-12"},d.createElement(p.A,null,d.createElement(f.A,null,d.createElement("div",{className:"col-md-12"},d.createElement(Y,{editForm:!1,participation:Ee,errors:Ce,handleInputChange:ke,handleInputChangeDate:we,handleSubmit:Ge,selectedContact:H,addresses:$,projects:ae,projectTypeCodeRef:ce,isSceProject:se,disableProjectSelection:ve,disableClientSelection:fe,participantMutationStatuses:n,handleInputChangeContactId:Ne,handleInputChangeAddressId:Se,handleInputChangeProjectId:Ye,handleInputChangeStatusId:De,isLoading:_})))))),d.createElement("div",{className:"col-md-3"}),q&&d.createElement(A,{title:"Melding",closeModal:function(){return j(!1)},buttonCancelText:"Sluiten",showConfirmAction:!1,closingText:"De deelname is niet aangemaakt!"},w),E&&d.createElement(A,{title:"Waarschuwing",closeModal:Fe,buttonCancelText:"Nee",confirmAction:xe,buttonConfirmText:"Ja",closingText:"De deelname is aangemaakt, maar de gegevens zijn niet compleet. Wil je ook een taak aanmaken om je daar aan te herinneren ?"},w))}}}]);