"use strict";(self.webpackChunkeco=self.webpackChunkeco||[]).push([[3916],{23916:(t,e,a)=>{a.r(e),a.d(e,{default:()=>A});var n=a(15671),r=a(43144),o=a(97326),s=a(60136),i=a(82963),c=a(61120),l=a(4942),u=a(67294),p=a(61409),m=a(55451);const f=function(t){var e=t.name;return u.createElement("div",{className:"row"},u.createElement("div",{className:"col-md-4"},u.createElement("div",{className:"btn-group btn-group-flex margin-small",role:"group"},u.createElement(m.Z,{iconName:"arrowLeft",onClickAction:p.mW.goBack}))),u.createElement("div",{className:"col-md-4"},u.createElement("h4",{className:"text-center"},"Kans status: ",e)),u.createElement("div",{className:"col-md-4"}))};var d=a(96486),h=a(87462),v=a(86706),y=a(30381),E=a.n(y),g=(a(9181),a(49332)),S=a(14309),b=a(98688),w=a(69265),Z={fld:["id","name","usesWf"],rlt:{emailTemplateWorkflow:[]}};const O={fetchOpportunityStatusDetails:function(t){var e="jory/opportunity-status/".concat(t);return w.Z.get(e,{params:{jory:Z}})},updateOpportunityStatus:function(t){var e="".concat("opportunity-status","/").concat(t.id);return w.Z.post(e,t,{params:{jory:Z}})}};var k=a(83920),j=a(25725),D=a(21606),N=(a(82084),a(7250)),P=a(19789);function R(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function z(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?R(Object(a),!0).forEach((function(e){(0,l.Z)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}E().locale("nl");var T=function(t){(0,s.Z)(m,t);var e,a,p=(e=m,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.Z)(e);if(a){var r=(0,c.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,i.Z)(this,t)});function m(t){var e;return(0,n.Z)(this,m),e=p.call(this,t),(0,l.Z)((0,o.Z)(e),"handleInputChange",(function(t){var a=t.target,n="checkbox"===a.type?a.checked:a.value,r=a.name;e.setState(z(z({},e.state),{},{opportunityStatus:z(z({},e.state.opportunityStatus),{},(0,l.Z)({},r,n))}))})),(0,l.Z)((0,o.Z)(e),"handleSubmit",(function(t){t.preventDefault();var a=e.state.opportunityStatus;e.setState(z(z({},e.state),{},{errors:{}})),O.updateOpportunityStatus(a).then((function(t){e.props.updateState(t.data.data),e.props.fetchSystemData(),e.props.switchToView()})).catch((function(t){alert("Er is iets misgegaan bij opslaan. Herlaad de pagina en probeer het nogmaals.")}))})),e.state={emailTemplates:[],opportunityStatus:z({},t.opportunityStatus),errors:{usesWf:!1},peekLoading:{emailTemplates:!0}},e.handleReactSelectChange=e.handleReactSelectChange.bind((0,o.Z)(e)),e}return(0,r.Z)(m,[{key:"handleReactSelectChange",value:function(t,e){this.setState(z(z({},this.state),{},{opportunityStatus:z(z({},this.state.opportunityStatus),{},(0,l.Z)({},e,t))}))}},{key:"componentDidMount",value:function(){var t=this;P.Z.fetchEmailTemplatesPeek().then((function(e){return t.setState({emailTemplates:e,peekLoading:z(z({},t.state.peekLoading),{},{emailTemplates:!1})})}))}},{key:"render",value:function(){var t=this.state.opportunityStatus,e=t.name,a=t.usesWf;return u.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},u.createElement(S.Z,null,u.createElement(b.Z,null,u.createElement("div",{className:"row"},u.createElement(N.Z,{label:"Omschrijving",divSize:"col-sm-10",value:e,className:"col-sm-10 form-group"})),u.createElement("div",{className:"row"},u.createElement(D.Z,{label:"Gebruikt workflow email bij deze status",divSize:"col-sm-10",name:"usesWf",value:a,onChangeAction:this.handleInputChange})),1==a&&u.createElement(u.Fragment,null,u.createElement("div",{className:"row"},u.createElement(N.Z,{label:"Uitleg workflow",divSize:"col-sm-10",value:this.props.explanationWf,className:"col-sm-10 form-group"})))),u.createElement(b.Z,null,u.createElement("div",{className:"pull-right btn-group",role:"group"},u.createElement(g.Z,{buttonClassName:"btn-default",buttonText:"Sluiten",onClickAction:this.props.switchToView}),u.createElement(g.Z,{buttonText:"Opslaan",type:"submit",value:"Submit"})))))}}]),m}(u.Component);const C=(0,v.$j)(null,(function(t){return(0,k.DE)({fetchSystemData:j.P},t)}))(T),L=function(t){var e=t.name,a=t.usesWf,n=t.switchToEdit,r=t.explanationWf;return u.createElement("div",{onClick:n},u.createElement(S.Z,null,u.createElement(b.Z,null,u.createElement("div",{className:"row"},u.createElement(N.Z,{label:"Omschrijving",divSize:"col-sm-10",value:e,className:"col-sm-10 form-group"})),u.createElement("div",{className:"row"},u.createElement(N.Z,{label:"Gebruikt workflow bij deze status",divSize:"col-sm-10",value:a?"Ja":"Nee",className:"col-sm-10 form-group"})),1==a&&u.createElement(u.Fragment,null,u.createElement("div",{className:"row"},u.createElement(N.Z,{label:"Uitleg workflow",divSize:"col-sm-10",value:r,className:"col-sm-10 form-group"}))))))};var x=function(t){(0,s.Z)(m,t);var e,a,p=(e=m,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.Z)(e);if(a){var r=(0,c.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,i.Z)(this,t)});function m(t){var e;return(0,n.Z)(this,m),e=p.call(this,t),(0,l.Z)((0,o.Z)(e),"switchToEdit",(function(){e.setState({showEdit:!0})})),(0,l.Z)((0,o.Z)(e),"switchToView",(function(){e.setState({showEdit:!1,activeDiv:""})})),e.state={showEdit:!1,activeDiv:""},e}return(0,r.Z)(m,[{key:"onDivEnter",value:function(){this.setState({activeDiv:"panel-grey"})}},{key:"onDivLeave",value:function(){this.state.showEdit||this.setState({activeDiv:""})}},{key:"render",value:function(){var t=this,e=this.props.meDetails.permissions,a=void 0===e?{}:e,n=u.createElement("span",null,"Als gebruik workflow bij deze status is aangezet, dan zal er automatisch eenmalig een e-mail verstuurd gaan worden naar contact als kans op deze status is gezet.",u.createElement("br",null),"De verzenddatum wordt dan bepaald, rekening houdend met het opgegeven aantal dagen.",u.createElement("br",null),"Bij aantal dagen 0 zal de e-mail direct verzonden worden.");return u.createElement("div",{className:this.state.activeDiv,onMouseEnter:function(){return t.onDivEnter()},onMouseLeave:function(){return t.onDivLeave()}},this.state.showEdit&&a.manageFinancial?u.createElement(C,{opportunityStatus:this.props.opportunityStatus,switchToView:this.switchToView,updateState:this.props.updateState,explanationWf:n}):u.createElement(L,(0,h.Z)({},this.props.opportunityStatus,{switchToEdit:this.switchToEdit,explanationWf:n})))}}]),m}(u.Component);const W=(0,v.$j)((function(t){return{meDetails:t.meDetails,permissions:t.meDetails.permissions}}))(x),B=function(t){var e=t.opportunityStatus,a=t.hasError,n=t.isLoading,r=t.updateState,o="",s=!0;return a?o="Fout bij het ophalen van kans status.":n?o="Gegevens aan het laden.":(0,d.isEmpty)(e)?o="Geen kans status gevonden!":s=!1,s?u.createElement("div",null,o):u.createElement("div",null,u.createElement(W,{opportunityStatus:e,updateState:r}))};function F(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function V(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?F(Object(a),!0).forEach((function(e){(0,l.Z)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):F(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}const A=function(t){(0,s.Z)(m,t);var e,a,p=(e=m,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.Z)(e);if(a){var r=(0,c.Z)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return(0,i.Z)(this,t)});function m(t){var e;return(0,n.Z)(this,m),e=p.call(this,t),(0,l.Z)((0,o.Z)(e),"callFetchOpportunityStatusDetails",(function(){e.setState({isLoading:!0,hasError:!1}),O.fetchOpportunityStatusDetails(e.props.params.id).then((function(t){e.setState({isLoading:!1,opportunityStatus:V({},t.data.data)})})).catch((function(t){e.setState({isLoading:!1,hasError:!0})}))})),(0,l.Z)((0,o.Z)(e),"updateState",(function(t){e.setState({opportunityStatus:t})})),e.state={opportunityStatus:{},isLoading:!1,hasError:!1},e}return(0,r.Z)(m,[{key:"componentDidMount",value:function(){this.callFetchOpportunityStatusDetails()}},{key:"render",value:function(){return u.createElement("div",{className:"row"},u.createElement("div",{className:"col-md-9"},u.createElement("div",{className:"col-md-12 margin-10-top"},u.createElement(S.Z,null,u.createElement(b.Z,{className:"panel-small"},u.createElement(f,{name:this.state.opportunityStatus.name||""})))),u.createElement("div",{className:"col-md-12 margin-10-top"},u.createElement(B,{opportunityStatus:this.state.opportunityStatus,isLoading:this.state.isLoading,hasError:this.state.hasError,updateState:this.updateState}))),u.createElement("div",{className:"col-md-3"}))}}]),m}(u.Component)}}]);