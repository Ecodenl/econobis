"use strict";(self.webpackChunkeco=self.webpackChunkeco||[]).push([[4208],{71529:(e,t,a)=>{a.d(t,{Z:()=>g});var n=a(4942),r=a(67294),o=a(83804),i=a(88389),s=a(68087),l=a(4872),c=o.Z,d=function(e){return"theme"!==e&&"innerRef"!==e},u=function(e){return"string"==typeof e&&e.charCodeAt(0)>96?c:d};function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var p=function(){return null};var h=function e(t,a){var o,c,d;void 0!==a&&(o=a.label,d=a.target,c=t.__emotion_forwardProp&&a.shouldForwardProp?function(e){return t.__emotion_forwardProp(e)&&a.shouldForwardProp(e)}:a.shouldForwardProp);var h=t.__emotion_real===t,g=h&&t.__emotion_base||t;"function"!=typeof c&&h&&(c=t.__emotion_forwardProp);var v=c||u(g),E=!v("as");return function(){var f=arguments,b=h&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==o&&b.push("label:"+o+";"),null==f[0]||void 0===f[0].raw)b.push.apply(b,f);else{b.push(f[0][0]);for(var w=f.length,k=1;k<w;k++)b.push(f[k],f[0][k])}var y=(0,i.Xn)((function(e,t,a){return(0,r.createElement)(i.Ni.Consumer,null,(function(n){var o=E&&e.as||g,i="",m=[],h=e;if(null==e.theme){for(var f in h={},e)h[f]=e[f];h.theme=n}"string"==typeof e.className?i=(0,s.f)(t.registered,m,e.className):null!=e.className&&(i=e.className+" ");var w=(0,l.O)(b.concat(m),t.registered,h);(0,s.M)(t,w,"string"==typeof o),i+=t.key+"-"+w.name,void 0!==d&&(i+=" "+d);var k=E&&void 0===c?u(o):v,y={};for(var j in e)E&&"as"===j||k(j)&&(y[j]=e[j]);y.className=i,y.ref=a||e.innerRef;var C=(0,r.createElement)(o,y),Z=(0,r.createElement)(p,null);return(0,r.createElement)(r.Fragment,null,Z,C)}))}));return y.displayName=void 0!==o?o:"Styled("+("string"==typeof g?g:g.displayName||g.name||"Component")+")",y.defaultProps=t.defaultProps,y.__emotion_real=y,y.__emotion_base=g,y.__emotion_styles=b,y.__emotion_forwardProp=c,Object.defineProperty(y,"toString",{value:function(){return"."+d}}),y.withComponent=function(t,r){return e(t,void 0!==r?function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},a||{},{},r):a).apply(void 0,b)},y}}.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){h[e]=h(e)}));const g=h},74208:(e,t,a)=>{a.r(t),a.d(t,{default:()=>pe});var n=a(15671),r=a(43144),o=a(60136),i=a(82963),s=a(61120),l=a(67294),c=a(86706),d=a(97326),u=a(4942),m=a(61409),p=a(14309),h=a(98688),g=a(55451),v=a(41355),E=a(67843);const f=function(e){return l.createElement(v.Z,{buttonConfirmText:"Verwijder",buttonClassName:"btn-danger",closeModal:e.closeDeleteItemModal,confirmAction:function(){E.Z.deleteProjectRevenue(e.id).then((function(){m.nA.push("/project/details/".concat(e.projectId))}))},title:"Verwijderen"},l.createElement("p",null,"Weet u zeker dat u deze opbrengst wilt verwijderen?"))};var b=a(72506),w=a(83920),k=a(30381),y=a.n(k),j=a(35823),C=a.n(j);var Z=function(e){(0,o.Z)(v,e);var t,a,c=(t=v,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,s.Z)(t);if(a){var r=(0,s.Z)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return(0,i.Z)(this,e)});function v(e){var t;return(0,n.Z)(this,v),t=c.call(this,e),(0,u.Z)((0,d.Z)(t),"toggleDelete",(function(){t.setState({showDelete:!t.state.showDelete})})),(0,u.Z)((0,d.Z)(t),"getCSV",(function(){t.props.blockUI(),setTimeout((function(){E.Z.getCSV(t.props.revenue.id).then((function(e){C()(e.data,"Opbrengstverdeling-"+y()().format("YYYY-MM-DD HH:mm:ss")+".csv"),t.props.unblockUI()})).catch((function(e){t.props.unblockUI()}))}),100)})),t.state={showDelete:!1},t}return(0,r.Z)(v,[{key:"render",value:function(){var e=this.props.revenue;return"project/opbrengst/".concat(this.props.revenue.id,"/energieleverancier-rapport"),"project/opbrengst/".concat(this.props.revenue.id,"/energieleverancier-excel"),e.category&&e.category.codeRef,l.createElement("div",{className:"row"},l.createElement("div",{className:"col-sm-12"},l.createElement(p.Z,null,l.createElement(h.Z,{className:"panel-small"},l.createElement("div",{className:"col-md-2"},l.createElement("div",{className:"btn-group btn-group-flex margin-small",role:"group"},l.createElement(g.Z,{iconName:"arrowLeft",onClickAction:m.mW.goBack}),this.props.permissions.manageFinancial&&!this.props.revenue.confirmed&&l.createElement(g.Z,{iconName:"trash",onClickAction:this.toggleDelete}),l.createElement(g.Z,{iconName:"download",onClickAction:this.getCSV}))),l.createElement("div",{className:"col-md-8"},l.createElement("h4",{className:"text-center text-success margin-small"},l.createElement("strong",null,"Opbrengst project ",e.project?e.project.name:""))),l.createElement("div",{className:"col-md-2"})))),this.state.showDelete&&l.createElement(f,{closeDeleteItemModal:this.toggleDelete,id:e.id,projectId:e.project.id}))}}]),v}(l.Component);const R=(0,c.$j)((function(e){return{revenue:e.projectRevenue,permissions:e.meDetails.permissions}}),(function(e){return(0,w.DE)({blockUI:b.Q,unblockUI:b.e},e)}))(Z);var T=a(15690),D=a(93433),N=a(88211),P=a(48966),S=a.n(P);y().locale("nl");const I=function(e){var t=e.participation,a=t.id,n=t.contactName,r=t.contactType,o=t.contactPrimaryEmailAddress,i=t.address,s=t.postalCode,c=t.city,d=t.contactIban,u=t.payoutIban,m=t.deliveredTotal,p=t.kwhReturn,h=t.participationsAmount,g=t.participationsLoanAmount,v=t.payout,E=t.payoutType,f=t.payoutTypeCodeRef,b=t.datePayout,w=t.energySupplierName,k=t.status,j=!("createInvoices"===e.createType||o&&o.email&&!S().isEmpty(o.email)),C=!(i&&!S().isEmpty(i)),Z=!(s&&!S().isEmpty(s)),R=!(c&&!S().isEmpty(c)),T=!("revenueKwh"===e.projectRevenueCategoryCodeRef||"account"!==f||d&&!S().isEmpty(d)||u&&!S().isEmpty(u)),D=j||C||Z||R?"Er ontbreken contactgegevens (email, adres, postcode of plaats).":"",P=T?"Iban code ontbreekt.":"",I=j||C||Z||R||T?"missing-data-row":null,A="";switch(k){case"concept":A="Concept";break;case"confirmed":A="Definitief";break;case"in-progress":A="Bezig...";break;case"processed":A="Verwerkt"}return l.createElement("div",{title:D+" "+P,className:"row border ".concat("processed"===k?"warning-row":""," ").concat(I||"")},e.showCheckboxList?"createInvoices"!==e.createType?e.distributionIds.includes(a)?l.createElement("div",{className:"col-sm-1"},l.createElement("input",{type:"checkbox",name:a,onChange:e.toggleDistributionCheck,checked:e.distributionIds.includes(a)})):l.createElement("div",{className:"col-sm-1"}):e.distributionIdsTotalToProcess.includes(a)?l.createElement("div",{className:"col-sm-1"},l.createElement("input",{type:"checkbox",name:a,onChange:e.toggleDistributionCheck,checked:e.distributionIds.includes(a)})):l.createElement("div",{className:"col-sm-1"}):null,l.createElement("div",{className:"col-sm-1"},r?r.name:""),l.createElement("div",{className:"col-sm-2"},n),"loan"===e.projectTypeCodeRef?l.createElement("div",{className:"col-sm-2"},(0,N.Z)(g)):l.createElement("div",{className:"col-sm-1"},h),"revenueKwh"===e.projectRevenueCategoryCodeRef?l.createElement(l.Fragment,null,l.createElement("div",{className:"col-sm-2"},w&&w),l.createElement("div",{className:"col-sm-1"},m&&m),l.createElement("div",{className:"col-sm-2"},p?"â‚¬"+p.toLocaleString("nl",{minimumFractionDigits:2,maximumFractionDigits:2}):"")):l.createElement(l.Fragment,null,l.createElement("div",{className:"col-sm-2"},v?(0,N.Z)(v):0),l.createElement("div",{className:"col-sm-1"},E&&E),l.createElement("div",{className:"col-sm-2"},b?y()(b).format("L"):"")),l.createElement("div",{className:"col-sm-2"},A))};var A=a(51910);const M=(0,c.$j)((function(e){var t,a;return{projectTypeCodeRef:null===(t=e.projectRevenue.project)||void 0===t||null===(a=t.projectType)||void 0===a?void 0:a.codeRef,projectRevenue:e.projectRevenue}}))((function(e){return l.createElement("div",null,l.createElement("div",{className:"row border header"},e.projectRevenue.confirmed&&e.showCheckboxList?l.createElement("div",{className:"col-sm-1"},l.createElement("input",{type:"checkbox",onChange:e.toggleCheckedAll,checked:e.checkedAll})):null,l.createElement("div",{className:"col-sm-1"},"Type"),l.createElement("div",{className:"col-sm-2"},"Naam"),"loan"==e.projectTypeCodeRef?l.createElement("div",{className:"col-sm-2"},"Huidige lening"):l.createElement("div",{className:"col-sm-1"},"Deelnames"),"revenueKwh"===e.projectRevenue.category.codeRef?l.createElement(l.Fragment,null,l.createElement("div",{className:"col-sm-2"},"Energieleverancier"),l.createElement("div",{className:"col-sm-1"},"Geleverd totaal"),l.createElement("div",{className:"col-sm-2"},"Teruggave energiebelasting")):"","revenueEuro"===e.projectRevenue.category.codeRef?l.createElement(l.Fragment,null,l.createElement("div",{className:"col-sm-2"},"Uit te keren bedrag"),l.createElement("div",{className:"col-sm-1"},"Uitkeren op"),l.createElement("div",{className:"col-sm-2"},"Datum uitkering")):"","redemptionEuro"===e.projectRevenue.category.codeRef?l.createElement(l.Fragment,null,l.createElement("div",{className:"col-sm-2"},"Af te lossen bedrag"),l.createElement("div",{className:"col-sm-1"},"Aflossen op"),l.createElement("div",{className:"col-sm-2"},"Datum aflossing")):"",l.createElement("div",{className:"col-sm-2"},"Status")),e.projectRevenue.distribution&&e.projectRevenue.distribution.data.length>0?e.projectRevenue.distribution.data.map((function(t){return l.createElement(I,{key:t.id,participation:t,showCheckboxList:e.showCheckboxList,toggleDistributionCheck:e.toggleDistributionCheck,projectRevenueCategoryCodeRef:e.projectRevenue.category.codeRef,projectTypeCodeRef:e.projectTypeCodeRef,distributionIds:e.distributionIds,createType:e.createType,distributionIdsTotalToProcess:e.distributionIdsTotalToProcess})})):l.createElement("div",null,"Geen deelnemers bekend."),l.createElement(A.Z,{initialPage:0,onPageChangeAction:e.changePage,recordsPerPage:100,totalRecords:e.projectRevenue.distribution&&e.projectRevenue.distribution.meta&&e.projectRevenue.distribution.meta.total}))}));var x=a(80720),F=a(49332),L=a(71840),Y=a(80251),B=a(7250),O=a(19789),H=a(9181),z=a(11776),W=a(27879),_=a.n(W),K=a(54138),V=a(12457),q=a(21606);var U=function(e){(0,o.Z)(f,e);var t,a,c=(t=f,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,s.Z)(t);if(a){var r=(0,s.Z)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return(0,i.Z)(this,e)});function f(e){var t;return(0,n.Z)(this,f),t=c.call(this,e),(0,u.Z)((0,d.Z)(t),"reloadDistributions",(function(){t.props.getDistribution(t.props.projectRevenue.id,0)})),(0,u.Z)((0,d.Z)(t),"changePage",(function(e){var a=e.selected;t.props.getDistribution(t.props.projectRevenue.id,a)})),(0,u.Z)((0,d.Z)(t),"handleInputChange",(function(e){var a=e.target,n="checkbox"===a.type?a.checked:a.value,r=a.name;t.setState((0,u.Z)({},r,n))})),(0,u.Z)((0,d.Z)(t),"handleInputChangeDate",(function(e,a){t.setState((0,u.Z)({},a,e))})),(0,u.Z)((0,d.Z)(t),"handleSubjectChange",(function(e){var a=e.target,n="checkbox"===a.type?a.checked:a.value;t.setState({subject:n})})),(0,u.Z)((0,d.Z)(t),"handleEmailTemplateChange",(function(e){var a=e.target,n="checkbox"===a.type?a.checked:a.value;a.name,t.setState({emailTemplateId:n}),O.Z.fetchEmailTemplateWithUser(n).then((function(e){t.setState({subject:e.subject?e.subject:t.state.subject})}))})),(0,u.Z)((0,d.Z)(t),"toggleShowCheckboxList",(function(e){t.state.showCheckboxList?t.setState({showCheckboxList:!1,distributionIds:[],createType:""}):t.setState({showCheckboxList:!0,createType:e,distributionIds:t.props.projectRevenue.distribution.meta.distributionIdsTotal,checkedAll:!0})})),(0,u.Z)((0,d.Z)(t),"toggleModal",(function(){t.setState({showModal:!t.state.showModal})})),(0,u.Z)((0,d.Z)(t),"toggleCheckedAll",(function(e){var a=e.target.checked,n=[];a&&(n=t.props.projectRevenue.distribution.meta.distributionIdsTotal),t.setState({distributionIds:n,checkedAll:a})})),(0,u.Z)((0,d.Z)(t),"closeSuccesMessage",(function(){t.toggleShowCheckboxList(),t.setState({showSuccessMessage:"",createType:""}),t.reloadDistributions()})),(0,u.Z)((0,d.Z)(t),"toggleDistributionCheck",(function(e){var a=e.target.checked,n=Number(e.target.name);a?t.setState({distributionIds:[].concat((0,D.Z)(t.state.distributionIds),[n])},t.checkAllDistributionsAreChecked):t.setState({distributionIds:t.state.distributionIds.filter((function(e){return e!==n})),checkedAll:!1})})),(0,u.Z)((0,d.Z)(t),"checkDistributionRevenueReport",(function(){var e=!1;S().isEmpty(t.state.templateId)?(e=!0,t.setState({templateIdError:!0})):t.setState({templateIdError:!1}),S().isEmpty(t.state.emailTemplateId)?(e=!0,t.setState({emailTemplateIdError:!0})):t.setState({emailTemplateIdError:!1}),S().isEmpty(t.state.datePayout+"")?(e=!0,t.setState({datePayoutError:!0})):t.setState({datePayoutError:!1}),t.state.distributionIds.length>0&&!e?(t.props.previewReport({templateId:t.state.templateId,emailTemplateId:t.state.emailTemplateId,subject:t.state.subject,distributionIds:t.state.distributionIds,showOnPortal:t.state.showOnPortal}),m.nA.push("/project/opbrengst/".concat(t.props.projectRevenue.id,"/rapportage"))):e||t.setState({showModal:!0,modalText:"Er zijn geen deelnemers geselecteerd.",buttonConfirmText:"Voeg deelnemers toe"})})),(0,u.Z)((0,d.Z)(t),"checkDistributionRevenueInvoices",(function(){var e=0;t.props.projectRevenue.project&&t.props.projectRevenue.project.lastYearFinancialOverviewDefinitive?e=t.props.projectRevenue.project.lastYearFinancialOverviewDefinitive:t.props.projectRevenue.project.administration&&t.props.projectRevenue.project.administration.lastYearFinancialOverviewDefinitive&&(e=t.props.projectRevenue.project.administration.lastYearFinancialOverviewDefinitive);var a=e>0?_()(_()().year(e+1)).format("YYYY-01-01"):"",n="redemptionEuro"===t.props.projectRevenue.category.codeRef?"aflossingsdatum":"uitkeringsdatum";if(!S().isEmpty(a)&&_()(t.state.datePayout).format("YYYY-MM-DD")<a)return t.props.setError(412,"De "+n+" valt in jaar waar al een definitive waardestaat voor dit project aanwezig is."),void t.setState({showModal:!1});if(t.state.distributionIds.length){if(!t.props.projectRevenue.project.administration.canCreatePaymentInvoices.can)return t.props.setError(412,t.props.projectRevenue.project.administration.canCreatePaymentInvoices.message),void t.setState({showModal:!1});t.setState({showModal:!0,modalText:"De "+n+" wordt de datum die bij de mutatie komt te staan in de deelname overzichten van de deelnemers.\nIn een eventueel te maken Sepa betaalbestand wordt dit de datum waarop het bedrag van jouw rekening wordt afgeschreven, als je het Sepa betaalbestand hebt aangeboden bij je bank. Als je dus een "+n+" gebruikt, die voor of op de huidige datum ligt, dan kan je het Sepa bestand dus niet gebruiken.\n\nWeet je zeker dat je de goede "+n+" hebt gekozen ?",modalText2:_()(t.state.datePayout).format("YYYY-MM-DD")<_()().nextBusinessDay().format("YYYY-MM-DD")?"Gekozen "+n+" ("+_()(t.state.datePayout).format("L")+") ligt voor volgende werkdag!":"",modalAction:t.createPaymentInvoices,buttonConfirmText:"Ga verder"})}else t.setState({showModal:!0,modalText:"Er zijn geen deelnemers geselecteerd.",buttonConfirmText:"Voeg deelnemers toe"})})),(0,u.Z)((0,d.Z)(t),"createPaymentInvoices",(function(){t.toggleModal();var e="**onbekend**";t.props.projectRevenue&&t.props.projectRevenue.project&&t.props.projectRevenue.project.administration&&(e=t.props.projectRevenue.project.administration.name);var a;a="revenueKwh"===t.props.projectRevenue.category.codeRef?'De mutaties van opbrengsten bij de deelnemers zijn aangemaakt. De status van de uitkeringen zijn veranderd van "Definitief" in Verwerkt.\n                Mutaties die niet verwerkt konden worden, omdat er gegevens ontbreken bij het contact, zijn niet aangemaakt bij de deelnemers. Zij behouden de status "Definitief". Maak de gegevens compleet en maak vervolgens opnieuw een opbrengst verdeling van de uitkeringen met de status "Definitief".':"redemptionEuro"===t.props.projectRevenue.category.codeRef?'De mutaties van aflossing bij de deelnemers zijn aangemaakt. De status van de aflossingen zijn veranderd van "Definitief" in Verwerkt.\n                Mutaties die niet verwerkt konden worden, omdat er gegevens ontbreken bij het contact, zijn niet aangemaakt bij de deelnemers. Zij behouden de status "Definitief". Maak de gegevens compleet en maak vervolgens opnieuw een aflossing verdeling van de aflossingen met de status "Definitief".':'De mutaties van opbrengsten bij de deelnemers zijn aangemaakt. De status van de uitkeringen zijn veranderd van "Definitief" in Verwerkt.\n                Indien er sprake is van uitkeren op rekening, dan is er van de betreffende uitkeringen een Sepa betaalbestand aangemaakt. Deze kan je vinden bij de administratie "'+e+'". Mutaties die niet verwerkt konden worden, omdat er gegevens ontbreken bij het contact, zijn niet aangemaakt bij de deelnemers. Zij behouden de status "Definitief". Maak de gegevens compleet en maak vervolgens opnieuw een opbrengst verdeling van de uitkeringen met de status "Definitief."',document.body.style.cursor="wait",E.Z.createPaymentInvoices(t.state.datePayout,t.state.distributionIds,t.state.description).then((function(e){document.body.style.cursor="default",t.setState({showSuccessMessage:!0,successMessage:a})})).catch((function(e){var a=JSON.parse(JSON.stringify(e)),n="Er is iets misgegaan bij opslaan. Probeer het opnieuw.";500!==a.response.status&&(n=a.response.data.message),t.setState({showErrorModal:!0,modalErrorMessage:n})}))})),(0,u.Z)((0,d.Z)(t),"closeErrorModal",(function(){t.setState({showErrorModal:!1,modalErrorMessage:""})})),t.state={distributionIds:[],templateId:"",templateIdError:!1,templates:[],emailTemplateId:"",emailTemplateIdError:!1,emailTemplates:[],datePayout:_()().nextBusinessDay().format("YYYY-MM-DD"),datePayoutError:!1,subject:[],documentGroup:"",checkedAll:!1,showCheckboxList:!1,showModal:!1,showSuccessMessage:!1,modalText:"",modalText2:"",modalAction:t.toggleModal,buttonConfirmText:"",readyForCreation:!1,createType:"",showErrorModal:!1,modalErrorMessage:"",showOnPortal:!0,description:""},t}return(0,r.Z)(f,[{key:"componentDidMount",value:function(){var e=this;Y.Z.fetchDocumentTemplatesPeekGeneral().then((function(t){var a=[];t.forEach((function(e){"revenue"==e.group&&a.push({id:e.id,name:e.name})})),e.setState({templates:a})})),O.Z.fetchEmailTemplatesPeek().then((function(t){e.setState({emailTemplates:t})})),this.props.getDistribution(this.props.projectRevenue.id,0)}},{key:"checkAllDistributionsAreChecked",value:function(){this.setState({checkedAll:this.state.distributionIds.length===this.props.projectRevenue.distribution.meta.distributionIdsTotal.length})}},{key:"render",value:function(){var e=this,t=[];this.props.administrations.forEach((function(e){t.push(e.id)}));var a;a=this.props&&this.props.projectRevenue&&this.props.projectRevenue.distribution&&this.props.projectRevenue.distribution.meta&&this.props.projectRevenue.distribution.meta.distributionIdsTotal?this.state.distributionIds.length+"/"+this.props.projectRevenue.distribution.meta.distributionIdsTotal.length:this.state.distributionIds.length;var n;n=this.props&&this.props.projectRevenue&&this.props.projectRevenue.distribution&&this.props.projectRevenue.distribution.meta&&this.props.projectRevenue.distribution.meta.totalToProcess?this.props.projectRevenue.distribution.meta.totalToProcess:0;var r=[];return this.props&&this.props.projectRevenue&&this.props.projectRevenue.distribution&&this.props.projectRevenue.distribution.meta&&this.props.projectRevenue.distribution.meta.distributionIdsTotalToProcess&&(r=this.props.projectRevenue.distribution.meta.distributionIdsTotalToProcess),l.createElement(p.Z,null,l.createElement(x.Z,null,l.createElement("span",{className:"h5 text-bold"},"Opbrengstverdeling deelnemers"),l.createElement("div",{className:"btn-group pull-right"},l.createElement(g.Z,{iconName:"refresh",onClickAction:this.reloadDistributions}),1==this.props.projectRevenue.confirmed&&t.includes(this.props.projectRevenue.project.administrationId)&&(""===this.state.createType?l.createElement(l.Fragment,null,l.createElement(F.Z,{buttonText:"Selecteer preview rapportage",onClickAction:function(){return e.toggleShowCheckboxList("createReport")}}),l.createElement(F.Z,{buttonText:"redemptionEuro"===this.props.projectRevenue.category.codeRef?"Selecteer preview aflossing verdeling":"Selecteer preview mutaties en sepa bestand uitkeringsdatum",onClickAction:function(){return e.toggleShowCheckboxList("createInvoices")},buttonClassName:"btn-primary",title:"redemptionEuro"===this.props.projectRevenue.category.codeRef?" ":"De uitkeringsdatum is de datum in het SEPA bestand en de datum van de mutaties in het mutatieoverzicht van de deelnemers. Als je niet gaat uitkeren ('naar kapitaalrekening (niet uitbetalen)') betreft het alleen de mutatiedatum en is de uitkeringsdatum niet van toepassing.",disabled:0===n})):null))),l.createElement(h.Z,null,this.state.showCheckboxList&&"createReport"===this.state.createType?l.createElement(p.Z,null,l.createElement(h.Z,null,l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-12"},l.createElement(B.Z,{label:"Documentgroep",value:"Opbrengst"}),l.createElement(L.Z,{label:"Document template",name:"templateId",value:this.state.templateId,options:this.state.templates,onChangeAction:this.handleInputChange,required:"required",error:this.state.templateIdError})),l.createElement("div",{className:"col-md-12"},l.createElement(L.Z,{label:"E-mail template",name:"emailTemplateId",value:this.state.emailTemplateId,options:this.state.emailTemplates,onChangeAction:this.handleEmailTemplateChange,required:"required",error:this.state.emailTemplateIdError}),l.createElement(H.Z,{label:"E-mail onderwerp",name:"subject",value:this.state.subject,onChangeAction:this.handleSubjectChange})),l.createElement("div",{className:"col-md-12"},l.createElement(B.Z,{label:"Geselecteerde deelnemers",value:a}),l.createElement(q.Z,{label:"Rapportage tonen op portal",name:"showOnPortal",value:this.state.showOnPortal,onChangeAction:this.handleInputChange})),l.createElement("div",{className:"col-md-12"},l.createElement("div",{className:"margin-10-top pull-right btn-group",role:"group"},l.createElement(F.Z,{buttonClassName:"btn-default",buttonText:"Annuleren",onClickAction:this.toggleShowCheckboxList}),l.createElement(F.Z,{buttonText:"Preview rapportage",onClickAction:this.checkDistributionRevenueReport,type:"submit",value:"Submit"})))))):null,this.state.showCheckboxList&&"createInvoices"===this.state.createType?l.createElement(p.Z,null,l.createElement(h.Z,null,l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-6"},l.createElement(K.Z,{label:"redemptionEuro"===this.props.projectRevenue.category.codeRef?"Aflossingsdatum":"Uitkeringsdatum",name:"datePayout",value:this.state.datePayout,onChangeAction:this.handleInputChangeDate,required:"required",size:"col-md-5",labelSize:"col-md-7",divSize:"col-md-12",error:this.state.datePayoutError})),l.createElement("div",{className:"col-md-6"},l.createElement(H.Z,{label:"Omschrijving transacties",name:"description",size:"col-md-7",labelSize:"col-md-5",divSize:"col-md-12",maxLength:100,onChangeAction:this.handleInputChange,value:this.state.description})),l.createElement("div",{className:"col-md-12"},l.createElement("div",{className:"margin-10-top pull-right btn-group",role:"group"},l.createElement(F.Z,{buttonClassName:"btn-default",buttonText:"Annuleren",onClickAction:this.toggleShowCheckboxList}),l.createElement(F.Z,{buttonText:"revenueKwh"===this.props.projectRevenue.category.codeRef?"Mutaties aanmaken":"redemptionEuro"===this.props.projectRevenue.category.codeRef?"Aflossing verdelen en Sepa bestand maken":"Mutaties aanmaken en Sepa bestand maken",onClickAction:this.checkDistributionRevenueInvoices,type:"submit",value:"Submit",title:"revenueKwh"===this.props.projectRevenue.category.codeRef||"redemptionEuro"===this.props.projectRevenue.category.codeRef?" ":"Met de knop Mutaties aanmaken en Sepa bestand maak je mutaties aan in het mutatieoverzicht van de individuele deelnemers en genereer je een Sepa bestand om bij de bank te uploaden. Het Sepa bestand vind je na het aanmaken terug bij Instellingen > Administratie > onder de betreffende administratie."})))))):null,l.createElement("div",{className:"col-md-12"},l.createElement(M,{changePage:this.changePage,showCheckboxList:this.state.showCheckboxList,toggleCheckedAll:this.toggleCheckedAll,checkedAll:this.state.checkedAll,toggleDistributionCheck:this.toggleDistributionCheck,distributionIds:this.state.distributionIds,createType:this.state.createType,distributionIdsTotalToProcess:r}))),this.state.showModal&&l.createElement(v.Z,{title:"Deelnemer rapport maken",closeModal:this.toggleModal,buttonConfirmText:this.state.buttonConfirmText,confirmAction:this.state.modalAction},this.state.modalText,l.createElement("br",null),l.createElement("br",null),this.state.modalText2),this.state.showSuccessMessage&&l.createElement(v.Z,{title:"Succes",closeModal:this.closeSuccesMessage,buttonCancelText:"Ok",showConfirmAction:!1},this.state.successMessage),this.state.showErrorModal&&l.createElement(V.Z,{closeModal:this.closeErrorModal,title:"Fout bij opslaan",errorMessage:this.state.modalErrorMessage}))}}]),f}(l.Component);const G=(0,c.$j)((function(e){return{projectRevenue:e.projectRevenue,documentGroups:e.systemData.documentGroups,administrations:e.meDetails.administrations}}),(function(e){return{previewReport:function(t){e((0,T.tG)(t))},getDistribution:function(t,a){e((0,T.VY)({id:t,page:a}))},setError:function(t,a){e((0,z.s)(t,a))}}}))(U);y().locale("nl");const $=(0,c.$j)((function(e){return{revenue:e.projectRevenue}}))((function(e){var t=e.revenue,a=t.createdAt,n=t.createdBy;return l.createElement("div",null,l.createElement("div",{className:"row"},l.createElement(B.Z,{label:"Gemaakt op",value:a?y()(a).format("L"):"Onbekend"}),l.createElement(B.Z,{label:"Gemaakt door",value:n?n.fullName:"Onbekend"})))})),J=function(e){return l.createElement(p.Z,null,l.createElement(x.Z,null,l.createElement("span",{className:"h5 text-bold"},"Afsluiting gegevens")),l.createElement(h.Z,null,l.createElement("div",{className:"col-md-12"},l.createElement($,null))))};var Q,X=a(30168),ee=a(25626),te=a(71529);function ae(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ne(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(a),!0).forEach((function(t){(0,u.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ae(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}y().locale("nl");var re=te.Z.em(Q||(Q=(0,X.Z)(["\n    font-weight: normal;\n"]))),oe=function(e){(0,o.Z)(m,e);var t,a,c=(t=m,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,s.Z)(t);if(a){var r=(0,s.Z)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return(0,i.Z)(this,e)});function m(e){var t;(0,n.Z)(this,m),t=c.call(this,e),(0,u.Z)((0,d.Z)(t),"isPeriodExceedingYear",(function(e,t){return e=y()(e),(t=y()(t)).year()>e.year()})),(0,u.Z)((0,d.Z)(t),"toggleShowModal",(function(){t.setState({showModal:!t.state.showModal})})),(0,u.Z)((0,d.Z)(t),"cancelSetDate",(function(){t.setState(ne(ne({},t.state),{},{revenue:ne(ne({},t.state.revenue),{},{dateConfirmed:"",confirmed:!1})})),t.setState({showModal:!t.state.showModal})})),(0,u.Z)((0,d.Z)(t),"handleInputChange",(function(e){var a=e.target,n="checkbox"===a.type?a.checked:a.value,r=a.name;t.setState(ne(ne({},t.state),{},{revenue:ne(ne({},t.state.revenue),{},(0,u.Z)({},r,n))}),(function(){return t.linkedValueAdjustment(r)})),setTimeout((function(){var e=(t.state.revenue.kwhStartLow?parseFloat(t.state.revenue.kwhStartLow):0)+(t.state.revenue.kwhStartHigh?parseFloat(t.state.revenue.kwhStartHigh):0),a=(t.state.revenue.kwhEndLow?parseFloat(t.state.revenue.kwhEndLow):0)+(t.state.revenue.kwhEndHigh?parseFloat(t.state.revenue.kwhEndHigh):0),n=a-e;t.setState(ne(ne({},t.state),{},{revenue:ne(ne({},t.state.revenue),{},{kwhStart:e,kwhEnd:a,kwhTotal:n})}))}),200)})),(0,u.Z)((0,d.Z)(t),"linkedValueAdjustment",(function(e){"keyAmountFirstPercentage"===e&&(t.state.revenue.keyAmountFirstPercentage&&0!=t.state.revenue.keyAmountFirstPercentage||t.setState(ne(ne({},t.state),{},{revenue:ne(ne({},t.state.revenue),{},{payPercentageValidFromKeyAmount:""})})))})),(0,u.Z)((0,d.Z)(t),"handleInputChangeDate",(function(e,a){t.setState(ne(ne({},t.state),{},{revenue:ne(ne({},t.state.revenue),{},(0,u.Z)({},a,e))}))})),(0,u.Z)((0,d.Z)(t),"handleInputChangeDateConfirmed",(function(e,a){var n,r;e?(t.setState(ne(ne({},t.state),{},{revenue:ne(ne({},t.state.revenue),{},(n={},(0,u.Z)(n,a,e),(0,u.Z)(n,"confirmed",!0),n))})),t.toggleShowModal()):t.setState(ne(ne({},t.state),{},{revenue:ne(ne({},t.state.revenue),{},(r={},(0,u.Z)(r,a,e),(0,u.Z)(r,"confirmed",!1),r))}))})),(0,u.Z)((0,d.Z)(t),"handleSubmit",(function(e){e.preventDefault();var a=t.state.revenue,n={},r={},o=!1;if(S().isEmpty(a.categoryId+"")&&(n.categoryId=!0,o=!0),"redemptionEuro"!==t.props.revenue.category.codeRef&&S().isEmpty(a.dateBegin+"")&&(n.dateBegin=!0,r.dateBegin="Verplicht",o=!0),"redemptionEuro"!==t.props.revenue.category.codeRef&&S().isEmpty(a.dateEnd+"")&&(n.dateEnd=!0,r.dateEnd="Verplicht",o=!0),"revenueKwh"===t.props.revenue.category.codeRef&&S().isEmpty(a.kwhEndCalendarYearHigh+"")&&t.isPeriodExceedingYear(a.dateBegin,a.dateEnd)&&(n.kwhEndCalendarYearHigh=!0,r.kwhEndCalendarYearHigh="Verplicht",o=!0),"revenueKwh"===t.props.revenue.category.codeRef&&S().isEmpty(a.kwhEndHigh+"")&&t.isPeriodExceedingYear(a.dateBegin,a.dateEnd)&&(n.kwhEndHigh=!0,r.kwhEndHigh="Verplicht",o=!0),"revenueKwh"===t.props.revenue.category.codeRef&&!a.payoutKwh&&t.isPeriodExceedingYear(a.dateBegin,a.dateEnd)&&(n.payoutKwh=!0,r.payoutKwh="Verplicht",o=!0),"redemptionEuro"===t.props.revenue.category.codeRef&&!a.dateBegin&&a.dateEnd&&(n.dateBegin=!0,r.dateBegin="Begin periode moet ook ingevuld worden als Eind periode ingevuld is.",o=!0),"redemptionEuro"===t.props.revenue.category.codeRef&&a.dateBegin&&!a.dateEnd&&(n.dateEnd=!0,r.dateEnd="Eind periode moet ook ingevuld worden als Begin periode ingevuld is.",o=!0),!o&&a.dateEnd<a.dateBegin&&(n.dateEnd=!0,r.dateEnd="Eind periode mag niet voor Begin periode liggen.",o=!0),!o&&"redemptionEuro"===t.props.revenue.category.codeRef&&y()(a.dateBegin).format("Y-MM-DD")<y()(a.dateEnd).add(-1,"year").add(1,"day").format("Y-MM-DD")&&(n.dateBegin=!0,r.dateBegin="Aflossingperiode mag maximaal 1 jaar zijn.",n.dateEnd=!0,r.dateEnd="Aflossingperiode mag maximaal 1 jaar zijn.",o=!0),!o&&"revenueEuro"===t.props.revenue.category.codeRef&&y()(a.dateBegin).format("Y-MM-DD")<y()(a.dateEnd).add(-1,"year").add(1,"day").format("Y-MM-DD")&&(n.dateBegin=!0,r.dateBegin="Periode mag maximaal 1 jaar zijn.",n.dateEnd=!0,r.dateEnd="Periode mag maximaal 1 jaar zijn.",o=!0),"inPossessionOf"===a.distributionTypeId&&S().isEmpty(a.dateReference+"")&&(n.dateReference=!0,o=!0),S().isEmpty(a.payAmount+"")||("inPossessionOf"!==a.distributionTypeId&&(n.payAmount=!0,r.payAmount='Bedrag mag alleen bij type opbrengst verdeling "In bezit op" ingevuld zijn.',o=!0),a.payAmount+""<0&&(n.payAmount=!0,r.payAmount="Bedrag mag niet negatief zijn.",o=!0)),S().isEmpty(a.payPercentage+"")||(a.payPercentage+""<0&&(n.payPercentage=!0,r.payPercentage="Percentage mag niet negatief zijn.",o=!0),"redemptionEuro"===t.props.revenue.category.codeRef&&a.payPercentage+"">100&&(n.payPercentage=!0,r.payPercentage="Percentage mag niet meer dan 100% zijn.",o=!0)),"revenueKwh"===t.props.revenue.category.codeRef&&((a.kwhEndHigh?parseFloat(a.kwhEndHigh):0)<(a.kwhStartHigh?parseFloat(a.kwhStartHigh):0)&&(n.kwhEndHigh=!0,r.kwhEndHigh="Eindstand kWh hoog mag niet lager zijn dan Beginstand kWh hoog.",o=!0),(a.kwhEndLow?parseFloat(a.kwhEndLow):0)<(a.kwhStartLow?parseFloat(a.kwhStartLow):0)&&(n.kwhEndLow=!0,r.kwhEndLow="Eindstand kWh laag mag niet lager zijn dan Beginstand kWh laag.",o=!0),y()(a.dateBegin).year()!==y()(a.dateEnd).year()?(a.kwhEndCalendarYearHigh&&a.kwhEndCalendarYearHigh>0||a.kwhEndCalendarYearLow&&a.kwhEndCalendarYearLow>0)&&((a.kwhEndCalendarYearHigh?parseFloat(a.kwhEndCalendarYearHigh):0)<(a.kwhStartHigh?parseFloat(a.kwhStartHigh):0)&&(n.kwhEndCalendarYearHigh=!0,r.kwhEndCalendarYearHigh="Eindstand kWh 31-12 hoog mag niet lager zijn dan Beginstand kWh hoog.",o=!0),(a.kwhEndCalendarYearHigh?parseFloat(a.kwhEndCalendarYearHigh):0)>(a.kwhEndHigh?parseFloat(a.kwhEndHigh):0)&&(n.kwhEndHigh=!0,r.kwhEndHigh="Eindstand kWh 31-12 hoog mag niet hoger zijn dan Beginstand kWh hoog.",o=!0),(a.kwhEndCalendarYearLow?parseFloat(a.kwhEndCalendarYearLow):0)<(a.kwhStartLow?parseFloat(a.kwhStartLow):0)&&(n.kwhEndCalendarYearLow=!0,r.kwhEndCalendarYearLow="Eindstand kWh 31-12 laag mag niet lager zijn dan Beginstand kWh laag.",o=!0),(a.kwhEndCalendarYearLow?parseFloat(a.kwhEndCalendarYearLow):0)>(a.kwhEndLow?parseFloat(a.kwhEndLow):0)&&(n.kwhEndLow=!0,r.kwhEndLow="Eindstand kWh 31-12 laag mag niet hoger zijn dan Eindstand kWh laag.",o=!0)):(a.kwhEndCalendarYearHigh=null,a.kwhEndCalendarYearLow=null)),"revenueEuro"===t.props.revenue.category.codeRef&&("capital"===t.props.revenue.project.projectType.codeRef||"postalcode_link_capital"===t.props.revenue.project.projectType.codeRef)){S().isEmpty(a.payoutTypeId+"")&&(n.payoutTypeId=!0,o=!0);var i=t.props.participantProjectPayoutTypes.find((function(e){return"account"===e.codeRef})).id;a.revenue<0&&a.payoutTypeId==i&&(n.payoutTypeId=!0,r.payoutTypeId="Als je een negatief resultaat wilt verdelen dan kan dat niet uitgekeerd worden op een rekening. Kies voor bijschrijven.",o=!0)}S().isEmpty(a.payPercentage+"")&&0==a.keyAmountFirstPercentage&&S().isEmpty(a.payPercentageValidFromKeyAmount+"")||S().isEmpty(a.payAmount+"")||(n.payAmount=!0,n.payPercentage=!0,n.keyAmountFirstPercentage=!0,n.payPercentageValidFromKeyAmount=!0,r.payAmount="Percentage(s) en Bedrag mogen niet allebei ingevuld zijn.",o=!0),a.payoutKwh=a.payoutKwh?parseFloat(a.payoutKwh).toFixed(5):"",t.setState(ne(ne({},t.state),{},{errors:n,errorMessage:r})),o||(t.setState({isSaving:!0}),E.Z.updateProjectRevenue(a.id,a).then((function(e){t.props.fetchRevenue(a.id),setTimeout((function(){t.props.getDistribution(a.id,0)}),250),t.setState({isSaving:!0}),t.props.switchToView()})))}));var a=e.revenue,r=a.id,o=a.distributionTypeId,i=a.confirmed,s=a.dateBegin,l=a.dateEnd,p=a.dateReference,h=a.dateConfirmed,g=a.payoutTypeId,v=a.kwhStart,f=a.kwhEnd,b=a.kwhStartHigh,w=a.kwhEndCalendarYearHigh,k=a.kwhEndHigh,j=a.kwhStartLow,C=a.kwhEndCalendarYearLow,Z=a.kwhEndLow,R=a.revenue,T=a.datePayed,D=a.payPercentage,N=a.payAmount,P=a.keyAmountFirstPercentage,I=a.payPercentageValidFromKeyAmount,A=a.payoutKwh;return t.state={showModal:!1,revenue:{id:r,distributionTypeId:o,confirmed:!!i,dateBegin:s?y()(s).format("Y-MM-DD"):"",dateEnd:l?y()(l).format("Y-MM-DD"):"",dateReference:p?y()(p).format("Y-MM-DD"):"",dateConfirmed:h?y()(h).format("Y-MM-DD"):"",payoutTypeId:g||"",kwhStart:v||0,kwhEnd:f||0,kwhTotal:(f||0)-(v||0),kwhStartHigh:b||"",kwhEndCalendarYearHigh:w||"",kwhEndHigh:k||"",kwhStartLow:j||"",kwhEndCalendarYearLow:C||"",kwhEndLow:Z||"",revenue:R||"",datePayed:T?y()(T).format("Y-MM-DD"):"",payPercentage:D||"",payAmount:N||"",keyAmountFirstPercentage:P||0,payPercentageValidFromKeyAmount:I||"",payoutKwh:A?parseFloat(A).toFixed(5):""},errors:{categoryId:!1,dateBegin:!1,dateEnd:!1,dateReference:!1,payoutTypeId:!1,kwhEndCalendarYearHigh:!1,kwhEndCalendarYearLow:!1,kwhEndHigh:!1,kwhEndLow:!1,payAmount:!1,payPercentage:!1,keyAmountFirstPercentage:!1,payPercentageValidFromKeyAmount:!1},errorMessage:{payoutTypeId:"",dateBegin:"",dateEnd:"",kwhEndCalendarYearHigh:"",kwhEndCalendarYearLow:"",kwhEndHigh:"",kwhEndLow:"",payAmount:""},isSaving:!1},t}return(0,r.Z)(m,[{key:"render",value:function(){var e=this.state.revenue,t=e.distributionTypeId,a=e.confirmed,n=e.dateBegin,r=e.dateEnd,o=e.dateReference,i=e.dateConfirmed,s=e.kwhStart,c=e.kwhEnd,d=e.kwhTotal,u=e.kwhStartHigh,m=e.kwhEndCalendarYearHigh,p=e.kwhEndHigh,h=e.kwhStartLow,g=e.kwhEndCalendarYearLow,E=e.kwhEndLow,f=e.revenue,b=e.payPercentage,w=e.payAmount,k=e.keyAmountFirstPercentage,j=e.payPercentageValidFromKeyAmount,C=e.payoutKwh,Z=e.payoutTypeId,R=this.props.revenue.project,T=this.props.revenue.category,D="";return R&&R.projectType&&R.projectType.codeRef&&(D=R.projectType.codeRef),l.createElement("form",{className:"form-horizontal col-md-12",onSubmit:this.handleSubmit},l.createElement("div",{className:"row"},l.createElement("div",{className:"panel-heading"},l.createElement("span",{className:"h5 text-bold"},"Algemene informatie"))),l.createElement("div",{className:"row"},l.createElement(B.Z,{label:"Soort",value:T?T.name:"",className:"form-group col-sm-6"}),l.createElement(B.Z,{label:"Definitief",value:a?"Ja":"Nee",className:"form-group col-sm-6"})),"revenueEuro"===T.codeRef?l.createElement("div",{className:"row"},"loan"!==D?l.createElement(L.Z,{label:"Type opbrengst verdeling",name:"distributionTypeId",options:this.props.projectRevenueDistributionTypes,value:t,onChangeAction:this.handleInputChange}):null,"inPossessionOf"===t?l.createElement(K.Z,{label:"Peildatum",name:"dateReference",value:o,onChangeAction:this.handleInputChangeDate,required:"required",error:this.state.errors.dateReference}):null):null,"redemptionEuro"===T.codeRef?l.createElement("div",{className:"row"},"inPossessionOf"===t?l.createElement(K.Z,{label:"Peildatum",name:"dateReference",value:o,onChangeAction:this.handleInputChangeDate,required:"required",error:this.state.errors.dateReference}):null):null,l.createElement("div",{className:"row"},l.createElement(K.Z,{label:l.createElement("span",null,"Begin periode",R&&!a&&R.dateInterestBearingRedemption&&"redemptionEuro"===T.codeRef&&y()(n).format("Y-MM-DD")<y()(R.dateInterestBearingRedemption).format("Y-MM-DD")?l.createElement(l.Fragment,null,l.createElement("br",null),l.createElement("small",{style:{color:"red",fontWeight:"normal"}},"Let op de begin periode ligt voor de eind periode van de vorige aflossing.")):""),name:"dateBegin",value:n,onChangeAction:this.handleInputChangeDate,required:"redemptionEuro"!==T.codeRef?"required":"",error:this.state.errors.dateBegin,errorMessage:this.state.errorMessage.dateBegin,disabledBefore:"revenueEuro"!==T.codeRef||"loan"!==D&&"obligation"!==D?"redemptionEuro"===T.codeRef?y()(R.dateInterestBearingRedemption).add(-1,"year").format("Y-MM-DD"):"revenueKwh"===T.codeRef?R.dateInterestBearingKwh:"":R.dateInterestBearing}),l.createElement(K.Z,{label:"Eind periode",name:"dateEnd",value:r,onChangeAction:this.handleInputChangeDate,required:"redemptionEuro"!==T.codeRef?"required":"",error:this.state.errors.dateEnd,errorMessage:this.state.errorMessage.dateEnd,disabledBefore:n,disabledAfter:"revenueKwh"===T.codeRef?y()(n).add(1,"year").add(6,"month").add(-1,"day").format("Y-MM-DD"):y()(n).add(1,"year").add(-1,"day").format("Y-MM-DD")})),l.createElement("div",{className:"row"},l.createElement(K.Z,{label:"Datum definitief",name:"dateConfirmed",value:i,onChangeAction:this.handleInputChangeDateConfirmed}),"revenueEuro"!==T.codeRef||"capital"!==D&&"postalcode_link_capital"!==D?null:l.createElement(L.Z,{label:"Uitkeren op",name:"payoutTypeId",id:"payoutTypeId",options:this.props.participantProjectPayoutTypes,value:Z,onChangeAction:this.handleInputChange,required:"required",error:this.state.errors.payoutTypeId,errorMessage:this.state.errorMessage.payoutTypeId})),"revenueKwh"===T.codeRef?l.createElement(l.Fragment,null,l.createElement("div",{className:"row"},l.createElement("div",{className:"panel-part panel-heading"},l.createElement("span",{className:"h5 text-bold"},"Opbrengst kWh"))),this.isPeriodExceedingYear(n,r)?l.createElement(l.Fragment,null,l.createElement("div",{className:"row"},this.props.revenue.project.kwhStartHighNextRevenue>0?l.createElement(H.Z,{type:"number",label:"Beginstand kWh hoog",name:"kwhStartHigh",value:u,readOnly:!0}):l.createElement(H.Z,{type:"number",label:"Beginstand kWh hoog",name:"kwhStartHigh",value:u,onChangeAction:this.handleInputChange})),l.createElement("div",{className:"row"},this.props.revenue.project.kwhStartLowNextRevenue>0?l.createElement(H.Z,{type:"number",label:"Beginstand kWh laag",name:"kwhStartLow",value:h,readOnly:!0}):l.createElement(H.Z,{type:"number",label:"Beginstand kWh laag",name:"kwhStartLow",value:h,onChangeAction:this.handleInputChange})),l.createElement("div",{className:"row"},l.createElement(H.Z,{type:"number",label:"Eindstand kWh op 31-12 hoog",name:"kwhEndCalendarYearHigh",value:m,onChangeAction:this.handleInputChange,error:this.state.errors.kwhEndCalendarYearHigh,errorMessage:this.state.errorMessage.kwhEndCalendarYearHigh,required:"required"}),l.createElement(H.Z,{type:"number",label:"Eindstand kWh hoog",name:"kwhEndHigh",value:p,onChangeAction:this.handleInputChange,error:this.state.errors.kwhEndHigh,errorMessage:this.state.errorMessage.kwhEndHigh,required:"required"})),l.createElement("div",{className:"row"},l.createElement(H.Z,{type:"number",label:"Eindstand kWh op 31-12 laag",name:"kwhEndCalendarYearLow",value:g,onChangeAction:this.handleInputChange,error:this.state.errors.kwhEndCalendarYearLow,errorMessage:this.state.errorMessage.kwhEndCalendarYearLow}),l.createElement(H.Z,{type:"number",label:"Eindstand kWh laag",name:"kwhEndLow",value:E,onChangeAction:this.handleInputChange,error:this.state.errors.kwhEndLow,errorMessage:this.state.errorMessage.kwhEndLow}))):l.createElement(l.Fragment,null,l.createElement("div",{className:"row"},this.props.revenue.project.kwhStartHighNextRevenue>0?l.createElement(H.Z,{type:"number",label:"Beginstand kWh hoog",name:"kwhStartHigh",value:u,readOnly:!0}):l.createElement(H.Z,{type:"number",label:"Beginstand kWh hoog",name:"kwhStartHigh",value:u,onChangeAction:this.handleInputChange}),l.createElement(H.Z,{type:"number",label:"Eindstand kWh hoog",name:"kwhEndHigh",value:p,onChangeAction:this.handleInputChange,error:this.state.errors.kwhEndHigh,errorMessage:this.state.errorMessage.kwhEndHigh})),l.createElement("div",{className:"row"},this.props.revenue.project.kwhStartLowNextRevenue>0?l.createElement(H.Z,{type:"number",label:"Beginstand kWh laag",name:"kwhStartLow",value:h,readOnly:!0}):l.createElement(H.Z,{type:"number",label:"Beginstand kWh laag",name:"kwhStartLow",value:h,onChangeAction:this.handleInputChange}),l.createElement(H.Z,{type:"number",label:"Eindstand kWh laag",name:"kwhEndLow",value:E,onChangeAction:this.handleInputChange,error:this.state.errors.kwhEndLow,errorMessage:this.state.errorMessage.kwhEndLow}))),l.createElement("div",{className:"row"},l.createElement(H.Z,{type:"number",label:"Beginstand kWh",name:"kwhStart",value:s,readOnly:!0}),l.createElement(H.Z,{type:"number",label:"Eindstand kWh",name:"kwhEnd",value:c,readOnly:!0})),l.createElement("div",{className:"row"},l.createElement(H.Z,{type:"number",label:"Teruggave EB per kWh â‚¬",name:"payoutKwh",value:C&&C.toLocaleString("nl",{minimumFractionDigits:3,maximumFractionDigits:5}),onChangeAction:this.handleInputChange,error:this.state.errors.payoutKwh,errorMessage:this.state.errorMessage.payoutKwh,required:"required"}),l.createElement(H.Z,{type:"number",label:"Totaal productie kWh",name:"kwhTotal",value:d,readOnly:!0}))):null,"revenueEuro"===T.codeRef?l.createElement(l.Fragment,null,l.createElement("div",{className:"row"},l.createElement("div",{className:"panel-part panel-heading"},l.createElement("span",{className:"h5 text-bold"},"Opbrengst euro"))),"loan"===D||"obligation"===D?l.createElement(l.Fragment,null,l.createElement("div",{className:"row"},l.createElement(H.Z,{type:"number",label:"Uitkering (rente) %",name:"payPercentage",value:b,onChangeAction:this.handleInputChange,error:this.state.errors.payPercentage,errorMessage:this.state.errorMessage.payPercentage}),l.createElement(H.Z,{type:"number",label:"of uitkeringsbedrag per deelname",name:"payAmount",value:w,onChangeAction:this.handleInputChange,error:this.state.errors.payAmount,errorMessage:this.state.errorMessage.payAmount})),l.createElement("div",{className:"row"},l.createElement(H.Z,{label:l.createElement(l.Fragment,null,"Bedrag ",l.createElement(re,null,"(uitkering % geldig tot en met)")),name:"keyAmountFirstPercentage",value:k,onChangeAction:this.handleInputChange,error:this.state.errors.keyAmountFirstPercentage})),this.state.revenue.keyAmountFirstPercentage?l.createElement("div",{className:"row"},l.createElement(H.Z,{type:"number",label:l.createElement(l.Fragment,null,"Uitkering (rente) % vanaf bedrag"),name:"payPercentageValidFromKeyAmount",value:j,onChangeAction:this.handleInputChange,error:this.state.errors.payPercentageValidFromKeyAmount})):null):null,"capital"===D||"postalcode_link_capital"===D?l.createElement(l.Fragment,null,l.createElement("div",{className:"row"},l.createElement(H.Z,{type:"number",label:"Resultaat",name:"revenue",value:f,onChangeAction:this.handleInputChange,size:"col-sm-5",textToolTip:"Vul hier hier het totaal resultaat in dat je wilt verdelen over alle deelnemers. Econobis maakt vanuit dit totaal de verdeling per deelnemer"}))):null):null,"redemptionEuro"===T.codeRef?l.createElement(l.Fragment,null,l.createElement("div",{className:"row"},l.createElement("div",{className:"panel-part panel-heading"},l.createElement("span",{className:"h5 text-bold"},"Aflossing euro"))),"loan"===D||"obligation"===D?l.createElement(l.Fragment,null,l.createElement("div",{className:"row"},l.createElement(H.Z,{type:"number",label:"Aflossing %",name:"payPercentage",value:b,onChangeAction:this.handleInputChange,error:this.state.errors.payPercentage,errorMessage:this.state.errorMessage.payPercentage}),l.createElement(H.Z,{type:"number",label:"of aflossingsbedrag per deelname",name:"payAmount",value:w,onChangeAction:this.handleInputChange,error:this.state.errors.payAmount,errorMessage:this.state.errorMessage.payAmount}))):null):null,l.createElement(ee.Z,null,l.createElement("div",{className:"pull-right btn-group",role:"group"},l.createElement(F.Z,{buttonClassName:"btn-default",buttonText:"Annuleren",onClickAction:this.props.switchToView}),l.createElement(F.Z,{buttonText:"Opslaan",onClickAction:this.handleSubmit,type:"submit",value:"Submit",loading:this.state.isSaving}))),this.state.showModal&&l.createElement(v.Z,{buttonConfirmText:"Bevestigen",closeModal:this.cancelSetDate,confirmAction:this.toggleShowModal,title:"Bevestigen"},l.createElement("p",null,"redemptionEuro"===this.props.revenue.category.codeRef?"Als je deze datum invult, zal de aflossing definitief worden gemaakt. Je kunt deze hierna niet meer aanpassen.":"Als je deze datum invult, zal de opbrengst definitief worden gemaakt. Je kunt deze hierna niet meer aanpassen.")))}}]),m}(l.Component);const ie=(0,c.$j)((function(e){return{revenue:e.projectRevenue,projectRevenueDistributionTypes:e.systemData.projectRevenueDistributionTypes,participantProjectPayoutTypes:e.systemData.participantProjectPayoutTypes}}),(function(e){return{fetchRevenue:function(t){e((0,T.t2)(t))},getDistribution:function(t,a){e((0,T.VY)({id:t,page:a}))}}}))(oe);var se;y().locale("nl");var le=te.Z.em(se||(se=(0,X.Z)(["\n    font-weight: normal;\n"])));const ce=(0,c.$j)((function(e){return{revenue:e.projectRevenue}}))((function(e){var t=e.revenue,a=t.confirmed,n=t.dateBegin,r=t.dateEnd,o=t.dateReference,i=t.dateConfirmed,s=t.participantProjectPayoutType,c=t.kwhStart,d=t.kwhEnd,u=t.kwhStartHigh,m=t.kwhEndCalendarYearHigh,p=t.kwhEndHigh,h=t.kwhStartLow,g=t.kwhEndCalendarYearLow,v=t.kwhEndLow,E=t.revenue,f=t.payPercentage,b=t.payAmount,w=t.keyAmountFirstPercentage,k=t.payPercentageValidFromKeyAmount,j=t.category,C=t.project,Z=t.payoutKwh,R=t.distributionType,T=d-c;return l.createElement("div",null,l.createElement("div",{className:"panel-heading",onClick:e.switchToEdit},l.createElement("span",{className:"h5 text-bold"},"Algemeen")),l.createElement("div",{className:"row",onClick:e.switchToEdit},l.createElement(B.Z,{label:"Soort",value:j?j.name:""}),l.createElement(B.Z,{label:"Definitief",value:a?"Ja":"Nee"})),"revenueEuro"===j.codeRef||"redemptionEuro"===j.codeRef?l.createElement("div",{className:"row",onClick:e.switchToEdit},"loan"!==C.projectType.codeRef?l.createElement(B.Z,{label:"Type opbrengst verdeling",value:R?R.name:""}):null,R&&"inPossessionOf"===R.id?l.createElement(B.Z,{label:"Peildatum",value:o?y()(o).format("L"):""}):null):null,l.createElement("div",{className:"row",onClick:e.switchToEdit},l.createElement(B.Z,{label:l.createElement("span",null,"Begin periode",C&&!a&&C.dateInterestBearingRedemption&&"redemptionEuro"===j.codeRef&&y()(n).format("Y-MM-DD")<y()(C.dateInterestBearingRedemption).format("Y-MM-DD")?l.createElement(l.Fragment,null,l.createElement("br",null),l.createElement("small",{style:{color:"red",fontWeight:"normal"}},"Let op de begin periode ligt voor de eind periode van de vorige aflossing.")):""),value:n?y()(n).format("L"):""}),l.createElement(B.Z,{label:"Eind periode",value:r?y()(r).format("L"):""})),l.createElement("div",{className:"row",onClick:e.switchToEdit},l.createElement(B.Z,{label:"Datum definitief",value:i?y()(i).format("L"):""}),"revenueEuro"!==j.codeRef||"capital"!==C.projectType.codeRef&&"postalcode_link_capital"!==C.projectType.codeRef?null:l.createElement(B.Z,{label:"Uitkeren op",value:s?s.name:""})),l.createElement("div",{className:"row",onClick:e.switchToEdit}),"revenueKwh"===j.codeRef?l.createElement(l.Fragment,null,l.createElement("div",{className:"panel-part panel-heading",onClick:e.switchToEdit},l.createElement("span",{className:"h5 text-bold"},"Opbrengst kWh")),y()(n).year()!==y()(r).year()?l.createElement(l.Fragment,null,l.createElement("div",{className:"row",onClick:e.switchToEdit},l.createElement(B.Z,{label:"Beginstand kWh hoog",value:u&&u})),l.createElement("div",{className:"row",onClick:e.switchToEdit},l.createElement(B.Z,{label:"Beginstand kWh laag",value:h&&h})),l.createElement("div",{className:"row",onClick:e.switchToEdit},l.createElement(B.Z,{label:"Eindstand kWh op 31-12 hoog",value:m&&m}),l.createElement(B.Z,{label:"Eindstand kWh hoog",value:p&&p})),l.createElement("div",{className:"row",onClick:e.switchToEdit},l.createElement(B.Z,{label:"Eindstand kWh op 31-12 laag",value:g&&g}),l.createElement(B.Z,{label:"Eindstand kWh laag",value:v&&v}))):l.createElement(l.Fragment,null,l.createElement("div",{className:"row",onClick:e.switchToEdit},l.createElement(B.Z,{label:"Beginstand kWh hoog",value:u&&u}),l.createElement(B.Z,{label:"Eindstand kWh hoog",value:p&&p})),l.createElement("div",{className:"row",onClick:e.switchToEdit},l.createElement(B.Z,{label:"Beginstand kWh laag",value:h&&h}),l.createElement(B.Z,{label:"Eindstand kWh laag",value:v&&v}))),l.createElement("div",{className:"row",onClick:e.switchToEdit},l.createElement(B.Z,{label:"Beginstand kWh",value:c&&c}),l.createElement(B.Z,{label:"Eindstand kWh",value:d&&d})),l.createElement("div",{className:"row",onClick:e.switchToEdit},l.createElement(B.Z,{label:"Teruggave EB per kWh â‚¬",value:Z&&Z.toLocaleString("nl",{minimumFractionDigits:3,maximumFractionDigits:5})}),l.createElement(B.Z,{label:"Totaal productie kWh",value:T&&T}))):null,"revenueEuro"===j.codeRef?l.createElement(l.Fragment,null,l.createElement("div",{className:"panel-part panel-heading",onClick:e.switchToEdit},l.createElement("span",{className:"h5 text-bold"},"Opbrengst euro")),l.createElement("div",{className:"row",onClick:e.switchToEdit},"loan"===C.projectType.codeRef||"obligation"===C.projectType.codeRef?l.createElement(l.Fragment,null,l.createElement("div",null,l.createElement(B.Z,{label:"Uitkering (rente) %",value:f&&f+"%"}),l.createElement(B.Z,{label:"of uitkeringsbedrag per deelname",value:(0,N.Z)(b)})),l.createElement("div",null,l.createElement(B.Z,{label:l.createElement(l.Fragment,null,"Bedrag ",l.createElement(le,null,"(uitkering % geldig tot en met)")),value:w&&"â‚¬ "+w}))):null,"capital"===C.projectType.codeRef||"postalcode_link_capital"===C.projectType.codeRef?l.createElement(l.Fragment,null,l.createElement(B.Z,{label:"Resultaat",value:E})):null),w?l.createElement("div",{className:"row"},l.createElement(B.Z,{type:"number",label:l.createElement(l.Fragment,null,"Uitkering (rente) % vanaf bedrag"),value:k&&k+"%"})):null):null,"redemptionEuro"===j.codeRef?l.createElement(l.Fragment,null,l.createElement("div",{className:"panel-part panel-heading",onClick:e.switchToEdit},l.createElement("span",{className:"h5 text-bold"},"Aflossing euro")),b?l.createElement(l.Fragment,null,l.createElement("div",{className:"row",onClick:e.switchToEdit},"loan"===C.projectType.codeRef||"obligation"===C.projectType.codeRef?l.createElement(B.Z,{label:"Aflossing bedrag per deelname",value:(0,N.Z)(b)}):null)):l.createElement(l.Fragment,null,l.createElement("div",{className:"row",onClick:e.switchToEdit},"loan"===C.projectType.codeRef||"obligation"===C.projectType.codeRef?l.createElement(B.Z,{label:"Aflossing %",value:f&&f+"%"}):null))):null)}));var de=function(e){(0,o.Z)(m,e);var t,a,c=(t=m,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,s.Z)(t);if(a){var r=(0,s.Z)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return(0,i.Z)(this,e)});function m(e){var t;return(0,n.Z)(this,m),t=c.call(this,e),(0,u.Z)((0,d.Z)(t),"switchToEdit",(function(){t.setState({showEdit:!0})})),(0,u.Z)((0,d.Z)(t),"switchToView",(function(){t.setState({showEdit:!1,activeDiv:""})})),t.state={showEdit:!1,activeDiv:""},t}return(0,r.Z)(m,[{key:"onDivEnter",value:function(){this.setState({activeDiv:"panel-grey"})}},{key:"onDivLeave",value:function(){this.state.showEdit||this.setState({activeDiv:""})}},{key:"render",value:function(){var e=this;return l.createElement(p.Z,{className:this.state.activeDiv,onMouseEnter:function(){return e.onDivEnter()},onMouseLeave:function(){return e.onDivLeave()}},l.createElement(h.Z,null,this.state.showEdit&&!this.props.revenue.confirmed&&this.props.permissions.manageFinancial?l.createElement(ie,{switchToView:this.switchToView}):l.createElement(ce,{switchToEdit:this.switchToEdit})))}}]),m}(l.Component);const ue=(0,c.$j)((function(e){return{permissions:e.meDetails.permissions,revenue:e.projectRevenue}}))(de);var me=function(e){(0,o.Z)(d,e);var t,a,c=(t=d,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,s.Z)(t);if(a){var r=(0,s.Z)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return(0,i.Z)(this,e)});function d(e){return(0,n.Z)(this,d),c.call(this,e)}return(0,r.Z)(d,[{key:"componentDidMount",value:function(){this.props.fetchRevenue(this.props.params.id)}},{key:"componentWillUnmount",value:function(){this.props.clearRevenue()}},{key:"render",value:function(){return l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-9"},l.createElement("div",{className:"col-md-12"},l.createElement(R,null)),this.props.projectRevenue.id?l.createElement("div",{className:"col-md-12"},1==this.props.projectRevenue.confirmed&&l.createElement(p.Z,null,l.createElement(x.Z,null,l.createElement("span",{className:"h5",style:{color:"#e64a4a"}},"Deze opbrengst is definitief. Hierdoor kan deze niet meer gewijzigd worden en staat de opbrengstverdeling vast."))),l.createElement(ue,null),l.createElement(G,null),l.createElement(J,null)):l.createElement("div",null,"Geen gegevens gevonden.")))}}]),d}(l.Component);const pe=(0,c.$j)((function(e){return{projectRevenue:e.projectRevenue}}),(function(e){return{fetchRevenue:function(t){e((0,T.t2)(t))},clearRevenue:function(){e((0,T.$P)())}}}))(me)},88211:(e,t,a)=>{a.d(t,{Z:()=>n});const n=function(e){return e||(e=0),e=parseFloat(e),isNaN(e)?"Ongeldig bedrag":"â‚¬ ".concat(e.toLocaleString("nl",{minimumFractionDigits:2,maximumFractionDigits:2}))}}}]);