(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{1094:function(e,t,n){"use strict";var a=n(2),r="".concat(URL_API,"/api/contact");t.a={fetchContactAvailabilitiesByWeek:function(e,t){return a.a.get("".concat(r,"/").concat(e,"/availability/by-week"),{params:{startOfWeek:t}}).then((function(e){return e.data}))},updateContactAvailabilities:function(e,t){return a.a.post("".concat(r,"/").concat(e,"/availability"),t)},copyAvailabilities:function(e,t){return a.a.post("".concat(r,"/").concat(e,"/availability/copy-weeks"),t)},fetchDistrictAvailabilitiesByWeek:function(e){var t=e.districtId,n=e.startOfWeek;return a.a.get("".concat(URL_API,"/api/district/").concat(t,"/availability/by-week"),{params:{startOfWeek:n}}).then((function(e){return e.data}))}}},1238:function(e,t,n){var a=n(1536);"string"==typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(228)(a,r);a.locals&&(e.exports=a.locals)},1536:function(e,t,n){(e.exports=n(227)(!1)).push([e.i,".table-drag-select {\r\n    /* Stretch horizontally to fill parent */\r\n    width: 100%;\r\n    /* Keep columns same width */\r\n    table-layout: fixed;\r\n    /* Disable text selection */\r\n    user-select: none;\r\n    /* Center in parent */\r\n    margin-left: auto;\r\n    margin-right: auto;\r\n    /* Remove space between border */\r\n    border-collapse: collapse;\r\n}\r\n\r\n/* Table cells */\r\n.table-drag-select td {\r\n    text-align: center;\r\n    /* Cut off long strings of text with ... */\r\n    text-overflow: ellipsis;\r\n    overflow: hidden;\r\n    /* Make transparent gaps between cells. Better than relying on margin\r\n     * because clicking an element's margin doesn't trigger events */\r\n    border: 0.2rem solid transparent;\r\n    background-clip: padding-box;\r\n    /* Make cells reasonable size */\r\n    /*line-height: 3rem;*/\r\n    /* Shows more text when text too big to fit into cell */\r\n    padding-left: 0rem;\r\n    padding-right: 0rem;\r\n}\r\n\r\n/* Cells that can be interacted with */\r\n.table-drag-select td.cell-enabled {\r\n    background-color: #EEE;\r\n    /* Make the cursor a + symbol */\r\n    cursor: cell;\r\n}\r\n\r\n/* Cells that cannot be interacted with */\r\n.table-drag-select td.cell-disabled {\r\n    /* Put yer css here */\r\n}\r\n\r\n/* Cells that have been selected */\r\n.table-drag-select td.cell-selected {\r\n    background-color: #85a41a;\r\n}\r\n\r\n/* Cells that are in the process of being selected */\r\n.table-drag-select td.cell-being-selected {\r\n    /* This is the blue color you see when you select text with the cursor */\r\n    background-color: #3F83D5;\r\n}",""])},1622:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return ee}));var a=n(546),r=n.n(a),o=n(0),l=n.n(o),c=n(27),i=n(30),u=n(50),s=n(4),d=(n(1238),n(54)),m=n(549),f=n.n(m),p=n(13),h=n.n(p),v=n(143),b=n.n(v),g=n(14),w=n.n(g),E=n(9),y=n.n(E),k=n(15),M=n.n(k),C=n(16),S=n.n(C),A=n(12),x=n.n(A),N=n(5),T=n.n(N),O=n(3),W=n.n(O),R=["className","disabled","beingSelected","selected","onTouchStart","onTouchMove"];function B(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){c=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(c)throw o}}}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=x()(e);if(t){var r=x()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return S()(this,n)}}var D=function(e){M()(n,e);var t=j(n);function n(){var e;w()(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r)),T()(y()(e),"state",{selectionStarted:!1,startRow:null,startColumn:null,endRow:null,endColumn:null,addMode:null}),T()(y()(e),"componentDidMount",(function(){window.addEventListener("mouseup",e.handleTouchEndWindow),window.addEventListener("touchend",e.handleTouchEndWindow)})),T()(y()(e),"componentWillUnmount",(function(){window.removeEventListener("mouseup",e.handleTouchEndWindow),window.removeEventListener("touchend",e.handleTouchEndWindow)})),T()(y()(e),"render",(function(){return l.a.createElement("tbody",null,e.renderRows())})),T()(y()(e),"renderRows",(function(){return l.a.Children.map(e.props.children,(function(t,n){return l.a.createElement("tr",b()({key:n},t.props),l.a.Children.map(t.props.children,(function(t,a){return l.a.createElement(P,b()({key:a,onTouchStart:e.handleTouchStartCell,onTouchMove:e.handleTouchMoveCell,selected:e.props.value[n][a],beingSelected:e.isCellBeingSelected(n,a)},t.props),t.props.children)})))}))})),T()(y()(e),"handleTouchStartCell",(function(t){var n=0===t.button,a="mousedown"!==t.type;if(!e.state.selectionStarted&&(n||a)){t.preventDefault();var r=Y(t),o=r.row,l=r.column;e.props.onSelectionStart({row:o,column:l}),e.setState({selectionStarted:!0,startRow:o,startColumn:l,endRow:o,endColumn:l,addMode:!e.props.value[o][l]})}})),T()(y()(e),"handleTouchMoveCell",(function(t){if(e.state.selectionStarted){t.preventDefault();var n=Y(t),a=n.row,r=n.column,o=e.state,l=o.startRow,c=o.startColumn,i=o.endRow,u=o.endColumn;if(i!==a||u!==r){var s=null===l&&null===i?0:Math.abs(a-l)+1,d=null===c&&null===u?0:Math.abs(r-c)+1;s<=e.props.maxRows&&e.setState({endRow:a}),d<=e.props.maxColumns&&e.setState({endColumn:r})}}})),T()(y()(e),"handleTouchEndWindow",(function(t){var n=0===t.button,a="mousedown"!==t.type;if(e.state.selectionStarted&&(n||a)){for(var r=h()(e.props.value),o=Math.min(e.state.startRow,e.state.endRow),l=Math.max(e.state.startRow,e.state.endRow),c=o;c<=l;c++)for(var i=Math.min(e.state.startColumn,e.state.endColumn),u=Math.max(e.state.startColumn,e.state.endColumn),s=i;s<=u;s++)r[c][s]=e.state.addMode;e.setState({selectionStarted:!1}),e.props.onChange(r)}})),T()(y()(e),"isCellBeingSelected",(function(t,n){var a=Math.min(e.state.startRow,e.state.endRow),r=Math.max(e.state.startRow,e.state.endRow),o=Math.min(e.state.startColumn,e.state.endColumn),l=Math.max(e.state.startColumn,e.state.endColumn);return e.state.selectionStarted&&t>=a&&t<=r&&n>=o&&n<=l})),e}return n}(l.a.Component);T()(D,"propTypes",{value:function(e){var t=new Error("Invalid prop `value` supplied to `TableDragSelect`. Validation failed.");if(!Array.isArray(e.value))return t;if(0!==e.value.length){var n,a=e.value[0].length,r=B(e.value);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(!Array.isArray(o)||o.length!==a)return t;var l,c=B(o);try{for(c.s();!(l=c.n()).done;){if("boolean"!=typeof l.value)return t}}catch(e){c.e(e)}finally{c.f()}}}catch(e){r.e(e)}finally{r.f()}}},maxRows:W.a.number,maxColumns:W.a.number,onSelectionStart:W.a.func,onInput:W.a.func,onChange:W.a.func,children:function(e){if(!D.propTypes.value(e)){var t=new Error("Invalid prop `children` supplied to `TableDragSelect`. Validation failed."),n=l.a.Children.toArray(e.children),a=e.value.length,r=0===e.value.length?0:e.value[0].length;if(n.length!==a)return t;var o,c=B(n);try{for(c.s();!(o=c.n()).done;){var i=o.value,u=l.a.Children.toArray(i.props.children);if("tr"!==i.type||u.length!==r)return t;var s,d=B(u);try{for(d.s();!(s=d.n()).done;){if("td"!==s.value.type)return t}}catch(e){d.e(e)}finally{d.f()}}}catch(e){c.e(e)}finally{c.f()}}}}),T()(D,"defaultProps",{value:[],maxRows:1/0,maxColumns:1/0,onSelectionStart:function(){},onInput:function(){},onChange:function(){}});var P=function(e){M()(n,e);var t=j(n);function n(){var e;w()(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r)),T()(y()(e),"shouldComponentUpdate",(function(t){return e.props.beingSelected!==t.beingSelected||e.props.selected!==t.selected})),T()(y()(e),"componentDidMount",(function(){e.td.addEventListener("touchstart",e.handleTouchStart,{passive:!1}),e.td.addEventListener("touchmove",e.handleTouchMove,{passive:!1})})),T()(y()(e),"componentWillUnmount",(function(){e.td.removeEventListener("touchstart",e.handleTouchStart),e.td.removeEventListener("touchmove",e.handleTouchMove)})),T()(y()(e),"render",(function(){var t=e.props,n=t.className,a=void 0===n?"":n,r=t.disabled,o=t.beingSelected,c=t.selected,i=(t.onTouchStart,t.onTouchMove,f()(t,R));return r?a+=" cell-disabled":(a+=" cell-enabled",c&&(a+=" cell-selected"),o&&(a+=" cell-being-selected")),l.a.createElement("td",b()({ref:function(t){return e.td=t},className:a,onMouseDown:e.handleTouchStart,onMouseMove:e.handleTouchMove},i),e.props.children||l.a.createElement("span",null," "))})),T()(y()(e),"handleTouchStart",(function(t){e.props.disabled||e.props.onTouchStart(t)})),T()(y()(e),"handleTouchMove",(function(t){e.props.disabled||e.props.onTouchMove(t)})),e}return n}(l.a.Component),Y=function(e){var t;if(e.touches){var n=e.touches[0];t=document.elementFromPoint(n.clientX,n.clientY)}else for(t=e.target;"TD"!==t.tagName;)t=t.parentNode;return{row:t.parentNode.rowIndex-1,column:t.cellIndex}},L=n(7),z=n.n(L),V=n(1094),U=n(35),F=n(123);function q(e){var t=e.weekOptions,n=e.copyFromWeek,a=e.contactId,c=Object(o.useState)(!1),i=r()(c,2),s=i[0],d=i[1],m=Object(o.useState)(""),f=r()(m,2),p=f[0],h=f[1],v=Object(o.useState)(1),b=r()(v,2),g=b[0],w=b[1];Object(o.useEffect)((function(){var e=t.findIndex((function(e){return e.value===n})),a=t[e+1];h(a?a.value:n)}),[s]);return s?l.a.createElement("div",{style:{textAlign:"left"}},l.a.createElement(U.a,{buttonConfirmText:"Kopiëren",closeModal:function(){return d(!1)},confirmAction:function(){V.a.copyAvailabilities(a,{copyFromWeek:n,copyToWeek:p,numberOfWeeks:g}).then((function(){d(!1)})).catch((function(){alert("Er is iets misgegaan met opslaan, probeer het opnieuw.")}))},title:"Beschikbaarheid kopiëren"},l.a.createElement("div",null,l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-12"},l.a.createElement("h4",null,"Beschikbaarheid van ",l.a.createElement("strong",null,t.find((function(e){return e.value===n})).text)," kopiëren."),l.a.createElement("p",null,"De beschikbaarheid van de huidige week in het overzicht wordt gekopieerd naar de gekozen week en de x aantal daaropvolgende weken."))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"row"},l.a.createElement(F.a,{label:"Naar week",size:"col-sm-12",name:"copyToWeek",options:t,value:p,onChangeAction:function(e){return h(e.target.value)},optionName:"text",optionValue:"value",emptyOption:!1}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"row"},l.a.createElement(F.a,{label:"Aantal weken",size:"col-sm-12",name:"numberOfWeeks",options:function(){for(var e=t.findIndex((function(e){return e.value===p})),n=t.length-e,a=[],r=1;r<=n;r++)a.push({value:r,text:r});return a}(),value:g,onChangeAction:function(e){return w(e.target.value)},optionName:"text",optionValue:"value",emptyOption:!1})))))):l.a.createElement(u.a,{iconName:"glyphicon-duplicate",buttonClassName:"btn-default btn-sm",onClickAction:function(){return d(!0)}})}function J(e){var t=e.contactId,n=Object(o.useState)([]),a=r()(n,2),s=a[0],m=a[1],f=Object(o.useState)([]),p=r()(f,2),h=p[0],v=p[1],b=Object(o.useState)(""),g=r()(b,2),w=g[0],E=g[1],y=Object(o.useState)([]),k=r()(y,2),M=k[0],C=k[1];Object(o.useEffect)((function(){E(z()().startOf("isoWeek").format("YYYY-MM-DD")),A()}),[]),Object(o.useEffect)((function(){w&&(V.a.fetchContactAvailabilitiesByWeek(t,w).then((function(e){C(e)})),x())}),[w]);var S,A=function(){for(var e=[],t=360;t<1320;t+=30)e.push(t);v(e)},x=function(){for(var e=[],t=z()(w),n=t.clone().endOf("isoWeek");t<=n;)e.push(t.clone()),t.add(1,"d");m(e)},N=function(e,t){return M.some((function(n){return z()(n.from)<=z()(e).add(t,"minutes")&&z()(n.to)>=z()(e).add(t+30,"minutes")}))},T=function(e){var t=Math.floor(e/60),n=e%60;return(t=t<10?"0"+t:t)+":"+(n=n<10?"0"+n:n)},O=function(){for(var e=z()().startOf("isoWeek"),t=[],n=0;n<78;n++)t.push({value:e.format("YYYY-MM-DD"),text:"Week "+e.format("W")+" ("+e.format("DD-MM-YY")+")"}),e.add(1,"w");return t},W=function(){var e=O().findIndex((function(e){return e.value===w}));if(e>0)return O()[e-1].value},R=function(){var e=O().findIndex((function(e){return e.value===w}));if(e<O().length-1)return O()[e+1].value};return l.a.createElement(c.a,null,l.a.createElement(d.a,null,l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-4"},l.a.createElement(u.a,{disabled:!W(),iconName:"glyphicon-arrow-left",buttonClassName:"btn-default btn-sm",onClickAction:function(){return E(W())}})),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("select",{className:"form-control input-sm",value:w,onChange:function(e){return E(e.target.value)}},O().map((function(e){return l.a.createElement("option",{key:e.value,value:e.value},e.text)})))),l.a.createElement("div",{className:"col-sm-4",style:{textAlign:"right"}},l.a.createElement(q,{weekOptions:O(),copyFromWeek:w,contactId:t})," ",l.a.createElement(u.a,{disabled:!R(),iconName:"glyphicon-arrow-right",buttonClassName:"btn-default btn-sm",onClickAction:function(){return E(R())}})))),l.a.createElement(i.a,null,l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-12"},l.a.createElement("table",{className:"table-drag-select"},l.a.createElement("thead",null,l.a.createElement("tr",null,s.map((function(e,t){return l.a.createElement("th",{key:t,style:{textAlign:"center"}},e.format("dd DD-MM-YY"))})))),l.a.createElement(D,{value:(S=[],h.map((function(e){var t=[];s.map((function(n){t.push(N(n,e))})),S.push(t)})),S),onChange:function(e){return function(e){for(var n=[],a=0;a<s.length;a++)for(var r=!1,o=0;o<h.length;o++)e[o][a]?!1===r&&(r=o):!1!==r&&(n.push({day:a,from:T(h[r]),to:T(h[o-1]+30)}),r=!1),o===h.length-1&&r&&n.push({day:a,from:T(h[r]),to:T(h[o]+30)});V.a.updateContactAvailabilities(t,{startOfWeek:w,availabilities:n}).catch((function(){alert("Er is iets misgegaan met opslaan, probeer het opnieuw.")}))}(e)}},h.map((function(e,t){return l.a.createElement("tr",{key:t},s.map((function(t,n){return l.a.createElement("td",{key:n},T(e))})))}))))))))}var K=n(302),Z=n(36),_=n(37),X=n(1042);function $(e){var t=e.contact,n=e.switchToView,a=e.onSave,r=Object(X.a)({initialValues:t,onSubmit:function(e,t){var r=t.setSubmitting;K.a.updateCoachAttributes(e).then((function(){n(),a(),r(!1)})).catch((function(){r(!1),alert("Er is iets misgegaan met opslaan. Probeer het nogmaals")}))}}),o=r.values,u=r.errors,s=r.touched,d=r.handleChange,m=r.handleSubmit,f=r.handleBlur,p=r.isSubmitting;return l.a.createElement("form",{className:"form-horizontal",onSubmit:m},l.a.createElement(c.a,null,l.a.createElement(i.a,null,l.a.createElement("div",{className:"row"},l.a.createElement(Z.a,{type:"text",label:"Max. aantal afspraken per week",name:"coachMaxAppointmentsPerWeek",value:o.coachMaxAppointmentsPerWeek,onChangeAction:function(e){e.target.value=e.target.value.replace(/[^0-9.]/g,""),d(e)},onBlurAction:f,required:"required",error:u.coachMaxAppointmentsPerWeek&&s.coachMaxAppointmentsPerWeek,errorMessage:u.coachMaxAppointmentsPerWeek,allowZero:!0}),l.a.createElement(Z.a,{type:"text",label:"Min. tijd tussen afspraken (minuten)",name:"coachMinMinutesBetweenAppointments",value:o.coachMinMinutesBetweenAppointments,onChangeAction:function(e){e.target.value=e.target.value.replace(/[^0-9.]/g,""),d(e)},onBlurAction:f,required:"required",error:u.coachMinMinutesBetweenAppointments&&s.coachMinMinutesBetweenAppointments,errorMessage:u.coachMinMinutesBetweenAppointments,allowZero:!0}))),l.a.createElement(i.a,null,l.a.createElement("div",{className:"pull-right btn-group",role:"group"},l.a.createElement(_.a,{buttonClassName:"btn-default",buttonText:"Sluiten",onClickAction:n}),l.a.createElement(_.a,{buttonText:"Opslaan",onClickAction:m,type:"submit",value:"Submit",loading:p})))))}var G=n(20);function H(e){var t=e.contact,n=e.switchToEdit;return l.a.createElement("div",{onClick:n},l.a.createElement(c.a,null,l.a.createElement(i.a,null,l.a.createElement("div",{className:"row"},l.a.createElement(G.a,{label:"Max. aantal afspraken per week",value:t.coachMaxAppointmentsPerWeek}),l.a.createElement(G.a,{label:"Min. tijd tussen afspraken",value:t.coachMinMinutesBetweenAppointments+" minuten"})))))}function Q(e){var t=e.contact,n=e.onSave,a=Object(o.useState)(""),c=r()(a,2),i=c[0],u=c[1],s=Object(o.useState)(!1),d=r()(s,2),m=d[0],f=d[1];return l.a.createElement("div",{className:i,onMouseEnter:function(){return u("panel-grey")},onMouseLeave:function(){return u("")}},m?l.a.createElement($,{contact:t,switchToView:function(){return f(!1)},onSave:n}):l.a.createElement(H,{contact:t,switchToEdit:function(){return f(!0)}}))}function ee(e){var t=Object(o.useState)(null),n=r()(t,2),a=n[0],d=n[1];Object(o.useEffect)((function(){m()}),[]);var m=function(){K.a.getCoachAttributes(e.params.id).then((function(e){d(e)}))};return a?l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-9"},l.a.createElement("div",{className:"col-md-12 margin-10-top"},l.a.createElement(c.a,null,l.a.createElement(i.a,{className:"panel-small"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-4"},l.a.createElement("div",{className:"btn-group",role:"group"},l.a.createElement(u.a,{iconName:"glyphicon-arrow-left",onClickAction:s.e.goBack}))),l.a.createElement("div",{className:"col-md-4"},l.a.createElement("h4",{className:"text-center"},"Beschikbaarheid: ",a.fullName)),l.a.createElement("div",{className:"col-md-4"}))))),l.a.createElement("div",{className:"col-md-12 margin-10-top"},l.a.createElement(Q,{contact:a,onSave:m})),l.a.createElement("div",{className:"col-md-12 margin-10-top"},l.a.createElement(J,{contactId:e.params.id}))),l.a.createElement("div",{className:"col-md-3"})):null}}}]);