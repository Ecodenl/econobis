"use strict";(self.webpackChunkeco=self.webpackChunkeco||[]).push([[7878],{78783:(e,t,r)=>{r.d(t,{J:()=>a,i:()=>n});var a=function(e){return{type:"FETCH_ORDER_DETAILS",id:e}},n=function(e,t){return{type:"UPDATE_ORDER",order:e,switchToView:t}}},89158:(e,t,r)=>{r.d(t,{Gb:()=>a,Lk:()=>n,S7:()=>i,fu:()=>c,o8:()=>o});var a=function(e,t,r,a){return{type:"FETCH_ORDERS",filters:e,sorts:t,pagination:r,administrationId:a,showOnlyOrdersWithOrderProducts:arguments.length>4&&void 0!==arguments[4]&&arguments[4]}},n=function(){return{type:"CLEAR_ORDERS"}},o=function(e){return{type:"DELETE_ORDER",id:e}},c=function(e){return{type:"ORDER_PREVIEW_CREATE",data:e}},i=function(){return{type:"CLEAR_ORDER_PREVIEW_CREATE"}}},97878:(e,t,r)=>{r.r(t),r.d(t,{default:()=>mt});var a=r(23029),n=r(92901),o=r(56822),c=r(53954),i=r(85501),l=r(96540),s=r(69733),d=r(78783),u=r(64467),m=r(24179),p=r(91858),h=r(63750),v=r(89158);const g=(0,s.Ng)(null,(function(e){return{deleteOrder:function(t){e((0,v.o8)(t))}}}))((function(e){return l.createElement(h.A,{buttonConfirmText:"Verwijder",buttonClassName:"btn-danger",closeModal:e.closeDeleteItemModal,confirmAction:function(){return e.deleteOrder(e.id),void e.closeDeleteItemModal()},title:"Verwijderen"},"Verwijder Order: ",l.createElement("strong",null," ",e.subject," "),"?")}));var f=r(55956);function E(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(E=function(){return!!e})()}var P=function(e){function t(e){var r,n,i,l;return(0,a.A)(this,t),n=this,i=t,l=[e],i=(0,c.A)(i),r=(0,o.A)(n,E()?Reflect.construct(i,l||[],(0,c.A)(n).constructor):i.apply(n,l)),(0,u.A)(r,"toggleDelete",(function(){r.setState({showDelete:!r.state.showDelete})})),(0,u.A)(r,"preview",(function(){m.RL.push("/order/inzien/".concat(r.props.orderDetails.id))})),(0,u.A)(r,"newInvoice",(function(){r.props.previewCreate([r.props.orderDetails.id]),m.RL.push("/financieel/".concat(r.props.orderDetails.administrationId,"/orders/aanmaken"))})),r.state={showDelete:!1,showNewInvoice:!1},r}return(0,i.A)(t,e),(0,n.A)(t,[{key:"render",value:function(){return l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-4"},l.createElement("div",{className:"btn-group btn-group-flex margin-small",role:"group"},l.createElement(p.A,{iconName:"arrowLeft",onClickAction:m.Nc.goBack}),!this.props.orderDetails.canCreateInvoice&&l.createElement(p.A,{iconName:"eye",onClickAction:this.preview}),this.props.orderDetails.canCreateInvoice&&this.props.orderDetails.orderProducts.length>0&&l.createElement(f.A,{buttonText:"Preview concept nota",onClickAction:this.newInvoice}),this.props.orderDetails.canCreateInvoice&&0==this.props.orderDetails.orderProducts.length&&l.createElement(f.A,{buttonText:"Preview concept nota",disabled:!0,title:"Deze order heeft nog geen orderregels"}),l.createElement(p.A,{iconName:"trash",onClickAction:this.toggleDelete}))),!this.props.isLoading&&l.createElement("div",{className:"col-md-4"},l.createElement("h4",{className:"text-center"},"Order: ",this.props.orderDetails.subject," / ",this.props.orderDetails.number)),l.createElement("div",{className:"col-md-4"}),this.state.showDelete&&l.createElement(g,{closeDeleteItemModal:this.toggleDelete,subject:this.props.orderDetails.subject,id:this.props.orderDetails.id,administrationId:this.props.administrationId}))}}])}(l.Component);const b=(0,s.Ng)((function(e){return{orderDetails:e.orderDetails,administrationId:e.orderDetails.administrationId,isLoading:e.loadingData.isLoading}}),(function(e){return{previewCreate:function(t){e((0,v.fu)(t))}}}))(P);var A=r(2543),I=r(57761),D=r.n(I),y=r(54814),C=r(62493),N=r(55849),w=(r(15900),r(14809)),O=r(6438),S=r(73421),k=r(31714),T=r(95093),F=r.n(T),j=r(97851);function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){(0,u.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function L(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(L=function(){return!!e})()}var M=function(e){function t(e){var r,n,i,l;(0,a.A)(this,t),n=this,i=t,l=[e],i=(0,c.A)(i),r=(0,o.A)(n,L()?Reflect.construct(i,l||[],(0,c.A)(n).constructor):i.apply(n,l)),(0,u.A)(r,"handleInputChange",(function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;r.setState({order:x(x({},r.state.order),{},(0,u.A)({},n,a))})})),(0,u.A)(r,"handleInputChangeParticipation",(function(e){var t,a=e.target,n="checkbox"===a.type?a.checked:a.value;t=(t=r.state.participations.filter((function(e){return e.id==n})))[0],r.setState({order:x(x({},r.state.order),{},{participationId:t.id})})})),(0,u.A)(r,"handleInputChangeDate",(function(e,t){r.setState({order:x(x({},r.state.order),{},(0,u.A)({},t,e))})})),(0,u.A)(r,"handleInputChangeInvoiceDate",(function(e,t){r.setState({order:x(x({},r.state.order),{},(0,u.A)({},t,e))},r.checkContactCollectMandate)})),(0,u.A)(r,"checkContactCollectMandate",(function(){var e=r.state.order.paymentTypeId,t=r.state.order.dateNextInvoice;t||(t=F()().format("YYYY-MM-DD"));var a=r.props.contactCollectMandateFirstRun,n=r.props.contactCollectMandate,o=1==n;n&&a>t&&(o=!1),o||(e="transfer"),r.setState({collectMandateActive:o,order:x(x({},r.state.order),{},{paymentTypeId:e})})})),(0,u.A)(r,"handleSubmit",(function(e){e.preventDefault();var t=r.state.order,a={},n=!1;D().isEmpty(t.paymentTypeId+"")&&(a.paymentTypeId=!0,n=!0),D().isEmpty(t.statusId+"")&&(a.statusId=!0,n=!0),D().isEmpty(t.subject+"")&&(a.subject=!0,n=!0),r.setState(x(x({},r.state),{},{errors:a})),n||r.props.updateOrder(t,r.props.switchToView)}));var s=e.orderDetails,d=s.id,m=s.contactId,p=s.statusId,h=s.subject,v=s.participationId,g=s.emailTemplateIdCollection,f=s.emailTemplateIdTransfer,E=s.emailTemplateReminderId,P=s.emailTemplateExhortationId,b=s.paymentTypeId,A=s.collectionFrequencyId,I=s.IBAN,y=s.ibanAttn,C=s.numberOfInvoiceReminders,N=s.poNumber,w=s.projectNumber,O=s.invoiceText,S=s.dateRequested,k=s.administrationId,T=s.dateNextInvoice;return r.state={emailTemplates:[],showExtraContactInfo:!1,collectMandateActive:!1,participations:[],order:{id:d,contactId:m||"",statusId:p||"",administrationId:k||"",subject:h||"",participationId:v||"",emailTemplateIdCollection:g||"",emailTemplateIdTransfer:f||"",emailTemplateReminderId:E||"",emailTemplateExhortationId:P||"",paymentTypeId:b||"",collectionFrequencyId:A||"once",IBAN:I||"",ibanAttn:y||"",numberOfInvoiceReminders:C||"",poNumber:N||"",projectNumber:w||"",invoiceText:O||"",dateRequested:S||"",dateNextInvoice:T||""},errors:{statusId:!1,subject:!1,IBAN:!1},peekLoading:{emailTemplates:!0}},r.handleReactSelectChange=r.handleReactSelectChange.bind(r),r}return(0,i.A)(t,e),(0,n.A)(t,[{key:"componentDidMount",value:function(){var e=this;this.state.order.contactId&&j.A.fetchContactInfoForOrder(this.state.order.contactId).then((function(t){e.setState({participations:t.data.participations})})),O.A.fetchEmailTemplatesPeek().then((function(t){e.setState({emailTemplates:t,peekLoading:x(x({},e.state.peekLoading),{},{emailTemplates:!1})},e.checkContactCollectMandate)}))}},{key:"handleReactSelectChange",value:function(e,t){this.setState({order:x(x({},this.state.order),{},(0,u.A)({},t,e))})}},{key:"render",value:function(){var e=this.state.order,t=e.statusId,r=e.subject,a=e.participationId,n=e.emailTemplateIdCollection,o=e.emailTemplateIdTransfer,c=e.emailTemplateReminderId,i=e.emailTemplateExhortationId,s=e.paymentTypeId,d=e.collectionFrequencyId,u=(e.IBAN,e.ibanAttn,e.numberOfInvoiceReminders),m=e.poNumber,p=e.projectNumber,h=e.invoiceText,v=e.dateRequested,g=e.administrationId,E=e.dateNextInvoice,P=this.props.orderDetails.invoiceCount;return l.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},l.createElement(C.A,null,l.createElement(N.A,null,l.createElement("div",{className:"row"},l.createElement(y.A,{label:"Order op naam van",value:this.props.orderDetails.contact?this.props.orderDetails.contact.fullName:"",name:"contact",readOnly:!0}),P>0?l.createElement(y.A,{label:"Administratie",value:this.props.orderDetails.administration?this.props.orderDetails.administration.name:"",name:"administration",readOnly:!0}):l.createElement(w.A,{label:"Administratie",name:"administrationId",options:this.props.administrations,value:g,onChangeAction:this.handleInputChange})),l.createElement("div",{className:"row"},l.createElement(y.A,{label:"Contact persoon",value:this.props.contactPerson,name:"contactPerson",readOnly:!0}),l.createElement(y.A,{label:"Nota wordt gemaild naar",value:this.props.contactEmail,name:"contactEmail",readOnly:!0})),l.createElement("div",{className:"row"},l.createElement(w.A,{label:"Deelname",id:"ParticipationId",name:"ParticipationId",options:this.state.participations,value:a,onChangeAction:this.handleInputChangeParticipation,optionValue:"id",optionName:"project_name"}),l.createElement(y.A,{label:"Betreft",name:"subject",value:r,onChangeAction:this.handleInputChange,required:"required",error:this.state.errors.subject})),l.createElement("div",{className:"row"},l.createElement(k.A,{label:"E-mail template nota incasso",name:"emailTemplateIdCollection",options:this.state.emailTemplates,value:n,onChangeAction:this.handleReactSelectChange,isLoading:this.state.peekLoading.emailTemplates}),l.createElement(w.A,{label:"Betaalwijze",id:"paymentTypeId",name:"paymentTypeId",options:this.state.collectMandateActive?this.props.orderPaymentTypes:this.props.orderPaymentTypes.filter((function(e){return"transfer"===e.id})),emptyOption:!1,value:s,onChangeAction:this.handleInputChange,required:"required",error:this.state.errors.paymentTypeId})),l.createElement("div",{className:"row"},l.createElement(k.A,{label:"E-mail template nota overboeken",name:"emailTemplateIdTransfer",options:this.state.emailTemplates,value:o,onChangeAction:this.handleReactSelectChange,isLoading:this.state.peekLoading.emailTemplates}),l.createElement(w.A,{label:"Nota frequentie",id:"collectionFrequencyId",name:"collectionFrequencyId",options:this.props.orderCollectionFrequencies,value:d,onChangeAction:this.handleInputChange,emptyOption:!1})),l.createElement("div",{className:"row"},l.createElement(k.A,{label:"E-mail template herinnering",name:"emailTemplateReminderId",options:this.state.emailTemplates,value:c,onChangeAction:this.handleReactSelectChange,isLoading:this.state.peekLoading.emailTemplates}),l.createElement(w.A,{label:"Status",id:"statusId",name:"statusId",options:this.props.orderStatuses,value:t,onChangeAction:this.handleInputChange,required:"required",error:this.state.errors.statusId})),l.createElement("div",{className:"row"},l.createElement(k.A,{label:"E-mail template aanmaning",name:"emailTemplateExhortationId",options:this.state.emailTemplates,value:i,onChangeAction:this.handleReactSelectChange,isLoading:this.state.peekLoading.emailTemplates}),l.createElement(w.A,{label:"Aantal keer herinneringen nota",id:"numberOfInvoiceReminders",size:"col-sm-6",name:"numberOfInvoiceReminders",options:[{id:"1",name:"1x"},{id:"2",name:"2x"},{id:"3",name:"3x"}],value:u,onChangeAction:this.handleInputChange})),l.createElement("div",{className:"row"},l.createElement("div",{className:"col-sm-6 form-group"}),l.createElement(y.A,{label:"Opdracht nummer klant",name:"poNumber",value:m,onChangeAction:this.handleInputChange})),l.createElement("div",{className:"row"},l.createElement("div",{className:"col-sm-6 form-group"}),l.createElement(y.A,{label:"Projectnummer",name:"projectNumber",value:p,maxLength:"25",onChangeAction:this.handleInputChange})),l.createElement("div",{className:"row"},l.createElement("div",{className:"form-group col-sm-12"},l.createElement("div",{className:"row"},l.createElement("div",{className:"col-sm-3"},l.createElement("label",{htmlFor:"invoiceText",className:"col-sm-12"},"Opmerking")),l.createElement("div",{className:"col-sm-8"},l.createElement("textarea",{name:"invoiceText",value:h,onChange:this.handleInputChange,className:"form-control input-sm",maxLength:"1000"}))))),l.createElement("div",{className:"row"},l.createElement(S.A,{label:"Aanvraag datum",name:"dateRequested",value:v,onChangeAction:this.handleInputChangeDate}),l.createElement(S.A,{label:"Volgende nota datum",value:E,name:"dateNextInvoice",onChangeAction:this.handleInputChangeInvoiceDate})),l.createElement("div",{className:"row"},l.createElement(y.A,{label:"Totaal bedrag incl. BTW",value:"€ "+this.props.orderDetails.totalInclVatInclReductionPerYear.toLocaleString("nl",{minimumFractionDigits:2,maximumFractionDigits:2}),name:"totalInclVatInclReduction",readOnly:!0}))),l.createElement(N.A,null,l.createElement("div",{className:"pull-right btn-group",role:"group"},l.createElement(f.A,{buttonClassName:"btn-default",buttonText:"Sluiten",onClickAction:this.props.switchToView}),l.createElement(f.A,{buttonText:"Opslaan",onClickAction:this.handleSubmit,type:"submit",value:"Submit"})))))}}])}(l.Component);const V=(0,s.Ng)((function(e){return{orderStatuses:e.systemData.orderStatuses,orderPaymentTypes:e.systemData.orderPaymentTypes,orderCollectionFrequencies:e.systemData.orderCollectionFrequencies,orderDetails:e.orderDetails,administrations:e.meDetails.administrations}}),(function(e){return{updateOrder:function(t,r){e((0,d.i)(t,r))}}}))(M);var Y=r(30483);const B=(0,s.Ng)((function(e){return{orderDetails:e.orderDetails}}))((function(e){var t,r=e.orderDetails,a=r.contact,n=r.project,o=r.administration,c=r.status,i=r.subject,s=r.emailTemplateCollection,d=r.emailTemplateTransfer,u=r.emailTemplateReminder,m=r.emailTemplateExhortation,p=r.paymentType,h=r.collectionFrequency,v=(r.IBAN,r.ibanAttn,r.numberOfInvoiceReminders),g=r.poNumber,f=r.projectNumber,E=r.invoiceText,P=r.dateRequested,b=r.totalInclVatInclReductionPerYear,A=r.dateNextInvoice;return t="in-progress"==c.id?null:e.switchToEdit,l.createElement("div",{onClick:t},l.createElement(C.A,null,l.createElement(N.A,null,l.createElement("div",{className:"row"},l.createElement(Y.A,{label:"Order op naam van",value:a?a.fullName:"",link:a?"contact/"+a.id:""}),l.createElement(Y.A,{label:"Administratie",value:o.name,link:o?"administratie/"+o.id:""})),l.createElement("div",{className:"row"},l.createElement(Y.A,{label:"Contact persoon",value:e.contactPerson}),l.createElement(Y.A,{label:"Nota wordt gemaild naar",value:e.contactEmail})),l.createElement("div",{className:"row"},l.createElement(Y.A,{label:"Deelname",value:n?n.name:""}),l.createElement(Y.A,{label:"Betreft",value:i||""})),l.createElement("div",{className:"row"},l.createElement(Y.A,{label:"E-mail template nota incasso",value:s?s.name:""}),l.createElement(Y.A,{label:"Betaalwijze",value:p?p.name:""})),l.createElement("div",{className:"row"},l.createElement(Y.A,{label:"E-mail template nota overboeken",value:d?d.name:""}),l.createElement(Y.A,{label:"Nota frequentie",value:h?h.name:""})),l.createElement("div",{className:"row"},l.createElement(Y.A,{label:"E-mail template herinnering",value:u?u.name:""}),l.createElement(Y.A,{label:"Status",value:c?c.name:""})),l.createElement("div",{className:"row"},l.createElement(Y.A,{label:"E-mail template aanmaning",value:m?m.name:""}),l.createElement(Y.A,{label:"Aantal keer herinneringen nota",value:1===v?"1x":2===v?"2x":3===v?"3x":""})),l.createElement("div",{className:"row"},l.createElement("div",{className:"col-sm-6"}),l.createElement(Y.A,{label:"Opdracht nummer klant",value:g})),l.createElement("div",{className:"row"},l.createElement("div",{className:"col-sm-6"}),l.createElement(Y.A,{label:"Projectnummer",value:f})),l.createElement("div",{className:"row"},l.createElement("div",{className:"col-sm-3"},l.createElement("label",{htmlFor:"invoiceText",className:"col-sm-12"},"Opmerking")),l.createElement("div",{className:"col-sm-9",id:"invoiceText"},E)),l.createElement("div",{className:"row"},l.createElement(Y.A,{label:"Aanvraag datum",value:P?F()(P).format("DD-MM-Y"):""}),l.createElement(Y.A,{label:"Volgende nota datum",value:A?F()(A).format("DD-MM-Y"):""})),l.createElement("div",{className:"row"},l.createElement(Y.A,{label:"Totaal bedrag incl. BTW",value:"€ "+b.toLocaleString("nl",{minimumFractionDigits:2,maximumFractionDigits:2})})))))}));var q=r(46749);function z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?z(Object(r),!0).forEach((function(t){(0,u.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_=function(){return!!e})()}var G=function(e){function t(e){var r,n,i,l;return(0,a.A)(this,t),n=this,i=t,l=[e],i=(0,c.A)(i),r=(0,o.A)(n,_()?Reflect.construct(i,l||[],(0,c.A)(n).constructor):i.apply(n,l)),(0,u.A)(r,"switchToEdit",(function(){r.props.orderDetails.canEdit?r.setState({showEdit:!0}):r.props.setError(405,"Een order met daar aan gekoppeld een nota met de status “Te verzenden” kan niet worden aangepast(de order zit in de map “Order – Te verzenden”). Wil je deze order toch aanpassen? Verwijder dan eerst de “Te verzenden” nota. Dan kom deze order weer in de “Order – te factureren”.  Pas de order aan en maak vervolgens opnieuw de nota.")})),(0,u.A)(r,"switchToView",(function(){r.setState({showEdit:!1,activeDiv:""})})),r.state={contactPerson:"",contactEmail:"",contactCollectMandate:!1,contactCollectMandateFirstRun:"0000-00-00",showEdit:!1,activeDiv:""},r}return(0,i.A)(t,e),(0,n.A)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.orderDetails.contactId&&j.A.fetchContactInfoForOrder(this.props.orderDetails.contactId).then((function(t){e.setState(W(W({},e.state),{},{contactPerson:t.data.contactPerson,contactEmail:t.data.email,contactCollectMandate:t.data.collectMandate,contactCollectMandateFirstRun:t.data.collectMandateFirstRun}))}))}},{key:"componentDidUpdate",value:function(e){var t=this;this.props.orderDetails.id!==e.orderDetails.id&&this.props.orderDetails.contactId&&j.A.fetchContactInfoForOrder(nextProps.orderDetails.contactId).then((function(e){t.setState(W(W({},t.state),{},{contactPerson:e.data.contactPerson,contactEmail:e.data.email,contactCollectMandate:e.data.collectMandate,contactCollectMandateFirstRun:e.data.collectMandateFirstRun}))}))}},{key:"onDivEnter",value:function(){this.setState({activeDiv:"panel-grey"})}},{key:"onDivLeave",value:function(){this.state.showEdit||this.setState({activeDiv:""})}},{key:"render",value:function(){var e=this,t=this.props.meDetails.permissions,r=void 0===t?{}:t;return l.createElement("div",{className:this.state.activeDiv,onMouseEnter:function(){return e.onDivEnter()},onMouseLeave:function(){return e.onDivLeave()}},this.state.showEdit&&this.props.orderDetails.canEdit&&r.manageFinancial?l.createElement(V,{switchToView:this.switchToView,contactPerson:this.state.contactPerson,contactEmail:this.state.contactEmail,contactCollectMandate:this.state.contactCollectMandate,contactCollectMandateFirstRun:this.state.contactCollectMandateFirstRun}):l.createElement(B,{switchToEdit:this.switchToEdit,contactPerson:this.state.contactPerson,contactEmail:this.state.contactEmail}))}}])}(l.Component);const K=(0,s.Ng)((function(e){return{orderDetails:e.orderDetails,meDetails:e.meDetails}}),(function(e){return{setError:function(t,r){e((0,q.N)(t,r))}}}))(G);F().locale("nl");const J=(0,s.Ng)((function(e){return{orderDetails:e.orderDetails}}))((function(e){var t=e.orderDetails,r=t.createdAt,a=t.createdBy;return l.createElement("div",null,l.createElement("div",{className:"row"},l.createElement(Y.A,{label:"Gemaakt door",value:a?a.fullName:"Onbekend",link:a?"gebruiker/"+a.id:""}),l.createElement(Y.A,{label:"Gemaakt op",value:r?F()(r).format("L"):"Onbekend"})))}));var H=r(9392);const Q=function(e){return l.createElement(C.A,null,l.createElement(H.A,null,l.createElement("span",{className:"h5 text-bold"},"Afsluiting gegevens")),l.createElement(N.A,null,l.createElement("div",{className:"col-md-12"},l.createElement(J,null))))};var U=r(87722),X=r(87696),Z=r(88505);F().locale("nl");const $=(0,s.Ng)((function(e){return{permissions:e.meDetails.permissions,orderDetails:e.orderDetails}}))((function(e){var t=e.orderProduct,r=t.product,a=t.amount,n=t.amountInclReductionInclVat,o=t.dateStart,c=t.dateEnd,i=t.amountInclReductionInclVatPerYear,s=t.isOneTimeAndPaidProduct,d=t.period,u=F()(F()().format("YYYY-MM-DD")).isAfter(F()(c).format("YYYY-MM-DD")),m=s?"paid-order-product-row":"",p=u?"not-active-anymore-row":"",h=u?"not-active-anymore-text":"";return l.createElement("div",{className:"row border ".concat(e.highlightLine," ").concat(m," ").concat(p),onMouseEnter:function(){return e.onLineEnter()},onMouseLeave:function(){return e.onLineLeave()}},l.createElement("div",{onClick:e.openEdit},l.createElement("div",{className:"col-sm-1"},r&&r.code),l.createElement("div",{className:"col-sm-2"},r?r.invoiceText:""),l.createElement("div",{className:"col-sm-1"},a||""),l.createElement("div",{className:"col-sm-2"},n?"€ "+n.toLocaleString("nl",{minimumFractionDigits:2,maximumFractionDigits:2}):"€ 0,00"),l.createElement("div",{className:"col-sm-2"},r.invoiceFrequency?r.invoiceFrequency.name:""),l.createElement("div",{className:"col-sm-1"},i?"€ "+i.toLocaleString("nl",{minimumFractionDigits:2,maximumFractionDigits:2}):"€ 0,00"),l.createElement("div",{className:"col-sm-1"},o?F()(o).format("L"):""),l.createElement("div",{className:"col-sm-1 ".concat(h)},c?F()(c).format("L"):"")),l.createElement("div",{className:"col-sm-1"},e.showActionButtons&&e.permissions.manageFinancial?l.createElement("a",{role:"button",onClick:e.openEdit},l.createElement(U.Ay,{className:"mybtn-success",size:14,icon:Z.w})," "):"",e.showActionButtons&&e.permissions.manageFinancial?l.createElement("a",{role:"button",onClick:e.toggleDelete},l.createElement(U.Ay,{className:"mybtn-danger",size:14,icon:X.d})," "):""),d&&l.createElement("div",{className:"col-sm-12"},"Periode ",d))}));F().locale("nl");const ee=(0,s.Ng)((function(e){return{costCenters:e.systemData.costCenters}}))((function(e){var t=e.orderProduct,r=t.product,a=t.costCenterId,n=t.amount,o=t.amountReduction,c=t.percentageReduction,i=t.dateStart,s=t.dateEnd,d=t.dateLastInvoice,u=t.datePeriodStartFirstInvoice,m=t.variablePrice;return l.createElement("div",null,l.createElement("form",{className:"form-horizontal",onSubmit:e.handleSubmit},l.createElement(C.A,{className:"panel-grey"},l.createElement(N.A,null,l.createElement("div",{className:"row"},l.createElement(y.A,{label:"Ordernummer",name:"order",value:e.orderDetails?e.orderDetails.number:"",readOnly:!0}),l.createElement(y.A,{label:"Product",name:"product",value:r?r.name:"",readOnly:!0})),l.createElement("div",{className:"row"},l.createElement(w.A,{label:"Kostenplaats",id:"costCenterId",name:"costCenterId",options:e.costCenters,optionName:"description",value:a,onChangeAction:e.handleInputChange})),l.createElement("div",{className:"row"},l.createElement(y.A,{label:"Omschrijving",id:"description",name:"description",value:r.invoiceText,readOnly:!0}),l.createElement(y.A,{label:"Aantal",type:"number",id:"amount",name:"amount",value:n,onChangeAction:e.handleInputChange,required:"required",error:e.errors.amount})),l.createElement("div",{className:"row"},l.createElement(y.A,{label:"Kortingspercentage",type:"number",id:"percentageReduction",name:"percentageReduction",value:c,onChangeAction:e.handleInputChange}),null!==m?l.createElement(y.A,{label:"Prijs excl. BTW",name:"variablePrice",type:"number",value:m,onChangeAction:e.handleInputChangeVariablePrice,onBlurAction:e.handleBlurVariablePrice,error:e.errors.variablePrice,required:null!==m&&"required"}):l.createElement(y.A,{label:e.orderProduct.product.currentPrice&&e.orderProduct.product.currentPrice.inputInclVat?"Prijs incl. BTW":"Prijs excl. BTW",name:"price",value:e.orderProduct.product.currentPrice?e.orderProduct.product.currentPrice.inputInclVat?"€ "+e.orderProduct.product.currentPrice.priceInclVat.toLocaleString("nl",{minimumFractionDigits:2,maximumFractionDigits:e.orderProduct.product.currentPrice.priceNumberOfDecimals}):"€ "+e.orderProduct.product.currentPrice.price.toLocaleString("nl",{minimumFractionDigits:2,maximumFractionDigits:e.orderProduct.product.currentPrice.priceNumberOfDecimals}):"",readOnly:!0})),l.createElement("div",{className:"row"},l.createElement(y.A,{label:"Kortingsbedrag",type:"number",id:"amountReduction",name:"amountReduction",value:o,onChangeAction:e.handleInputChange}),l.createElement(y.A,{label:"Totaalbedrag incl. BTW",name:"totalPrice",value:"€ "+e.totalPrice.toLocaleString("nl",{minimumFractionDigits:2,maximumFractionDigits:2}),readOnly:!0})),l.createElement("div",{className:"row"},l.createElement(S.A,{label:"Begin datum",name:"dateStart",value:i,onChangeAction:e.handleInputChangeStartDate,required:"required",error:e.errors.dateStart}),l.createElement(S.A,{label:"Eind datum",name:"dateEnd",readOnly:"none"===r.durationId,value:s,onChangeAction:e.handleInputChangeDate,error:e.errors.dateEnd})),!d&&"none"!==r.durationId&&l.createElement("div",{className:"row"},l.createElement(S.A,{label:"1ste notaperiode start op",name:"datePeriodStartFirstInvoice",value:u,onChangeAction:e.handleInputChangeDate})),l.createElement("div",{className:"pull-right btn-group",role:"group"},l.createElement(f.A,{buttonClassName:"btn-default",buttonText:"Annuleren",onClickAction:e.cancelEdit}),l.createElement(f.A,{buttonText:"Opslaan",onClickAction:e.handleSubmit,type:"submit",value:"Submit"}))))))})),te=(0,s.Ng)(null,(function(e){return{fetchOrderDetails:function(t){e((0,d.J)(t))}}}))((function(e){return l.createElement(h.A,{buttonConfirmText:"Verwijder",buttonClassName:"btn-danger",closeModal:e.closeDeleteItemModal,confirmAction:function(){j.A.deleteOrderProduct(e.id).then((function(t){e.fetchOrderDetails(e.orderId),e.closeDeleteItemModal()}))},title:"Verwijderen"},l.createElement("p",null,"Verwijder orderregel?"))}));function re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?re(Object(r),!0).forEach((function(t){(0,u.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ne=function(){return!!e})()}var oe=function(e){function t(e){var r,n,i,l;return(0,a.A)(this,t),n=this,i=t,l=[e],i=(0,c.A)(i),r=(0,o.A)(n,ne()?Reflect.construct(i,l||[],(0,c.A)(n).constructor):i.apply(n,l)),(0,u.A)(r,"handleInputChange",(function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;r.setState(ae(ae({},r.state),{},{orderProduct:ae(ae({},r.state.orderProduct),{},(0,u.A)({},n,a))}),r.updateOrderPrice)})),(0,u.A)(r,"handleLedgerChange",(function(e){r.setState(ae(ae({},r.state),{},{product:ae(ae({},r.state.product),{},{ledgerId:e})}),r.updateOrderPrice)})),(0,u.A)(r,"handleCostCenterChange",(function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;r.setState(ae(ae({},r.state),{},{product:ae(ae({},r.state.product),{},(0,u.A)({},n,a))}))})),(0,u.A)(r,"handleInputChangeProduct",(function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;r.setState(ae(ae({},r.state),{},{product:ae(ae({},r.state.product),{},(0,u.A)({},n,a))}))})),(0,u.A)(r,"updateOrderPrice",(function(){var e,t=!(!r.state.product.currentPrice||!r.state.product.currentPrice.inputInclVat)&&r.state.product.currentPrice.inputInclVat;e=t?r.state.product.currentPrice&&D().isFloat(r.state.product.currentPrice.priceInclVat+"")?r.state.product.currentPrice.priceInclVat:0:r.state.product.currentPrice&&D().isFloat(r.state.product.currentPrice.price+"")?r.state.product.currentPrice.price:0;var a=D().isFloat(r.state.orderProduct.amount+"")?r.state.orderProduct.amount:0,n=D().isFloat(r.state.orderProduct.percentageReduction+"")?r.state.orderProduct.percentageReduction:0,o=D().isFloat(r.state.orderProduct.amountReduction+"")?r.state.orderProduct.amountReduction:0,c=0;if(c=e<0?e*a*((parseFloat(100)+parseFloat(n))/100)-o:e*a*((100-n)/100)-o,!t){var i=r.state.product.currentPrice&&D().isFloat(r.state.product.currentPrice.vatPercentage+"")?r.state.product.currentPrice.vatPercentage:0;c*=(parseFloat(100)+parseFloat(i))/100}r.setState(ae(ae({},r.state),{},{totalPrice:parseFloat(c).toFixed(2)}))})),(0,u.A)(r,"handleSubmit",(function(e){e.preventDefault();var t=r.state.orderProduct,a={},n=!1;D().isEmpty(t.amount+"")&&(a.amount=!0,n=!0);var o=r.state.product;D().isEmpty(o.description)&&(a.description=!0,n=!0),r.props.usesTwinfield&&D().isEmpty(String(o.ledgerId))&&(a.ledgerId=!0,n=!0),r.setState(ae(ae({},r.state),{},{errors:a,errorMessage:!1})),!n&&j.A.updateOrderProductOneTime(t,o).then((function(e){r.props.fetchOrderDetails(r.props.orderProduct.orderId),r.props.cancelEdit()}))})),r.state={errorMessage:!1,orderPrice:e.product.currentPrice?e.product.currentPrice.inputInclVat?e.product.currentPrice.priceInclVat:e.product.currentPrice.price:0,totalPrice:"",orderProduct:{id:e.orderProduct.id,amount:e.orderProduct.amount,amountReduction:e.orderProduct.amountReduction,percentageReduction:e.orderProduct.percentageReduction,dateStart:e.orderProduct.dateStart,dateEnd:e.orderProduct.dateEnd,datePeriodStartFirstInvoice:e.orderProduct.datePeriodStartFirstInvoice},product:{id:e.product.id,description:e.product.invoiceText,ledgerId:e.product.ledgerId?e.product.ledgerId:"",costCenterId:e.product.costCenterId?e.product.costCenterId:"",currentPrice:e.product.currentPrice?e.product.currentPrice:""},errors:{amount:!1,ledgerId:!1,description:!1}},r}return(0,i.A)(t,e),(0,n.A)(t,[{key:"componentDidMount",value:function(){this.updateOrderPrice()}},{key:"render",value:function(){var e=this,t=this.state.orderProduct,r=t.amount,a=t.amountReduction,n=t.percentageReduction,o=this.state.product,c=o.description,i=o.costCenterId,s=o.ledgerId,d=this.props.ledgers.filter((function(t){return t.vatCode?e.state.product.currentPrice&&t.vatCode.percentage===e.state.product.currentPrice.vatPercentage:e.state.product.currentPrice&&t.vatCode===e.state.product.currentPrice.vatPercentage}));return l.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},l.createElement(C.A,{className:"panel-grey"},l.createElement(N.A,null,l.createElement("div",{className:"row"},l.createElement("div",{className:"panel-heading"},l.createElement("span",{className:"h5 text-bold"},"Product"))),this.props.usesTwinfield?l.createElement("div",{className:"row"},l.createElement(k.A,{label:"Grootboek",name:"ledgerId",id:"ledgerId",options:d,optionName:"description",value:s,onChangeAction:this.handleLedgerChange,required:"required",error:this.state.errors.ledgerId}),l.createElement(w.A,{label:"Kostenplaats",id:"costCenterId",name:"costCenterId",options:this.props.costCenters,optionName:"description",value:i,onChangeAction:this.handleCostCenterChange})):null,l.createElement("div",{className:"row"},l.createElement("div",{className:"panel-part panel-heading"},l.createElement("span",{className:"h5 text-bold"},"Orderregel"))),l.createElement("div",{className:"row"},l.createElement(y.A,{label:"Omschrijving",id:"description",name:"description",value:c,onChangeAction:this.handleInputChangeProduct,required:"required",error:this.state.errors.description}),l.createElement(y.A,{label:"Aantal",type:"number",id:"amount",name:"amount",value:r,onChangeAction:this.handleInputChange,required:"required",error:this.state.errors.amount})),l.createElement("div",{className:"row"},l.createElement(y.A,{label:"Kortingspercentage",type:"number",id:"percentageReduction",name:"percentageReduction",value:n,onChangeAction:this.handleInputChange}),l.createElement(y.A,{label:this.state.product.currentPrice&&this.state.product.currentPrice.inputInclVat?"Prijs incl. BTW":"Prijs excl. BTW",name:"orderPrice",value:"€ "+this.state.orderPrice.toLocaleString("nl",{minimumFractionDigits:2,maximumFractionDigits:this.state.product.currentPrice?this.state.product.currentPrice.priceNumberOfDecimals:0}),readOnly:!0})),l.createElement("div",{className:"row"},l.createElement(y.A,{label:"Kortingsbedrag",type:"number",id:"amountReduction",name:"amountReduction",value:a,onChangeAction:this.handleInputChange}),l.createElement(y.A,{label:"Totaalbedrag incl. BTW",name:"totalPrice",value:"€ "+this.state.totalPrice.toLocaleString("nl",{minimumFractionDigits:2,maximumFractionDigits:2}),readOnly:!0})),this.state.errorMessage&&l.createElement("div",{className:"col-sm-10 col-md-offset-1 alert alert-danger"},this.state.errorMessage),l.createElement("div",{className:"pull-right btn-group",role:"group"},l.createElement(f.A,{buttonClassName:"btn-default",buttonText:"Annuleren",onClickAction:this.props.cancelEdit}),l.createElement(f.A,{buttonText:"Opslaan",onClickAction:this.handleSubmit,type:"submit",value:"Submit"})))))}}])}(l.Component);const ce=(0,s.Ng)((function(e){return{orderDetails:e.orderDetails,costCenters:e.systemData.costCenters,ledgers:e.systemData.ledgers,usesTwinfield:e.systemData.usesTwinfield}}),(function(e){return{fetchOrderDetails:function(t){e((0,d.J)(t))}}}))(oe);function ie(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function le(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(r),!0).forEach((function(t){(0,u.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ie(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function se(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(se=function(){return!!e})()}var de=function(e){function t(e){var r,n,i,l;return(0,a.A)(this,t),n=this,i=t,l=[e],i=(0,c.A)(i),r=(0,o.A)(n,se()?Reflect.construct(i,l||[],(0,c.A)(n).constructor):i.apply(n,l)),(0,u.A)(r,"toggleDelete",(function(){r.props.orderDetails.canEdit?r.setState({showDelete:!r.state.showDelete}):r.props.setError(405,"Een order met daar aan gekoppeld een nota met de status “Te verzenden” kan niet worden aangepast(de order zit in de map “Order – Te verzenden”). Wil je deze order toch aanpassen? Verwijder dan eerst de “Te verzenden” nota. Dan kom deze order weer in de “Order – te factureren”.  Pas de order aan en maak vervolgens opnieuw de nota.")})),(0,u.A)(r,"onLineEnter",(function(){r.setState({showActionButtons:!0,highlightLine:"highlight-line"})})),(0,u.A)(r,"onLineLeave",(function(){r.setState({showActionButtons:!1,highlightLine:""})})),(0,u.A)(r,"openEdit",(function(){r.props.orderDetails.canEdit?r.setState({showEdit:!0}):r.props.setError(405,"Een order met daar aan gekoppeld een nota met de status “Te verzenden” kan niet worden aangepast(de order zit in de map “Order – Te verzenden”). Wil je deze order toch aanpassen? Verwijder dan eerst de “Te verzenden” nota. Dan kom deze order weer in de “Order – te factureren”.  Pas de order aan en maak vervolgens opnieuw de nota.")})),(0,u.A)(r,"closeEdit",(function(){r.setState({showEdit:!1})})),(0,u.A)(r,"cancelEdit",(function(){r.setState(le(le({},r.state),{},{orderProduct:le({},r.props.orderProduct)})),r.closeEdit()})),(0,u.A)(r,"handleInputChange",(function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;r.setState(le(le({},r.state),{},{orderProduct:le(le({},r.state.orderProduct),{},(0,u.A)({},n,a))}),r.updatePrice)})),(0,u.A)(r,"updatePrice",(function(){var e=!1,t=0;r.state.orderProduct.product.currentPrice&&(e=r.state.orderProduct.product.currentPrice.inputInclVat,t=D().isFloat(r.state.orderProduct.product.currentPrice.vatPercentage+"")?r.state.orderProduct.product.currentPrice.vatPercentage:0);var a=(parseFloat(100)+parseFloat(t))/100,n=0,o=0,c=D().isFloat(r.state.orderProduct.variablePrice+"")?r.state.orderProduct.variablePrice:0;c?e?(n=c,o=c/a):(n=c*a,o=c):r.state.orderProduct.product.currentPrice&&(n=D().isFloat(r.state.orderProduct.product.currentPrice.priceInclVat+"")?r.state.orderProduct.product.currentPrice.priceInclVat:0,o=D().isFloat(r.state.orderProduct.product.currentPrice.price+"")?r.state.orderProduct.product.currentPrice.price:0);var i=D().isFloat(r.state.orderProduct.amount+"")?r.state.orderProduct.amount:0,l=parseFloat(n*i).toFixed(2),s=parseFloat(o*i).toFixed(2),d=D().isFloat(r.state.orderProduct.amountReduction+"")?r.state.orderProduct.amountReduction:0;e||(d*=a),d=parseFloat(d).toFixed(2);var u=(D().isFloat(r.state.orderProduct.percentageReduction+"")?r.state.orderProduct.percentageReduction:0)/100,m=0;e?m=l*u:(m=s*u,m*=a);var p=l-d-(m=parseFloat(m).toFixed(2));r.setState(le(le({},r.state),{},{totalPrice:p}))})),(0,u.A)(r,"handleSubmit",(function(e){e.preventDefault();var t={},a=!1,n=r.state.orderProduct;D().isEmpty(n.amount+"")&&(t.amount=!0,a=!0),D().isEmpty(n.dateStart+"")&&(t.dateStart=!0,a=!0),!D().isEmpty(n.dateStart+"")&&F()(n.dateEnd).isSameOrBefore(F()(n.dateStart))&&(t.dateEnd=!0,a=!0),!D().isEmpty(n.dateEnd+"")&&F()(n.dateStart).isSameOrAfter(F()(n.dateEnd))&&(t.dateStart=!0,a=!0),null!==r.props.orderProduct.variablePrice&&(D().isEmpty(n.variablePrice+"")||null===n.variablePrice)&&(t.variablePrice=!0,a=!0),r.setState(le(le({},r.state),{},{errors:t})),!a&&j.A.updateOrderProduct(n).then((function(e){r.props.fetchOrderDetails(r.state.orderProduct.orderId),r.closeEdit()}))})),(0,u.A)(r,"handleInputChangeVariablePrice",(function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;r.setState(le(le({},r.state),{},{price:a,orderProduct:le(le({},r.state.orderProduct),{},(0,u.A)({},n,a))}),r.updatePrice)})),(0,u.A)(r,"handleBlurVariablePrice",(function(e){var t=e.target,a=t.value;t.name,r.setState(le(le({},r.state),{},{orderProduct:le(le({},r.state.orderProduct),{},{variablePrice:parseFloat(a).toFixed(r.state.priceNumberOfDecimals)})}))})),r.state={priceNumberOfDecimals:"2",showActionButtons:!1,highlightLine:"",showEdit:!1,showDelete:!1,totalPrice:e.orderProduct.amountInclReductionInclVat,orderProduct:le({},e.orderProduct),errors:{amount:!1,dateStart:!1,dateEnd:!1,variablePrice:!1}},r.handleInputChangeDate=r.handleInputChangeDate.bind(r),r.handleInputChangeStartDate=r.handleInputChangeStartDate.bind(r),r}return(0,i.A)(t,e),(0,n.A)(t,[{key:"componentWillReceiveProps",value:function(e){(0,A.isEqual)(this.state.orderProduct,e.orderProduct)||this.setState(le(le({},this.state),{},{orderProduct:le({},e.orderProduct)}))}},{key:"handleInputChangeDate",value:function(e,t){this.setState(le(le({},this.state),{},{orderProduct:le(le({},this.state.orderProduct),{},(0,u.A)({},t,e))}))}},{key:"handleInputChangeStartDate",value:function(e,t){var r="";if(e)switch(this.state.orderProduct.product.durationId){case"none":case"until_cancellation":default:r="";break;case"month":r=F()(e).add(1,"M").format("YYYY-MM-DD");break;case"quarter":r=F()(e).add(1,"Q").format("YYYY-MM-DD");break;case"half_year":r=F()(e).add(6,"M").format("YYYY-MM-DD");break;case"year":r=F()(e).add(1,"y").format("YYYY-MM-DD")}this.setState(le(le({},this.state),{},{orderProduct:le(le({},this.state.orderProduct),{},(0,u.A)((0,u.A)({},t,e),"dateEnd",r))}))}},{key:"render",value:function(){return l.createElement("div",null,l.createElement($,{highlightLine:this.state.highlightLine,showActionButtons:this.state.showActionButtons,onLineEnter:this.onLineEnter,onLineLeave:this.onLineLeave,openEdit:this.openEdit,toggleDelete:this.toggleDelete,orderProduct:this.state.orderProduct}),this.state.showEdit&&this.props.orderDetails.canEdit&&this.props.permissions.manageFinancial&&!this.state.orderProduct.product.isOneTime&&l.createElement(ee,{orderDetails:this.props.orderDetails,errors:this.state.errors,totalPrice:this.state.totalPrice,orderProduct:this.state.orderProduct,handleInputChange:this.handleInputChange,handleInputChangeDate:this.handleInputChangeDate,handleInputChangeStartDate:this.handleInputChangeStartDate,handleSubmit:this.handleSubmit,cancelEdit:this.cancelEdit,handleInputChangeVariablePrice:this.handleInputChangeVariablePrice,handleBlurVariablePrice:this.handleBlurVariablePrice}),this.state.showEdit&&this.props.orderDetails.canEdit&&this.props.permissions.manageFinancial&&1==this.state.orderProduct.product.isOneTime&&l.createElement(ce,{orderProduct:this.state.orderProduct,product:this.state.orderProduct.product,cancelEdit:this.cancelEdit}),this.state.showDelete&&this.props.orderDetails.canEdit&&this.props.permissions.manageFinancial&&l.createElement(te,{closeDeleteItemModal:this.toggleDelete,id:this.state.orderProduct.id,orderId:this.state.orderProduct.orderId}))}}])}(l.Component);const ue=(0,s.Ng)((function(e){return{permissions:e.meDetails.permissions,orderDetails:e.orderDetails}}),(function(e){return{fetchOrderDetails:function(t){e((0,d.J)(t))},setError:function(t,r){e((0,q.N)(t,r))}}}))(de),me=(0,s.Ng)((function(e){return{orderProducts:e.orderDetails.orderProducts}}))((function(e){return l.createElement("div",null,l.createElement("div",{className:"row border header"},l.createElement("div",{className:"col-sm-1"},"Productcode"),l.createElement("div",{className:"col-sm-2"},"Omschrijving"),l.createElement("div",{className:"col-sm-1"},"Aantal"),l.createElement("div",{className:"col-sm-2"},"Prijs incl. BTW"),l.createElement("div",{className:"col-sm-2"},"Prijs per"),l.createElement("div",{className:"col-sm-1"},"Prijs incl. BTW/jaar"),l.createElement("div",{className:"col-sm-1"},"Begin datum"),l.createElement("div",{className:"col-sm-1"},"Eind datum"),l.createElement("div",{className:"col-sm-1"})),e.orderProducts.length>0?e.orderProducts.map((function(e){return l.createElement(ue,{key:e.id,orderProduct:e})})):l.createElement("div",null,"Geen orderregels bekend."))}));function pe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function he(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(r),!0).forEach((function(t){(0,u.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ve=function(){return!!e})()}var ge=function(e){function t(e){var r,n,i,l;return(0,a.A)(this,t),n=this,i=t,l=[e],i=(0,c.A)(i),r=(0,o.A)(n,ve()?Reflect.construct(i,l||[],(0,c.A)(n).constructor):i.apply(n,l)),(0,u.A)(r,"handleInputChange",(function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;r.setState(he(he({},r.state),{},{orderProduct:he(he({},r.state.orderProduct),{},(0,u.A)({},n,a))}),r.updatePrice)})),(0,u.A)(r,"handleInputChangeVariablePrice",(function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;r.setState(he(he({},r.state),{},{price:a,orderProduct:he(he({},r.state.orderProduct),{},(0,u.A)({},n,a))}),r.updatePrice)})),(0,u.A)(r,"handleBlurVariablePrice",(function(e){var t=e.target,a=t.value;t.name,r.setState(he(he({},r.state),{},{orderProduct:he(he({},r.state.orderProduct),{},{variablePrice:parseFloat(a).toFixed(r.state.priceNumberOfDecimals)})}))})),(0,u.A)(r,"updatePrice",(function(){var e,t;e=r.state.productInputInclVat,t=D().isFloat(r.state.vatPercentage+"")?r.state.vatPercentage:0;var a=(parseFloat(100)+parseFloat(t))/100,n=0,o=0,c=D().isFloat(r.state.orderProduct.variablePrice+"")?r.state.orderProduct.variablePrice:0;c?e?(n=c,o=c/a):(n=c*a,o=c):(n=D().isFloat(r.state.priceInclVat+"")?r.state.priceInclVat:0,o=D().isFloat(r.state.price+"")?r.state.price:0);var i=D().isFloat(r.state.orderProduct.amount+"")?r.state.orderProduct.amount:0,l=parseFloat(n*i).toFixed(2),s=parseFloat(o*i).toFixed(2),d=D().isFloat(r.state.orderProduct.amountReduction+"")?r.state.orderProduct.amountReduction:0;e||(d*=a),d=parseFloat(d).toFixed(2);var u=(D().isFloat(r.state.orderProduct.percentageReduction+"")?r.state.orderProduct.percentageReduction:0)/100,m=0;e?m=l*u:(m=s*u,m*=a);var p=l-d-(m=parseFloat(m).toFixed(2));r.setState(he(he({},r.state),{},{totalPrice:p}))})),(0,u.A)(r,"handleChangeProduct",(function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name,o=2,c=0,i=0,l=0,s="",d="",m=!1,p="",h="",v=!1;if(a){var g=r.props.products.find((function(e){return e.id==a}));o=g.currentPrice?g.currentPrice.priceNumberOfDecimals:2,c=g.currentPrice?g.currentPrice.price:0,i=g.currentPrice?g.currentPrice.priceInclVat:0,l=g.currentPrice?g.currentPrice.vatPercentage:0,v=!!g.currentPrice&&g.currentPrice.inputInclVat,(s=g.costCenterId)||(s=""),d=g.invoiceText,m=g.durationId,h=g.hasVariablePrice}if(m&&r.state.orderProduct.dateStart)switch(m){case"none":case"until_cancellation":default:p="";break;case"month":p=F()(r.state.orderProduct.dateStart).add(1,"M").format("YYYY-MM-DD");break;case"quarter":p=F()(r.state.orderProduct.dateStart).add(1,"Q").format("YYYY-MM-DD");break;case"half_year":p=F()(r.state.orderProduct.dateStart).add(6,"M").format("YYYY-MM-DD");break;case"year":p=F()(r.state.orderProduct.dateStart).add(1,"y").format("YYYY-MM-DD")}r.setState(he(he({},r.state),{},{priceNumberOfDecimals:o,price:c,priceInclVat:i,vatPercentage:l,durationId:m,productHasVariablePrice:"variable"===h,productInputInclVat:v,orderProduct:he(he({},r.state.orderProduct),{},(0,u.A)({costCenterId:s,description:d,dateEnd:p,variablePrice:"variable"===h?r.state.orderProduct.variablePrice:null},n,a))}),r.updatePrice)})),(0,u.A)(r,"handleSubmit",(function(e){e.preventDefault();var t=r.state.orderProduct,a={},n=!1;D().isEmpty(t.productId+"")&&(a.productId=!0,n=!0),D().isEmpty(t.amount+"")&&(a.amount=!0,n=!0),D().isEmpty(t.dateStart+"")&&(a.dateStart=!0,n=!0),D().isEmpty(t.datePeriodStartFirstInvoice+"")&&(a.datePeriodStartFirstInvoice=!0,n=!0),!D().isEmpty(t.dateStart+"")&&F()(t.dateEnd).isSameOrBefore(F()(t.dateStart))&&(a.dateEnd=!0,n=!0),!D().isEmpty(t.dateEnd+"")&&F()(t.dateStart).isSameOrAfter(F()(t.dateEnd))&&(a.dateStart=!0,n=!0),r.state.productHasVariablePrice&&(D().isEmpty(t.variablePrice+"")||null===t.variablePrice)&&(a.variablePrice=!0,n=!0),r.setState(he(he({},r.state),{},{errors:a})),!n&&j.A.newOrderProduct(t).then((function(e){r.props.fetchOrderDetails(t.orderId),r.props.toggleShowNew()}))})),r.state={priceNumberOfDecimals:"2",price:"0",priceInclVat:"0",vatPercentage:"0",totalPrice:"0",durationId:"none",productHasVariablePrice:!1,productInputInclVat:!1,orderProduct:{orderId:r.props.orderDetails.id,productId:"",description:"",costCenterId:"",amount:1,amountReduction:0,percentageReduction:0,dateStart:F()().format("YYYY-MM-DD"),dateEnd:"",datePeriodStartFirstInvoice:F()().format("YYYY-MM-DD"),variablePrice:null},errors:{productId:!1,amount:!1,dateStart:!1,dateEnd:!1,datePeriodStartFirstInvoice:!1,variablePrice:!1}},r.handleInputChangeDate=r.handleInputChangeDate.bind(r),r.handleInputChangeStartDate=r.handleInputChangeStartDate.bind(r),r}return(0,i.A)(t,e),(0,n.A)(t,[{key:"handleInputChangeDate",value:function(e,t){this.setState(he(he({},this.state),{},{orderProduct:he(he({},this.state.orderProduct),{},(0,u.A)({},t,e))}))}},{key:"handleInputChangeStartDate",value:function(e,t){var r,a=this,n="";if(this.state.orderProduct.dateStart&&this.state.orderProduct.productId)switch(e&&(r=this.props.products.filter((function(e){return e.id==a.state.orderProduct.productId}))[0].durationId),r){case"none":case"until_cancellation":default:n="";break;case"month":n=F()(e).add(1,"M").format("YYYY-MM-DD");break;case"quarter":n=F()(e).add(1,"Q").format("YYYY-MM-DD");break;case"half_year":n=F()(e).add(6,"M").format("YYYY-MM-DD");break;case"year":n=F()(e).add(1,"y").format("YYYY-MM-DD")}this.setState(he(he({},this.state),{},{orderProduct:he(he({},this.state.orderProduct),{},(0,u.A)((0,u.A)({},t,e),"dateEnd",n))}))}},{key:"render",value:function(){var e=this.state.orderProduct,t=e.productId,r=e.description,a=e.costCenterId,n=e.amount,o=e.amountReduction,c=e.percentageReduction,i=e.dateStart,s=e.dateEnd,d=e.datePeriodStartFirstInvoice;return l.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},l.createElement(C.A,{className:"panel-grey"},l.createElement(N.A,null,l.createElement("div",{className:"row"},l.createElement(y.A,{label:"Order nummer",name:"orderId",value:this.props.orderDetails.number,readOnly:!0}),l.createElement(w.A,{label:"Product",id:"productId",name:"productId",options:this.props.products.filter((function(e){return e.active})).sort((function(e,t){return e.name.localeCompare(t.name)})),value:t,onChangeAction:this.handleChangeProduct,required:"required",error:this.state.errors.productId})),l.createElement("div",{className:"row"},l.createElement(w.A,{label:"Kostenplaats",id:"costCenterId",name:"costCenterId",options:this.props.costCenters,optionName:"description",value:a,onChangeAction:this.handleInputChange})),l.createElement("div",{className:"row"},l.createElement(y.A,{label:"Omschrijving",id:"description",name:"description",value:r,readOnly:!0}),l.createElement(y.A,{label:"Aantal",type:"number",id:"amount",name:"amount",value:n,onChangeAction:this.handleInputChange,required:"required",error:this.state.errors.amount})),l.createElement("div",{className:"row"},l.createElement(y.A,{label:"Kortingspercentage",type:"number",id:"percentageReduction",name:"percentageReduction",value:c,onChangeAction:this.handleInputChange}),this.state.productHasVariablePrice?l.createElement(y.A,{label:"Prijs excl. BTW",name:"variablePrice",type:"number",value:this.state.orderProduct.variablePrice,onChangeAction:this.handleInputChangeVariablePrice,onBlurAction:this.handleBlurVariablePrice,error:this.state.errors.variablePrice,required:this.state.productHasVariablePrice&&"required"}):l.createElement(y.A,{label:this.state.productInputInclVat?"Prijs incl. BTW":"Prijs excl. BTW",name:"price",value:this.state.productInputInclVat?"€ "+this.state.priceInclVat.toLocaleString("nl",{minimumFractionDigits:2,maximumFractionDigits:this.state.priceNumberOfDecimals}):"€ "+this.state.price.toLocaleString("nl",{minimumFractionDigits:2,maximumFractionDigits:this.state.priceNumberOfDecimals}),readOnly:!0})),l.createElement("div",{className:"row"},l.createElement(y.A,{label:"Kortingsbedrag",type:"number",id:"amountReduction",name:"amountReduction",value:o,onChangeAction:this.handleInputChange}),l.createElement(y.A,{label:"Totaalbedrag incl. BTW",name:"totalPrice",value:"€ "+this.state.totalPrice.toLocaleString("nl",{minimumFractionDigits:2,maximumFractionDigits:2}),readOnly:!0})),l.createElement("div",{className:"row"},l.createElement(S.A,{label:"Begin datum",name:"dateStart",value:i,onChangeAction:this.handleInputChangeStartDate,required:"required",error:this.state.errors.dateStart}),l.createElement(S.A,{label:"Eind datum",name:"dateEnd",value:s,onChangeAction:this.handleInputChangeDate,error:this.state.errors.dateEnd,readOnly:"none"===this.state.durationId})),"none"!==this.state.durationId&&l.createElement("div",{className:"row"},l.createElement(S.A,{label:"1ste notaperiode start op",name:"datePeriodStartFirstInvoice",value:d,onChangeAction:this.handleInputChangeDate,error:this.state.errors.datePeriodStartFirstInvoice,required:"required"})),l.createElement("div",{className:"pull-right btn-group",role:"group"},l.createElement(f.A,{buttonClassName:"btn-default",buttonText:"Annuleren",onClickAction:this.props.toggleShowNew}),l.createElement(f.A,{buttonText:"Opslaan",onClickAction:this.handleSubmit,type:"submit",value:"Submit"})))))}}])}(l.Component);const fe=(0,s.Ng)((function(e){return{orderDetails:e.orderDetails,products:e.systemData.products,costCenters:e.systemData.costCenters}}),(function(e){return{fetchOrderDetails:function(t){e((0,d.J)(t))}}}))(ge);var Ee=r(77465);function Pe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function be(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(r),!0).forEach((function(t){(0,u.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ae(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ae=function(){return!!e})()}var Ie=function(e){function t(e){var r,n,i,l;return(0,a.A)(this,t),n=this,i=t,l=[e],i=(0,c.A)(i),r=(0,o.A)(n,Ae()?Reflect.construct(i,l||[],(0,c.A)(n).constructor):i.apply(n,l)),(0,u.A)(r,"handleInputChange",(function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;r.setState(be(be({},r.state),{},{orderProduct:be(be({},r.state.orderProduct),{},(0,u.A)({},n,a))}),r.updateOrderPrice)})),(0,u.A)(r,"handleLedgerChange",(function(e){var t=r.props.ledgers.find((function(t){return t.id===e})),a=t.vatCode&&t.vatCode.percentage;r.setState(be(be({},r.state),{},{product:be(be({},r.state.product),{},{ledgerId:e,vatPercentage:a})}),r.updatePrice)})),(0,u.A)(r,"handleCostCenterChange",(function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;r.setState(be(be({},r.state),{},{product:be(be({},r.state.product),{},(0,u.A)({},n,a))}))})),(0,u.A)(r,"handleInputChangeProduct",(function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;r.setState(be(be({},r.state),{},{product:be(be({},r.state.product),{},(0,u.A)({},n,a))}),r.updatePrice)})),(0,u.A)(r,"handleInputChangeProductDuration",(function(e){var t,a=e.target,n="checkbox"===a.type?a.checked:a.value,o=a.name;if(r.state.orderProduct.dateStart)switch(n){case"none":case"until_cancellation":default:t="";break;case"month":t=F()(r.state.orderProduct.dateStart).add(1,"M").format("YYYY-MM-DD");break;case"quarter":t=F()(r.state.orderProduct.dateStart).add(1,"Q").format("YYYY-MM-DD");break;case"half_year":t=F()(r.state.orderProduct.dateStart).add(6,"M").format("YYYY-MM-DD");break;case"year":t=F()(r.state.orderProduct.dateStart).add(1,"y").format("YYYY-MM-DD")}r.setState(be(be({},r.state),{},{product:be(be({},r.state.product),{},(0,u.A)({},o,n)),orderProduct:be(be({},r.state.orderProduct),{},{dateEnd:t})}))})),(0,u.A)(r,"handleInputChangeProductVat",(function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;r.setState(be(be({},r.state),{},{product:be(be({},r.state.product),{},(0,u.A)({},n,a))}),r.updatePrice)})),(0,u.A)(r,"handleInputChangeProductPrice",(function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;r.setState(be(be({},r.state),{},{product:be(be({},r.state.product),{},(0,u.A)({},n,a))}),r.updatePrice)})),(0,u.A)(r,"handleBlurProductPrice",(function(e){var t=e.target,a=t.value,n=t.name;r.setState(be(be({},r.state),{},{product:be(be({},r.state.product),{},(0,u.A)({},n,parseFloat(a).toFixed(r.state.product.priceNumberOfDecimals)))}))})),(0,u.A)(r,"handleBlurDecimals",(function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=(t.name,a);n<2&&(n=2),n>6&&(n=6),r.setState(be(be({},r.state),{},{product:be(be({},r.state.product),{},{priceNumberOfDecimals:n,price:parseFloat(r.state.product.price).toFixed(n),priceInclVat:parseFloat(r.state.product.priceInclVat).toFixed(n)})}),r.updatePrice)})),(0,u.A)(r,"updatePrice",(function(){var e=!!r.state.product.inputInclVat&&r.state.product.inputInclVat,t=D().isFloat(r.state.product.price+"")?r.state.product.price:0,a=D().isFloat(r.state.product.priceInclVat+"")?r.state.product.priceInclVat:0,n=D().isFloat(r.state.product.vatPercentage+"")?r.state.product.vatPercentage:0,o=(parseFloat(100)+parseFloat(n))/100;e?(t=a/o,r.setState(be(be({},r.state),{},{product:be(be({},r.state.product),{},{price:parseFloat(t).toFixed(r.state.product.priceNumberOfDecimals)})}),r.updateOrderPrice)):(a=t*o,r.setState(be(be({},r.state),{},{product:be(be({},r.state.product),{},{priceInclVat:parseFloat(a).toFixed(r.state.product.priceNumberOfDecimals)})}),r.updateOrderPrice))})),(0,u.A)(r,"updateOrderPrice",(function(){var e,t;e=r.state.product.inputInclVat,t=D().isFloat(r.state.product.vatPercentage+"")?r.state.product.vatPercentage:0;var a,n=(parseFloat(100)+parseFloat(t))/100,o=D().isFloat(r.state.product.priceInclVat+"")?r.state.product.priceInclVat:0,c=D().isFloat(r.state.product.price+"")?r.state.product.price:0,i=D().isFloat(r.state.orderProduct.amount+"")?r.state.orderProduct.amount:0,l=parseFloat(o*i).toFixed(2),s=parseFloat(c*i).toFixed(2);a=e?o:c;var d=D().isFloat(r.state.orderProduct.amountReduction+"")?r.state.orderProduct.amountReduction:0;e||(d*=n),d=parseFloat(d).toFixed(2);var u=(D().isFloat(r.state.orderProduct.percentageReduction+"")?r.state.orderProduct.percentageReduction:0)/100,m=0;e?m=l*u:(m=s*u,m*=n);var p=l-d-(m=parseFloat(m).toFixed(2));r.setState(be(be({},r.state),{},{orderPrice:parseFloat(a).toFixed(r.state.product.priceNumberOfDecimals),totalPrice:parseFloat(p).toFixed(2)}))})),(0,u.A)(r,"handleSubmit",(function(e){e.preventDefault();var t=r.state.orderProduct,a={},n=!1,o=!1;D().isEmpty(t.amount+"")&&(a.amount=!0,n=!0),D().isEmpty(t.dateStart+"")&&(a.dateStart=!0,n=!0),!D().isEmpty(t.dateStart+"")&&F()(t.dateEnd).isSameOrBefore(F()(t.dateStart))&&(a.dateEnd=!0,n=!0),!D().isEmpty(t.dateEnd+"")&&F()(t.dateStart).isSameOrAfter(F()(t.dateEnd))&&(a.dateStart=!0,n=!0),D().isEmpty(t.datePeriodStartFirstInvoice+"")&&(a.datePeriodStartFirstInvoice=!0,n=!0);var c=r.state.product,i=!1;r.props.products.map((function(e){return e.code==c.code&&(i=!0)})),i&&(o="Productcode moet uniek zijn.",a.code=!0,n=!0),D().isEmpty(c.code+"")&&(a.code=!0,n=!0);var l=!1;r.props.products.map((function(e){return e.name==c.name&&(l=!0)})),l&&(o="Productnaam moet uniek zijn.",a.name=!0,n=!0),i&&l&&(o="Productcode en productnaam moeten uniek zijn."),D().isEmpty(c.name+"")&&(a.name=!0,n=!0),D().isEmpty(c.administrationId+"")&&(a.administrationId=!0,n=!0),c.inputInclVat?D().isEmpty(c.priceInclVat+"")&&(a.priceInclVat=!0,n=!0):D().isEmpty(c.price+"")&&(a.price=!0,n=!0),r.props.usesTwinfield&&D().isEmpty(String(c.ledgerId))&&(a.ledgerId=!0,n=!0),D().isEmpty(c.description)&&(a.description=!0,n=!0),r.setState(be(be({},r.state),{},{errors:a,errorMessage:o})),!n&&j.A.newProductAndOrderProduct(t,c).then((function(e){r.props.fetchOrderDetails(t.orderId),r.props.toggleShowNewProduct()}))})),r.state={errorMessage:!1,orderPrice:"",totalPrice:"",orderProduct:{orderId:r.props.orderDetails.id,amount:1,amountReduction:0,percentageReduction:0,dateStart:F()().format("YYYY-MM-DD"),dateEnd:"",datePeriodStartFirstInvoice:F()().format("YYYY-MM-DD")},product:{code:"",name:"",durationId:"none",description:"",administrationId:r.props.orderDetails.administrationId,invoiceFrequencyId:r.props.orderDetails.collectionFrequencyId?r.props.orderDetails.collectionFrequencyId:"once",vatPercentage:"",inputInclVat:!1,priceNumberOfDecimals:2,price:"",priceInclVat:"",ledgerId:"",costCenterId:"",isOneTime:!1},errors:{amount:!1,dateStart:!1,dateEnd:!1,code:!1,name:!1,priceNumberOfDecimals:!1,price:!1,priceInclVat:!1,datePeriodStartFirstInvoice:!1,ledgerId:!1,description:!1}},r.handleInputChangeDate=r.handleInputChangeDate.bind(r),r.handleInputChangeStartDate=r.handleInputChangeStartDate.bind(r),r}return(0,i.A)(t,e),(0,n.A)(t,[{key:"handleInputChangeDate",value:function(e,t){this.setState(be(be({},this.state),{},{orderProduct:be(be({},this.state.orderProduct),{},(0,u.A)({},t,e))}))}},{key:"handleInputChangeStartDate",value:function(e,t){var r="";if(this.state.orderProduct.dateStart)switch(this.state.product.durationId){case"none":case"until_cancellation":default:r="";break;case"month":r=F()(e).add(1,"M").format("YYYY-MM-DD");break;case"quarter":r=F()(e).add(1,"Q").format("YYYY-MM-DD");break;case"half_year":r=F()(e).add(6,"M").format("YYYY-MM-DD");break;case"year":r=F()(e).add(1,"y").format("YYYY-MM-DD")}this.setState(be(be({},this.state),{},{orderProduct:be(be({},this.state.orderProduct),{},(0,u.A)((0,u.A)({},t,e),"dateEnd",r))}))}},{key:"render",value:function(){var e=this.state.orderProduct,t=e.amount,r=e.amountReduction,a=e.percentageReduction,n=e.dateStart,o=e.dateEnd,c=e.datePeriodStartFirstInvoice,i=this.state.product,s=i.description,d=i.code,u=i.name,m=i.durationId,p=i.vatPercentage,h=i.inputInclVat,v=i.priceNumberOfDecimals,g=i.price,E=i.priceInclVat,P=i.ledgerId,b=i.costCenterId;return l.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},l.createElement(C.A,{className:"panel-grey"},l.createElement(N.A,null,l.createElement("div",{className:"row"},l.createElement("div",{className:"panel-heading"},l.createElement("span",{className:"h5 text-bold"},"Product"))),l.createElement("div",{className:"row"},l.createElement(y.A,{label:"Productcode",name:"code",value:d,onChangeAction:this.handleInputChangeProduct,required:"required",error:this.state.errors.code}),l.createElement(y.A,{label:"Naam",name:"name",value:u,onChangeAction:this.handleInputChangeProduct,required:"required",error:this.state.errors.name})),l.createElement("div",{className:"row"},this.props.usesTwinfield?l.createElement(l.Fragment,null,l.createElement(k.A,{label:"Grootboek",name:"ledgerId",id:"ledgerId",options:this.props.ledgers,optionName:"description",value:P,onChangeAction:this.handleLedgerChange,required:"required",error:this.state.errors.ledgerId}),l.createElement(w.A,{label:"Kostenplaats",id:"costCenterId",name:"costCenterId",options:this.props.costCenters,optionName:"description",value:b,onChangeAction:this.handleCostCenterChange})):null),l.createElement("div",{className:"row"},l.createElement(w.A,{label:"Looptijd",id:"durationId",name:"durationId",options:this.props.productDurations,value:m,onChangeAction:this.handleInputChangeProductDuration,emptyOption:!1}),l.createElement(w.A,{label:"BTW percentage",name:"vatPercentage",options:this.props.vatCodes,optionValue:"percentage",optionName:"description",value:p,onChangeAction:this.props.usesTwinfield?null:this.handleInputChangeProductVat,placeholder:"Geen",readOnly:this.props.usesTwinfield})),l.createElement("div",{className:"row"},l.createElement(Ee.A,{label:"Invoer inclusief BTW",name:"inputInclVat",value:h,onChangeAction:this.handleInputChangeProduct}),l.createElement(y.A,{label:"Aantal decimalen",type:"number",min:"2",max:"6",name:"priceNumberOfDecimals",value:v,onChangeAction:this.handleInputChangeProduct,onBlurAction:this.handleBlurDecimals,required:"required",error:this.state.errors.priceNumberOfDecimals})),l.createElement("div",{className:"row"},h?l.createElement(l.Fragment,null,l.createElement(y.A,{label:"Prijs excl. BTW",id:"price",name:"price",value:g,readOnly:!0,required:"required"}),l.createElement(y.A,{label:"Prijs incl. BTW",id:"priceInclVat",name:"priceInclVat",type:"number",min:"0",max:"1000000",value:E,onChangeAction:this.handleInputChangeProductPrice,onBlurAction:this.handleBlurProductPrice,required:"required",error:this.state.errors.priceInclVat})):l.createElement(l.Fragment,null,l.createElement(y.A,{label:"Prijs ex. BTW",id:"price",name:"price",type:"number",min:"0",max:"1000000",value:g,onChangeAction:this.handleInputChangeProductPrice,onBlurAction:this.handleBlurProductPrice,required:"required",error:this.state.errors.price}),l.createElement(y.A,{label:"Prijs incl. BTW",id:"priceInclVat",name:"priceInclVat",value:E,readOnly:!0,required:"required"}))),l.createElement("div",{className:"row"},l.createElement("div",{className:"panel-part panel-heading"},l.createElement("span",{className:"h5 text-bold"},"Orderregel"))),l.createElement("div",{className:"row"},l.createElement(y.A,{label:"Omschrijving",id:"description",name:"description",value:s,onChangeAction:this.handleInputChangeProduct,required:"required",error:this.state.errors.description}),l.createElement(y.A,{label:"Aantal",type:"number",id:"amount",name:"amount",value:t,onChangeAction:this.handleInputChange,required:"required",error:this.state.errors.amount})),l.createElement("div",{className:"row"},l.createElement(y.A,{label:"Kortingspercentage",type:"number",id:"percentageReduction",name:"percentageReduction",value:a,onChangeAction:this.handleInputChange}),l.createElement(y.A,{label:this.state.product.inputInclVat?"Prijs incl. BTW":"Prijs excl. BTW",name:"orderPrice",value:"€ "+this.state.orderPrice.toLocaleString("nl",{minimumFractionDigits:2,maximumFractionDigits:this.state.product.priceNumberOfDecimals}),readOnly:!0})),l.createElement("div",{className:"row"},l.createElement(y.A,{label:"Kortingsbedrag",type:"number",id:"amountReduction",name:"amountReduction",value:r,onChangeAction:this.handleInputChange}),l.createElement(y.A,{label:"Totaalbedrag incl. BTW",name:"totalPrice",value:"€ "+this.state.totalPrice.toLocaleString("nl",{minimumFractionDigits:2,maximumFractionDigits:2}),readOnly:!0})),l.createElement("div",{className:"row"},l.createElement(S.A,{label:"Begin datum",name:"dateStart",value:n,onChangeAction:this.handleInputChangeStartDate,required:"required",error:this.state.errors.dateStart}),l.createElement(S.A,{label:"Eind datum",name:"dateEnd",value:o,onChangeAction:this.handleInputChangeDate,error:this.state.errors.dateEnd,readOnly:"none"===m})),"none"!==m&&l.createElement("div",{className:"row"},l.createElement(S.A,{label:"1ste notaperiode start op",name:"datePeriodStartFirstInvoice",value:c,onChangeAction:this.handleInputChangeDate,error:this.state.errors.datePeriodStartFirstInvoice,required:"required"})),this.state.errorMessage&&l.createElement("div",{className:"col-sm-10 col-md-offset-1 alert alert-danger"},this.state.errorMessage),l.createElement("div",{className:"pull-right btn-group",role:"group"},l.createElement(f.A,{buttonClassName:"btn-default",buttonText:"Annuleren",onClickAction:this.props.toggleShowNewProduct}),l.createElement(f.A,{buttonText:"Opslaan",onClickAction:this.handleSubmit,type:"submit",value:"Submit"})))))}}])}(l.Component);const De=(0,s.Ng)((function(e){return{orderDetails:e.orderDetails,productDurations:e.systemData.productDurations,productInvoiceFrequencies:e.systemData.productInvoiceFrequencies,productPaymentTypes:e.systemData.productPaymentTypes,products:e.systemData.products,costCenters:e.systemData.costCenters,ledgers:e.systemData.ledgers,vatCodes:e.systemData.vatCodes,usesTwinfield:e.systemData.usesTwinfield}}),(function(e){return{fetchOrderDetails:function(t){e((0,d.J)(t))}}}))(Ie);function ye(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Ce(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(r),!0).forEach((function(t){(0,u.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ye(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ne=function(){return!!e})()}var we=function(e){function t(e){var r,n,i,l;return(0,a.A)(this,t),n=this,i=t,l=[e],i=(0,c.A)(i),r=(0,o.A)(n,Ne()?Reflect.construct(i,l||[],(0,c.A)(n).constructor):i.apply(n,l)),(0,u.A)(r,"handleInputChange",(function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;r.setState(Ce(Ce({},r.state),{},{orderProduct:Ce(Ce({},r.state.orderProduct),{},(0,u.A)({},n,a))}),r.updateOrderPrice)})),(0,u.A)(r,"handleLedgerChange",(function(e){var t=r.props.ledgers.find((function(t){return t.id===e})),a=t.vatCode&&t.vatCode.percentage;r.setState(Ce(Ce({},r.state),{},{product:Ce(Ce({},r.state.product),{},{ledgerId:e,vatPercentage:a})}),r.updatePrice)})),(0,u.A)(r,"handleCostCenterChange",(function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;r.setState(Ce(Ce({},r.state),{},{product:Ce(Ce({},r.state.product),{},(0,u.A)({},n,a))}))})),(0,u.A)(r,"handleInputChangeProduct",(function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;r.setState(Ce(Ce({},r.state),{},{product:Ce(Ce({},r.state.product),{},(0,u.A)({},n,a))}),r.updatePrice)})),(0,u.A)(r,"handleInputChangeProductVat",(function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;r.setState(Ce(Ce({},r.state),{},{product:Ce(Ce({},r.state.product),{},(0,u.A)({},n,a))}),r.updatePrice)})),(0,u.A)(r,"handleInputChangeProductPrice",(function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;r.setState(Ce(Ce({},r.state),{},{product:Ce(Ce({},r.state.product),{},(0,u.A)({},n,a))}),r.updatePrice)})),(0,u.A)(r,"handleBlurProductPrice",(function(e){var t=e.target,a=t.value,n=t.name;r.setState(Ce(Ce({},r.state),{},{product:Ce(Ce({},r.state.product),{},(0,u.A)({},n,parseFloat(a).toFixed(r.state.product.priceNumberOfDecimals)))}))})),(0,u.A)(r,"handleBlurDecimals",(function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=(t.name,a);n<2&&(n=2),n>6&&(n=6),r.setState(Ce(Ce({},r.state),{},{product:Ce(Ce({},r.state.product),{},{priceNumberOfDecimals:n,price:parseFloat(r.state.product.price).toFixed(n),priceInclVat:parseFloat(r.state.product.priceInclVat).toFixed(n)})}),r.updatePrice)})),(0,u.A)(r,"updatePrice",(function(){var e=!!r.state.product.inputInclVat&&r.state.product.inputInclVat,t=D().isFloat(r.state.product.price+"")?r.state.product.price:0,a=D().isFloat(r.state.product.priceInclVat+"")?r.state.product.priceInclVat:0,n=D().isFloat(r.state.product.vatPercentage+"")?r.state.product.vatPercentage:0,o=(parseFloat(100)+parseFloat(n))/100;e?(t=a/o,r.setState(Ce(Ce({},r.state),{},{product:Ce(Ce({},r.state.product),{},{price:parseFloat(t).toFixed(r.state.product.priceNumberOfDecimals)})}),r.updateOrderPrice)):(a=t*o,r.setState(Ce(Ce({},r.state),{},{product:Ce(Ce({},r.state.product),{},{priceInclVat:parseFloat(a).toFixed(r.state.product.priceNumberOfDecimals)})}),r.updateOrderPrice))})),(0,u.A)(r,"updateOrderPrice",(function(){var e,t;e=r.state.product.inputInclVat,t=D().isFloat(r.state.product.vatPercentage+"")?r.state.product.vatPercentage:0;var a,n=(parseFloat(100)+parseFloat(t))/100,o=D().isFloat(r.state.product.priceInclVat+"")?r.state.product.priceInclVat:0,c=D().isFloat(r.state.product.price+"")?r.state.product.price:0,i=D().isFloat(r.state.orderProduct.amount+"")?r.state.orderProduct.amount:0,l=parseFloat(o*i).toFixed(2),s=parseFloat(c*i).toFixed(2);a=e?o:c;var d=D().isFloat(r.state.orderProduct.amountReduction+"")?r.state.orderProduct.amountReduction:0;e||(d*=n),d=parseFloat(d).toFixed(2);var u=(D().isFloat(r.state.orderProduct.percentageReduction+"")?r.state.orderProduct.percentageReduction:0)/100,m=0;e?m=l*u:(m=s*u,m*=n);var p=l-d-(m=parseFloat(m).toFixed(2));r.setState(Ce(Ce({},r.state),{},{orderPrice:parseFloat(a).toFixed(r.state.product.priceNumberOfDecimals),totalPrice:parseFloat(p).toFixed(2)}))})),(0,u.A)(r,"handleSubmit",(function(e){e.preventDefault();var t=r.state.orderProduct,a={},n=!1;D().isEmpty(t.amount+"")&&(a.amount=!0,n=!0);var o=r.state.product;o.inputInclVat?D().isEmpty(o.priceInclVat+"")&&(a.priceInclVat=!0,n=!0):D().isEmpty(o.price+"")&&(a.price=!0,n=!0),r.props.usesTwinfield&&D().isEmpty(String(o.ledgerId))&&(a.ledgerId=!0,n=!0),D().isEmpty(o.description)&&(a.description=!0,n=!0),r.setState(Ce(Ce({},r.state),{},{errors:a,errorMessage:!1})),!n&&j.A.newProductAndOrderProduct(t,o).then((function(e){r.props.fetchOrderDetails(t.orderId),r.props.toggleShowNewProductOneTime()}))})),r.state={errorMessage:!1,orderPrice:"",totalPrice:"",orderProduct:{orderId:r.props.orderDetails.id,amount:1,amountReduction:0,percentageReduction:0,dateStart:F()().format("YYYY-MM-DD"),dateEnd:"",datePeriodStartFirstInvoice:F()().format("YYYY-MM-DD")},product:{code:"EMP",name:"Eenmalig product",durationId:"none",description:"",administrationId:r.props.orderDetails.administrationId,invoiceFrequencyId:r.props.orderDetails.collectionFrequencyId?r.props.orderDetails.collectionFrequencyId:"once",vatPercentage:"",inputInclVat:!1,priceNumberOfDecimals:2,price:"",priceInclVat:"",ledgerId:"",costCenterId:"",isOneTime:!0},errors:{amount:!1,priceNumberOfDecimals:!1,price:!1,priceInclVat:!1,ledgerId:!1,description:!1}},r}return(0,i.A)(t,e),(0,n.A)(t,[{key:"render",value:function(){var e=this.state.orderProduct,t=e.amount,r=e.amountReduction,a=e.percentageReduction,n=this.state.product,o=n.description,c=n.vatPercentage,i=n.inputInclVat,s=n.priceNumberOfDecimals,d=n.price,u=n.priceInclVat,m=n.ledgerId,p=n.costCenterId;return l.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},l.createElement(C.A,{className:"panel-grey"},l.createElement(N.A,null,l.createElement("div",{className:"row"},l.createElement("div",{className:"panel-heading"},l.createElement("span",{className:"h5 text-bold"},"Product"))),this.props.usesTwinfield?l.createElement("div",{className:"row"},l.createElement(k.A,{label:"Grootboek",name:"ledgerId",id:"ledgerId",options:this.props.ledgers,optionName:"description",value:m,onChangeAction:this.handleLedgerChange,required:"required",error:this.state.errors.ledgerId}),l.createElement(w.A,{label:"Kostenplaats",id:"costCenterId",name:"costCenterId",options:this.props.costCenters,optionName:"description",value:p,onChangeAction:this.handleCostCenterChange})):null,l.createElement("div",{className:"row"},l.createElement("div",{className:"form-group col-sm-6"}," "),l.createElement(w.A,{label:"BTW percentage",name:"vatPercentage",options:this.props.vatCodes,optionValue:"percentage",optionName:"description",value:c,onChangeAction:this.props.usesTwinfield?null:this.handleInputChangeProductVat,placeholder:"Geen",readOnly:this.props.usesTwinfield})),l.createElement("div",{className:"row"},l.createElement(Ee.A,{label:"Invoer inclusief BTW",name:"inputInclVat",value:i,onChangeAction:this.handleInputChangeProduct}),l.createElement(y.A,{label:"Aantal decimalen",type:"number",min:"2",max:"6",name:"priceNumberOfDecimals",value:s,onChangeAction:this.handleInputChangeProduct,onBlurAction:this.handleBlurDecimals,required:"required",error:this.state.errors.priceNumberOfDecimals})),l.createElement("div",{className:"row"},i?l.createElement(l.Fragment,null,l.createElement(y.A,{label:"Prijs excl. BTW",id:"price",name:"price",value:d,readOnly:!0,required:"required"}),l.createElement(y.A,{label:"Prijs incl. BTW",id:"priceInclVat",name:"priceInclVat",type:"number",min:"0",max:"1000000",value:u,onChangeAction:this.handleInputChangeProductPrice,onBlurAction:this.handleBlurProductPrice,required:"required",error:this.state.errors.priceInclVat})):l.createElement(l.Fragment,null,l.createElement(y.A,{label:"Prijs ex. BTW",id:"price",name:"price",type:"number",min:"0",max:"1000000",value:d,onChangeAction:this.handleInputChangeProductPrice,onBlurAction:this.handleBlurProductPrice,required:"required",error:this.state.errors.price}),l.createElement(y.A,{label:"Prijs incl. BTW",id:"priceInclVat",name:"priceInclVat",value:u,readOnly:!0,required:"required"}))),l.createElement("div",{className:"row"},l.createElement("div",{className:"panel-part panel-heading"},l.createElement("span",{className:"h5 text-bold"},"Orderregel"))),l.createElement("div",{className:"row"},l.createElement(y.A,{label:"Omschrijving",id:"description",name:"description",value:o,onChangeAction:this.handleInputChangeProduct,required:"required",error:this.state.errors.description}),l.createElement(y.A,{label:"Aantal",type:"number",id:"amount",name:"amount",value:t,onChangeAction:this.handleInputChange,required:"required",error:this.state.errors.amount})),l.createElement("div",{className:"row"},l.createElement(y.A,{label:"Kortingspercentage",type:"number",id:"percentageReduction",name:"percentageReduction",value:a,onChangeAction:this.handleInputChange}),l.createElement(y.A,{label:this.state.product.inputInclVat?"Prijs incl. BTW":"Prijs excl. BTW",name:"orderPrice",value:"€ "+this.state.orderPrice.toLocaleString("nl",{minimumFractionDigits:2,maximumFractionDigits:this.state.product.priceNumberOfDecimals}),readOnly:!0})),l.createElement("div",{className:"row"},l.createElement(y.A,{label:"Kortingsbedrag",type:"number",id:"amountReduction",name:"amountReduction",value:r,onChangeAction:this.handleInputChange}),l.createElement(y.A,{label:"Totaalbedrag incl. BTW",name:"totalPrice",value:"€ "+this.state.totalPrice.toLocaleString("nl",{minimumFractionDigits:2,maximumFractionDigits:2}),readOnly:!0})),this.state.errorMessage&&l.createElement("div",{className:"col-sm-10 col-md-offset-1 alert alert-danger"},this.state.errorMessage),l.createElement("div",{className:"pull-right btn-group",role:"group"},l.createElement(f.A,{buttonClassName:"btn-default",buttonText:"Annuleren",onClickAction:this.props.toggleShowNewProductOneTime}),l.createElement(f.A,{buttonText:"Opslaan",onClickAction:this.handleSubmit,type:"submit",value:"Submit"})))))}}])}(l.Component);const Oe=(0,s.Ng)((function(e){return{orderDetails:e.orderDetails,costCenters:e.systemData.costCenters,ledgers:e.systemData.ledgers,vatCodes:e.systemData.vatCodes,usesTwinfield:e.systemData.usesTwinfield}}),(function(e){return{fetchOrderDetails:function(t){e((0,d.J)(t))}}}))(we);var Se=r(23384);function ke(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ke=function(){return!!e})()}var Te=function(e){function t(e){var r,n,i,l;return(0,a.A)(this,t),n=this,i=t,l=[e],i=(0,c.A)(i),r=(0,o.A)(n,ke()?Reflect.construct(i,l||[],(0,c.A)(n).constructor):i.apply(n,l)),(0,u.A)(r,"toggleShowNew",(function(){r.props.orderDetails.canEdit?r.setState({showNew:!r.state.showNew}):r.props.setError(405,"Een order met daar aan gekoppeld een nota met de status “Te verzenden” kan niet worden aangepast(de order zit in de map “Order – Te verzenden”). Wil je deze order toch aanpassen? Verwijder dan eerst de “Te verzenden” nota. Dan kom deze order weer in de “Order – te factureren”.  Pas de order aan en maak vervolgens opnieuw de nota.")})),(0,u.A)(r,"toggleShowNewProduct",(function(){r.props.orderDetails.canEdit?r.setState({showNewProduct:!r.state.showNewProduct}):r.props.setError(405,"Een order met daar aan gekoppeld een nota met de status “Te verzenden” kan niet worden aangepast(de order zit in de map “Order – Te verzenden”). Wil je deze order toch aanpassen? Verwijder dan eerst de “Te verzenden” nota. Dan kom deze order weer in de “Order – te factureren”.  Pas de order aan en maak vervolgens opnieuw de nota.")})),(0,u.A)(r,"toggleShowNewProductOneTime",(function(){r.props.orderDetails.canEdit?r.setState({showNewProductOneTime:!r.state.showNewProductOneTime}):r.props.setError(405,"Een order met daar aan gekoppeld een nota met de status “Te verzenden” kan niet worden aangepast(de order zit in de map “Order – Te verzenden”). Wil je deze order toch aanpassen? Verwijder dan eerst de “Te verzenden” nota. Dan kom deze order weer in de “Order – te factureren”.  Pas de order aan en maak vervolgens opnieuw de nota.")})),r.state={showNew:!1,showNewProduct:!1,showNewProductOneTime:!1},r}return(0,i.A)(t,e),(0,n.A)(t,[{key:"render",value:function(){return l.createElement(C.A,null,l.createElement(H.A,null,l.createElement("div",{className:"row"},l.createElement("div",{className:"col-xs-10"},l.createElement("span",{className:"h5 text-bold"},"Orderregels")),this.props.permissions.manageFinancial&&l.createElement("div",{className:"col-xs-2"},l.createElement("div",{className:"pull-right"},l.createElement(U.Ay,{size:14,icon:Se.t,"data-toggle":"dropdown",role:"button"}),l.createElement("ul",{className:"dropdown-menu"},l.createElement("li",null,l.createElement("a",{className:"btn",onClick:this.toggleShowNew},"Bestaand product")),l.createElement("li",null,l.createElement("a",{className:"btn",onClick:this.toggleShowNewProduct},"Nieuw product")),l.createElement("li",null,l.createElement("a",{className:"btn",onClick:this.toggleShowNewProductOneTime},"Nieuw eenmalig product"))))))),l.createElement(N.A,null,l.createElement("div",{className:"col-md-12"},l.createElement(me,null)),l.createElement("div",{className:"col-md-12 margin-10-top"},this.state.showNew&&l.createElement(fe,{toggleShowNew:this.toggleShowNew}),this.state.showNewProduct&&l.createElement(De,{toggleShowNewProduct:this.toggleShowNewProduct}),this.state.showNewProductOneTime&&l.createElement(Oe,{toggleShowNewProductOneTime:this.toggleShowNewProductOneTime}))))}}])}(l.Component);const Fe=(0,s.Ng)((function(e){return{permissions:e.meDetails.permissions,orderDetails:e.orderDetails}}),(function(e){return{setError:function(t,r){e((0,q.N)(t,r))}}}))(Te);function je(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(je=function(){return!!e})()}F().locale("nl");var Re=function(e){function t(e){return(0,a.A)(this,t),r=this,n=t,i=[e],n=(0,c.A)(n),(0,o.A)(r,je()?Reflect.construct(n,i||[],(0,c.A)(r).constructor):n.apply(r,i));var r,n,i}return(0,i.A)(t,e),(0,n.A)(t,[{key:"render",value:function(){var e="",t=!0;return this.props.hasError?e="Fout bij het ophalen van order.":this.props.isLoading?e="Gegevens aan het laden.":(0,A.isEmpty)(this.props.orderDetails)?e="Geen order gevonden!":t=!1,t?l.createElement("div",null,e):l.createElement("div",null,l.createElement(K,null),l.createElement(Fe,null),l.createElement(Q,null))}}])}(l.Component);const xe=(0,s.Ng)((function(e){return{orderDetails:e.orderDetails,isLoading:e.loadingData.isLoading,hasError:e.loadingData.hasError}}))(Re);function Le(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Le=function(){return!!e})()}var Me=function(e){function t(e){var r,n,i,l;return(0,a.A)(this,t),n=this,i=t,l=[e],i=(0,c.A)(i),r=(0,o.A)(n,Le()?Reflect.construct(i,l||[],(0,c.A)(n).constructor):i.apply(n,l)),(0,u.A)(r,"openItem",(function(e){m.RL.push("/taak/".concat(e))})),r.state={relatedTasks:""},r}return(0,i.A)(t,e),(0,n.A)(t,[{key:"render",value:function(){var e=this,t=this.props.relatedTasks;return l.createElement("div",null,""==t&&l.createElement("div",null,"Geen taken of notities gevonden."),""!=t&&l.createElement("table",{className:"table harmonica-table"},l.createElement("tbody",null,t.map((function(t,r){return l.createElement("tr",{onClick:function(){return e.openItem(t.id)},key:r},l.createElement("td",{className:"col-xs-12 clickable"},F()(t.createdAt).format("L")," - ",t.noteSummary))})))))}}])}(l.Component);const Ve=(0,s.Ng)((function(e){return{relatedTasks:e.orderDetails.relatedTasks}}))(Me),Ye=(0,s.Ng)((function(e){return{permissions:e.meDetails.permissions}}),null)((function(e){var t=e.toggleShowList,r=e.showTasksList,a=e.newTask,n=e.taskCount,o=e.permissions;return l.createElement(C.A,{className:"harmonica-button"},l.createElement(N.A,null,l.createElement("div",{className:"col-sm-10",onClick:t,role:"button"},l.createElement("span",null,"TAKEN/NOTITIES ",l.createElement("span",{className:"badge"},n))),l.createElement("div",{className:"col-sm-2"},o.manageTask&&l.createElement("div",{className:"pull-right"},l.createElement(U.Ay,{className:"harmonica-button",size:14,icon:Se.t,"data-toggle":"dropdown",role:"button"}),l.createElement("ul",{className:"dropdown-menu"},l.createElement("li",null,l.createElement("a",{className:"btn",onClick:function(){return a("open")}},"Maak taak")),l.createElement("li",null,l.createElement("a",{className:"btn",onClick:function(){return a("afgehandeld")}},"Maak notitie"))))),l.createElement("div",{className:"col-sm-12"},r&&l.createElement(Ve,null))))}));var Be=r(9293);const qe=(0,s.Ng)((function(e){return{emails:e.orderDetails.relatedEmails}}))((function(e){var t=e.emails,r=(0,l.useContext)(Be.t).openEmailDetailsModal;return l.createElement("div",null,""===t&&l.createElement("div",null,"Geen e-mails gevonden."),""!==t&&l.createElement("table",{className:"table harmonica-table"},l.createElement("tbody",null,t.map((function(e,t){return l.createElement("tr",{key:t},l.createElement("td",{className:"col-xs-4 clickable",onClick:function(){return r(e.id)}},F()(e.date_sent).format("L")),l.createElement("td",{className:"col-xs-8 clickable",onClick:function(){return r(e.id)}},e.subject))})))))})),ze=function(e){var t=e.toggleShowList,r=e.showEmailsList,a=e.newEmail,n=e.emailCount;return l.createElement(C.A,{className:"harmonica-button"},l.createElement(N.A,null,l.createElement("div",{className:"col-sm-10",onClick:t,role:"button"},l.createElement("span",{onClick:t,className:""},"E-MAILS ",l.createElement("span",{className:"badge"},n))),l.createElement("div",{className:"col-sm-2"},l.createElement("a",{role:"button",className:"pull-right",onClick:a},l.createElement(U.Ay,{className:"harmonica-button",size:14,icon:Se.t}))),l.createElement("div",{className:"col-sm-12"},r&&l.createElement(qe,null))))};function We(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(We=function(){return!!e})()}var _e=function(e){function t(e){var r,n,i,l;return(0,a.A)(this,t),n=this,i=t,l=[e],i=(0,c.A)(i),r=(0,o.A)(n,We()?Reflect.construct(i,l||[],(0,c.A)(n).constructor):i.apply(n,l)),(0,u.A)(r,"openItem",(function(e){m.RL.push("/document/".concat(e))})),r.state={relatedDocuments:""},r}return(0,i.A)(t,e),(0,n.A)(t,[{key:"render",value:function(){var e=this,t=this.props.relatedDocuments;return l.createElement("div",null,""==t&&l.createElement("div",null,"Geen documenten gevonden."),""!=t&&l.createElement("table",{className:"table harmonica-table"},l.createElement("tbody",null,t.map((function(t,r){return l.createElement("tr",{onClick:function(){return e.openItem(t.id)},key:r},l.createElement("td",{className:"col-xs-5 clickable"},F()(t.createdAt).format("L")),l.createElement("td",{className:"col-xs-6 clickable"},t.filename))})))))}}])}(l.Component);const Ge=(0,s.Ng)((function(e){return{relatedDocuments:e.orderDetails.relatedDocuments}}))(_e),Ke=(0,s.Ng)((function(e){return{permissions:e.meDetails.permissions}}),null)((function(e){var t=e.toggleShowList,r=e.showDocumentsList,a=e.newDocument,n=e.documentCount,o=e.permissions;return l.createElement(C.A,{className:"harmonica-button"},l.createElement(N.A,null,l.createElement("div",{className:"col-sm-10",onClick:t,role:"button"},l.createElement("span",null,"DOCUMENTEN ",l.createElement("span",{className:"badge"},n))),l.createElement("div",{className:"col-sm-2"},o.createDocument&&l.createElement("div",{className:"pull-right"},l.createElement(U.Ay,{className:"harmonica-button",size:14,icon:Se.t,"data-toggle":"dropdown",role:"button"}),l.createElement("ul",{className:"dropdown-menu"},l.createElement("li",null,l.createElement("a",{className:"btn",onClick:function(){return a("internal")}},"Maak document")),l.createElement("li",null,l.createElement("a",{className:"btn",onClick:function(){return a("upload")}},"Upload document"))))),l.createElement("div",{className:"col-sm-12"},r&&l.createElement(Ge,null))))}));function Je(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Je=function(){return!!e})()}var He=function(e){function t(e){var r,n,i,l;return(0,a.A)(this,t),n=this,i=t,l=[e],i=(0,c.A)(i),r=(0,o.A)(n,Je()?Reflect.construct(i,l||[],(0,c.A)(n).constructor):i.apply(n,l)),(0,u.A)(r,"openItem",(function(e){m.RL.push("/nota/".concat(e))})),r.state={relatedInvoices:""},r}return(0,i.A)(t,e),(0,n.A)(t,[{key:"render",value:function(){var e=this,t=this.props.relatedInvoices;return l.createElement("div",null,""==t&&l.createElement("div",null,"Geen nota's gevonden."),""!=t&&l.createElement("table",{className:"table harmonica-table"},l.createElement("tbody",null,t.map((function(t,r){return l.createElement("tr",{onClick:function(){return e.openItem(t.id)},key:r},l.createElement("td",{className:"col-xs-12 clickable"},F()(t.createdAt).format("L")," - ",t.number))})))))}}])}(l.Component);const Qe=(0,s.Ng)((function(e){return{relatedInvoices:e.orderDetails.relatedInvoices}}))(He),Ue=function(e){var t=e.toggleShowList,r=e.showInvoicesList,a=e.invoiceCount;return l.createElement(C.A,{className:"harmonica-button"},l.createElement(N.A,null,l.createElement("div",{className:"col-sm-12",onClick:t,role:"button"},l.createElement("span",null,"NOTA'S ",l.createElement("span",{className:"badge"},a))),l.createElement("div",{className:"col-sm-12"},r&&l.createElement(Qe,null))))};function Xe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Xe=function(){return!!e})()}var Ze=function(e){function t(e){var r,n,i,l;return(0,a.A)(this,t),n=this,i=t,l=[e],i=(0,c.A)(i),r=(0,o.A)(n,Xe()?Reflect.construct(i,l||[],(0,c.A)(n).constructor):i.apply(n,l)),(0,u.A)(r,"openItem",(function(e){m.RL.push("/nota/".concat(e))})),r.state={relatedInvoicesPaidCollection:""},r}return(0,i.A)(t,e),(0,n.A)(t,[{key:"render",value:function(){var e=this,t=this.props.relatedInvoicesPaidCollection;return l.createElement("div",null,""==t&&l.createElement("div",null,"Geen geïncasseerde incasso's gevonden."),""!=t&&l.createElement("table",{className:"table harmonica-table"},l.createElement("tbody",null,t.map((function(t,r){return l.createElement("tr",{onClick:function(){return e.openItem(t.id)},key:r},l.createElement("td",{className:"col-xs-12 clickable"},F()(t.createdAt).format("L")," - ",t.number))})))))}}])}(l.Component);const $e=(0,s.Ng)((function(e){return{relatedInvoicesPaidCollection:e.orderDetails.relatedInvoicesPaidCollection}}))(Ze),et=function(e){var t=e.toggleShowList,r=e.showInvoicesPaidCollectionList,a=e.invoicePaidCollectionCount;return l.createElement(C.A,{className:"harmonica-button"},l.createElement(N.A,null,l.createElement("div",{className:"col-sm-12",onClick:t,role:"button"},l.createElement("span",null,"GEÏNCASSEERDE INCASSO'S ",l.createElement("span",{className:"badge"},a))),l.createElement("div",{className:"col-sm-12"},r&&l.createElement($e,null))))};function tt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(tt=function(){return!!e})()}var rt=function(e){function t(e){var r,n,i,l;return(0,a.A)(this,t),n=this,i=t,l=[e],i=(0,c.A)(i),r=(0,o.A)(n,tt()?Reflect.construct(i,l||[],(0,c.A)(n).constructor):i.apply(n,l)),(0,u.A)(r,"openItem",(function(e){m.RL.push("/nota/".concat(e))})),r.state={relatedInvoicesPaidTransfer:""},r}return(0,i.A)(t,e),(0,n.A)(t,[{key:"render",value:function(){var e=this,t=this.props.relatedInvoicesPaidTransfer;return l.createElement("div",null,""==t&&l.createElement("div",null,"Geen overboekingen gevonden."),""!=t&&l.createElement("table",{className:"table harmonica-table"},l.createElement("tbody",null,t.map((function(t,r){return l.createElement("tr",{onClick:function(){return e.openItem(t.id)},key:r},l.createElement("td",{className:"col-xs-12 clickable"},F()(t.createdAt).format("L")," - ",t.number))})))))}}])}(l.Component);const at=(0,s.Ng)((function(e){return{relatedInvoicesPaidTransfer:e.orderDetails.relatedInvoicesPaidTransfer}}))(rt),nt=function(e){var t=e.toggleShowList,r=e.showInvoicesPaidTransferList,a=e.invoicePaidTransferCount;return l.createElement(C.A,{className:"harmonica-button"},l.createElement(N.A,null,l.createElement("div",{className:"col-sm-12",onClick:t,role:"button"},l.createElement("span",null,"OVERBOEKINGEN ",l.createElement("span",{className:"badge"},a))),l.createElement("div",{className:"col-sm-12"},r&&l.createElement(at,null))))};function ot(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ct(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ot(Object(r),!0).forEach((function(t){(0,u.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ot(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function it(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(it=function(){return!!e})()}var lt=function(e){function t(e){var r,n,i,l;return(0,a.A)(this,t),n=this,i=t,l=[e],i=(0,c.A)(i),r=(0,o.A)(n,it()?Reflect.construct(i,l||[],(0,c.A)(n).constructor):i.apply(n,l)),(0,u.A)(r,"newTask",(function(e){r.props.orderDetails&&m.RL.push("/taak/nieuw/".concat(e,"/order/").concat(r.props.orderDetails.id,"/contact/").concat(r.props.orderDetails.contactId))})),(0,u.A)(r,"newEmail",(function(){m.RL.push("/email/nieuw")})),(0,u.A)(r,"newDocument",(function(e){r.props.orderDetails&&m.RL.push("/document/nieuw/".concat(e,"/order/").concat(r.props.orderDetails.id))})),r.state={toggleShowList:{tasks:!1,emails:!1,documents:!1,invoices:!1,invoicesPaidCollection:!1,invoicesPaidTransfer:!1}},r.toggleShowList=r.toggleShowList.bind(r),r}return(0,i.A)(t,e),(0,n.A)(t,[{key:"componentWillReceiveProps",value:function(e){this.props.id!==e.id&&this.setState({toggleShowList:{tasks:!1,emails:!1,documents:!1,invoices:!1,invoicesPaidCollection:!1,invoicesPaidTransfer:!1}})}},{key:"toggleShowList",value:function(e){this.setState(ct(ct({},this.state),{},{toggleShowList:ct(ct({},this.state.toggleShowList),{},(0,u.A)({},e,!this.state.toggleShowList[e]))}))}},{key:"render",value:function(){var e=this;return l.createElement("div",{className:"margin-10-top"},l.createElement(Ye,{toggleShowList:function(){return e.toggleShowList("tasks")},showTasksList:this.state.toggleShowList.tasks,taskCount:this.props.orderDetails.taskCount,newTask:this.newTask}),l.createElement(ze,{toggleShowList:function(){return e.toggleShowList("emails")},showEmailsList:this.state.toggleShowList.emails,newEmail:this.newEmail,emailCount:this.props.orderDetails.emailCount}),l.createElement(Ke,{toggleShowList:function(){return e.toggleShowList("documents")},showDocumentsList:this.state.toggleShowList.documents,newDocument:this.newDocument,documentCount:this.props.orderDetails.documentCount}),l.createElement(Ue,{toggleShowList:function(){return e.toggleShowList("invoices")},showInvoicesList:this.state.toggleShowList.invoices,invoiceCount:this.props.orderDetails.invoiceCount}),"collection"===this.props.orderDetails.paymentTypeId?l.createElement(et,{toggleShowList:function(){return e.toggleShowList("invoicesPaidCollection")},showInvoicesPaidCollectionList:this.state.toggleShowList.invoicesPaidCollection,invoicePaidCollectionCount:this.props.orderDetails.invoicePaidCollectionCount}):l.createElement(nt,{toggleShowList:function(){return e.toggleShowList("invoicesPaidTransfer")},showInvoicesPaidTransferList:this.state.toggleShowList.invoicesPaidTransfer,invoicePaidTransferCount:this.props.orderDetails.invoicePaidTransferCount}))}}])}(l.Component);const st=(0,s.Ng)((function(e){return{orderDetails:e.orderDetails,permissions:e.meDetails.permissions}}),null)(lt);function dt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(dt=function(){return!!e})()}var ut=function(e){function t(e){return(0,a.A)(this,t),r=this,n=t,i=[e],n=(0,c.A)(n),(0,o.A)(r,dt()?Reflect.construct(n,i||[],(0,c.A)(r).constructor):n.apply(r,i));var r,n,i}return(0,i.A)(t,e),(0,n.A)(t,[{key:"componentDidMount",value:function(){this.props.fetchOrderDetails(this.props.params.id)}},{key:"render",value:function(){return l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-9"},l.createElement("div",{className:"col-md-12 margin-10-top"},l.createElement(C.A,null,l.createElement(N.A,{className:"panel-small"},l.createElement(b,null)))),l.createElement("div",{className:"col-md-12 margin-10-top"},l.createElement(xe,null))),l.createElement(C.A,{className:"col-md-3 harmonica"},l.createElement(N.A,null,l.createElement(st,null))))}}])}(l.Component);const mt=(0,s.Ng)((function(e){return{orderDetails:e.orderDetails}}),(function(e){return{fetchOrderDetails:function(t){e((0,d.J)(t))}}}))(ut)}}]);