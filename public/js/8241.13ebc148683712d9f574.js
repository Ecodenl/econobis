"use strict";(self.webpackChunkeco=self.webpackChunkeco||[]).push([[8241],{48241:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Z});var a=n(29439),l=n(67294),r=n(14309),c=n(98688),o=n(55451),i=n(96498),m=n(75286),u=n(52822),s=n(24480),d=n(30381),E=n.n(d);function p(e){var t=e.mailgunLog,n=e.hasError,r=(0,l.useState)(""),c=(0,a.Z)(r,2),o=c[0],i=c[1];return l.createElement("tr",{className:o,onMouseEnter:function(){i("highlight-row")},onMouseLeave:function(){i("")}},l.createElement("td",null,E()(t.eventDate).format("DD-MM-YYYY HH:mm")),l.createElement("td",null,t.domain.domain),l.createElement("td",null,n?l.createElement("span",{className:"text-danger"},t.event):l.createElement("span",null,t.event)),l.createElement("td",null,t.deliveryStatus),l.createElement("td",null,t.recipient),l.createElement("td",null,t.subject))}var f=n(69265),g=n(51910),h=n(91871),v=n(96168);function Z(){var e=["rejected","failed_temporary","failed_permanent","complained","unsubscribed"],t=(0,l.useState)(!0),n=(0,a.Z)(t,2),d=n[0],E=n[1],Z=(0,l.useState)([]),k=(0,a.Z)(Z,2),N=k[0],y=k[1],b=(0,l.useState)(0),w=(0,a.Z)(b,2),S=w[0],j=w[1],D=(0,l.useState)(0),C=(0,a.Z)(D,2),M=C[0],_=C[1],x=(0,l.useState)(""),A=(0,a.Z)(x,2),P=A[0],Y=A[1],L=(0,l.useState)("all-error"),z=(0,a.Z)(L,2),G=z[0],H=z[1],O=(0,l.useState)([]),R=(0,a.Z)(O,2),I=R[0],T=R[1],X=(0,l.useState)(""),q=(0,a.Z)(X,2),B=q[0],F=q[1];(0,l.useEffect)((function(){J(),K()}),[]),(0,l.useEffect)((function(){J()}),[M,B,G]);var J=function(){return E(!0),f.Z.get("jory/mailgun-event",{params:{jory:U(),meta:["total"]}}).then((function(e){y(e.data.data),j(e.data.meta.total),E(!1)})).catch((function(){Y("Er is iets misgegaan met ophalen van de mailgun logs."),E(!1)}))},K=function(){return f.Z.get("jory/mailgun-domain",{params:{jory:{fld:["id","domain"],srt:["domain"]}}}).then((function(e){T(e.data.data)}))},Q=function(){return P||(d?"Gegevens aan het laden.":0===N.length?"Geen mailgun logs gevonden, kies een domein en type.":"")},U=function(){return{fld:["id","event","recipient","subject","eventDate","deliveryStatus"],rlt:{domain:{fld:["domain"]}},srt:["-eventDate"],flt:V(),lmt:100,ofs:100*M}},V=function(){var t={and:[]};return B&&t.and.push({f:"mailgunDomainId",d:B}),G&&("all-error"===G?t.and.push({f:"event",o:"in",d:e}):t.and.push({f:"event",d:G})),t};return l.createElement(r.Z,{className:"col-md-12"},l.createElement(c.Z,null,l.createElement("div",{className:"col-md-12 margin-10-top"},l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-4"},l.createElement("div",{className:"btn-group",role:"group"},l.createElement(o.Z,{iconName:"refresh",onClickAction:function(){return E(!0),f.Z.post("mailgun-event/fetch-from-mailgun").then((function(){J()})).catch((function(){Y("Er is iets misgegaan met ophalen van de mailgun logs bij mailgun."),E(!1)}))}}))),l.createElement("div",{className:"col-md-4"},l.createElement("h3",{className:"text-center table-title"},"Mailgun logs ",l.createElement(h.DAO,{color:"blue",size:"15px","data-tip":"De mailgun logs worden elke nacht opgehaald,<br>je kan op het ververs icoontje klikken om direct de meest recente logs op te halen","data-for":"tooltip-note"}),l.createElement(v.Z,{id:"tooltip-note",effect:"float",place:"right",multiline:!0,"aria-haspopup":"true"})," ",l.createElement(h.MXt,{color:"blue",size:"15px",style:{cursor:"pointer"},onClick:function(){return window.open("https://documentation.mailgun.com/en/latest/api-events.html#event-types","_blank")}}))),l.createElement("div",{className:"col-md-4"},l.createElement("div",{className:"pull-right"},"Resultaten: ",S)))),l.createElement("div",{className:"col-md-12 margin-10-top"},l.createElement(i.Z,null,l.createElement(m.Z,null,l.createElement("tr",{className:"thead-title"},l.createElement(u.Z,{title:"Datum",width:"10%"}),l.createElement(u.Z,{title:"Domein",width:"20%"}),l.createElement(u.Z,{title:"Type",width:"10%"}),l.createElement(u.Z,{title:"Status",width:"20%"}),l.createElement(u.Z,{title:"Aan",width:"20%"}),l.createElement(u.Z,{title:"Onderwerp",width:"20%"}))),l.createElement(s.Z,null,l.createElement("tr",{className:"thead-filter"},l.createElement("th",null),l.createElement("th",null,l.createElement("select",{className:"form-control input-sm",value:B,onChange:function(e){return F(e.target.value)}},l.createElement("option",null),I.map((function(e){return l.createElement("option",{key:e.id,value:e.id},e.domain)})))),l.createElement("th",null,l.createElement("select",{className:"form-control input-sm",value:G,onChange:function(e){return H(e.target.value)}},l.createElement("option",null),l.createElement("option",{key:"all-error",value:"all-error"},"- alle fouten -"),["accepted","rejected","delivered","failed_temporary","failed_permanent","opened","clicked","unsubscribed","complained","stored"].map((function(e){return l.createElement("option",{key:e,value:e},e)})))),l.createElement("th",null),l.createElement("th",null),l.createElement("th",null)),Q()?l.createElement("tr",null,l.createElement("td",{colSpan:6},Q())):N.map((function(t){return l.createElement(p,{key:t.id,mailgunLog:t,hasError:e.includes(t.event)})}))))),l.createElement("div",{className:"col-md-6 col-md-offset-3"},l.createElement(g.Z,{onPageChangeAction:function(e){return _(e.selected)},totalRecords:S,initialPage:0,recordsPerPage:100}))))}}}]);