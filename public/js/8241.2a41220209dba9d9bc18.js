"use strict";(self.webpackChunkeco=self.webpackChunkeco||[]).push([[8241],{48241:(e,t,n)=>{n.r(t),n.d(t,{default:()=>g});var a=n(29439),l=n(67294),r=n(14309),c=n(98688),m=n(55451),o=n(96498),i=n(75286),u=n(52822),s=n(24480),d=n(30381),E=n.n(d);function f(e){var t=e.mailgunLog,n=e.hasError,r=(0,l.useState)(""),c=(0,a.Z)(r,2),m=c[0],o=c[1];return l.createElement("tr",{className:m,onMouseEnter:function(){o("highlight-row")},onMouseLeave:function(){o("")}},l.createElement("td",null,E()(t.eventDate).format("DD-MM-YYYY HH:mm")),l.createElement("td",null,t.domain.domain),l.createElement("td",null,n?l.createElement("span",{className:"text-danger"},t.event):l.createElement("span",null,t.event)),l.createElement("td",null,t.recipient),l.createElement("td",null,t.subject))}var p=n(69265),v=n(51910);function g(){var e=["rejected","failed_temporary","failed_permanent","complained","unsubscribed"],t=(0,l.useState)(!0),n=(0,a.Z)(t,2),d=n[0],E=n[1],g=(0,l.useState)([]),h=(0,a.Z)(g,2),Z=h[0],N=h[1],y=(0,l.useState)(0),b=(0,a.Z)(y,2),k=b[0],w=b[1],S=(0,l.useState)(0),j=(0,a.Z)(S,2),D=j[0],C=j[1],M=(0,l.useState)(""),P=(0,a.Z)(M,2),Y=P[0],_=P[1],A=(0,l.useState)("all-error"),L=(0,a.Z)(A,2),x=L[0],G=L[1],H=(0,l.useState)([]),R=(0,a.Z)(H,2),I=R[0],O=R[1],T=(0,l.useState)(""),q=(0,a.Z)(T,2),z=q[0],B=q[1];(0,l.useEffect)((function(){F(),J()}),[]),(0,l.useEffect)((function(){F()}),[D,z,x]);var F=function(){return E(!0),p.Z.get("jory/mailgun-event",{params:{jory:Q(),meta:["total"]}}).then((function(e){N(e.data.data),w(e.data.meta.total),E(!1)})).catch((function(){_("Er is iets misgegaan met ophalen van de mailgun logs."),E(!1)}))},J=function(){return p.Z.get("jory/mailgun-domain",{params:{jory:{fld:["id","domain"],srt:["domain"]}}}).then((function(e){O(e.data.data)}))},K=function(){return Y||(d?"Gegevens aan het laden.":0===Z.length?"Geen mailgun logs gevonden!":"")},Q=function(){return{fld:["id","event","recipient","subject","eventDate"],rlt:{domain:{fld:["domain"]}},srt:["-eventDate"],flt:U(),lmt:100,ofs:100*D}},U=function(){var t={and:[]};return z&&t.and.push({f:"mailgunDomainId",d:z}),x&&("all-error"===x?t.and.push({f:"event",o:"in",d:e}):t.and.push({f:"event",d:x})),t};return l.createElement(r.Z,{className:"col-md-12"},l.createElement(c.Z,null,l.createElement("div",{className:"col-md-12 margin-10-top"},l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-4"},l.createElement("div",{className:"btn-group",role:"group"},l.createElement(m.Z,{iconName:"refresh",onClickAction:F}))),l.createElement("div",{className:"col-md-4"},l.createElement("h3",{className:"text-center table-title"},"Mailgun logs")),l.createElement("div",{className:"col-md-4"},l.createElement("div",{className:"pull-right"},"Resultaten: ",k)))),l.createElement("div",{className:"col-md-12 margin-10-top"},l.createElement(o.Z,null,l.createElement(i.Z,null,l.createElement("tr",{className:"thead-title"},l.createElement(u.Z,{title:"Datum",width:"10%"}),l.createElement(u.Z,{title:"Domein",width:"20%"}),l.createElement(u.Z,{title:"Type",width:"10%"}),l.createElement(u.Z,{title:"Aan",width:"30%"}),l.createElement(u.Z,{title:"Onderwerp",width:"30%"}))),l.createElement(s.Z,null,l.createElement("tr",{className:"thead-filter"},l.createElement("th",null),l.createElement("th",null,l.createElement("select",{className:"form-control input-sm",value:z,onChange:function(e){return B(e.target.value)}},l.createElement("option",null),I.map((function(e){return l.createElement("option",{key:e.id,value:e.id},e.domain)})))),l.createElement("th",null,l.createElement("select",{className:"form-control input-sm",value:x,onChange:function(e){return G(e.target.value)}},l.createElement("option",null),l.createElement("option",{key:"all-error",value:"all-error"},"- alle fouten -"),["accepted","rejected","delivered","failed_temporary","failed_permanent","opened","clicked","unsubscribed","complained","stored"].map((function(e){return l.createElement("option",{key:e,value:e},e)})))),l.createElement("th",null),l.createElement("th",null)),K()?l.createElement("tr",null,l.createElement("td",{colSpan:5},K())):Z.map((function(t){return l.createElement(f,{key:t.id,mailgunLog:t,hasError:e.includes(t.event)})}))))),l.createElement("div",{className:"col-md-6 col-md-offset-3"},l.createElement(v.Z,{onPageChangeAction:function(e){return C(e.selected)},totalRecords:k,initialPage:0,recordsPerPage:100}))))}}}]);